<header class="header" itemscope itemtype="http://schema.org/SiteNavigationElement" aria-label="Main navigation">
  <div class="container">
    <div class="header__inner">

      <!-- Logo -->
      <a class="header__logo" href="{{ '/' | relative_url }}">
        <div class="header__logo--container">
          {% include logo.svg %}
        </div>
      </a>

      <!-- Navigation Links -->
      <nav class="header__links">
        <div class="container header__links-wrapper">
          {% for item in site.navigation %}
            <a class="header__link" href="{{ item.link | relative_url }}" itemprop="url">
              <span itemprop="name">{{ item.name }}</span>
            </a>
          {% endfor %}
        </div>
      </nav>

      <!-- Language Switcher (Only for posts with 'lang') -->
      {% if page.lang %}
        <div class="header__lang-switcher">
          {% assign langs = "en:ðŸ‡ºðŸ‡¸:English,zh:ðŸ‡¨ðŸ‡³:ä¸­æ–‡,ja:ðŸ‡¯ðŸ‡µ:æ—¥æœ¬èªž" | split: "," %}
          {% for lang_item in langs %}
            {% assign parts = lang_item | split: ":" %}
            {% assign code = parts[0] %}
            {% assign emoji = parts[1] %}
            {% assign label = parts[2] %}
            {% assign url_field = code | append: "_url" %}
            {% assign lang_url = page[url_field] %}

            {% if page.lang == code %}
              <span class="lang-flag active" title="{{ label }}">
                {{ emoji }}
              </span>
            {% elsif lang_url %}
              <a class="lang-flag" href="{{ lang_url | relative_url }}" title="{{ label }}">
                {{ emoji }}
              </a>
            {% else %}
              <span class="lang-flag disabled" title="{{ label }}">
                {{ emoji }}
              </span>
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}

      <!-- Mobile Menu Toggle -->
      <div class="header__toggle" aria-label="Toggle navigation">
        <span></span>
        <span></span>
        <span></span>
      </div>

    </div>
  </div>

  <style>
    .header__lang-switcher {
      display: inline-flex;
      gap: 0.5rem;
      align-items: center;
      font-size: 1.3rem; /* emoji size */
      margin-left: 1rem;
    }

    .header__lang-switcher .lang-flag.active {
      text-decoration: underline;
      text-underline-offset: 4px; /* spacing under emoji */
    }

    .header__lang-switcher .lang-flag.disabled {
      filter: grayscale(100%);
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Optional: spacing on mobile if needed */
    @media (max-width: 768px) {
      .header__lang-switcher {
        margin-left: 0;
      }
    }
  </style>

</header>
