

  <!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/Article">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Canonical URL - redirect www to non-www -->
  <link rel="canonical" href="https://pyshine.com/How-to-make-chat-GPT-like-application/">

  <!-- Pinterest & Google verification -->
  <meta name="p:domain_verify" content="fb68a8459fe32b8b072bcd5cc620d125"/>
  <meta name="google-site-verification" content="WAkFPi5cvufClnQetgIl0STmvvwHhVf8jfyENFWhsxU" />
  <meta name="google-site-verification" content="g2pFZlv-92XQD67BPgiVHsvZ4TZH13Ucvmmvvv36kU4" />

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>How to Make a ChatGPT-like Application with FlexGen - Complete Tutorial | PyShine</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="How to Make a ChatGPT-like Application with FlexGen - Complete Tutorial" />
<meta name="author" content="PyShine Team" />
<meta property="og:locale" content="en" />
<meta name="description" content="Learn to build your own ChatGPT-like application using FlexGen for model compression. Step-by-step guide with installation, setup, and running your AI chatbot." />
<meta property="og:description" content="Learn to build your own ChatGPT-like application using FlexGen for model compression. Step-by-step guide with installation, setup, and running your AI chatbot." />
<link rel="canonical" href="https://pyshine.com/How-to-make-chat-GPT-like-application/" />
<meta property="og:url" content="https://pyshine.com/How-to-make-chat-GPT-like-application/" />
<meta property="og:site_name" content="PyShine" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-02-23T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="How to Make a ChatGPT-like Application with FlexGen - Complete Tutorial" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"PyShine Team"},"dateModified":"2023-02-23T00:00:00+00:00","datePublished":"2023-02-23T00:00:00+00:00","description":"Learn to build your own ChatGPT-like application using FlexGen for model compression. Step-by-step guide with installation, setup, and running your AI chatbot.","headline":"How to Make a ChatGPT-like Application with FlexGen - Complete Tutorial","mainEntityOfPage":{"@type":"WebPage","@id":"https://pyshine.com/How-to-make-chat-GPT-like-application/"},"name":"{{ page.title escape }}","url":"https://pyshine.com/How-to-make-chat-GPT-like-application/"}</script>
<!-- End Jekyll SEO tag -->
  <!-- This will generate the canonical link automatically -->

  <script src="https://analytics.ahrefs.com/analytics.js" data-key="Im0K82YsmEDy08+6wyUIZA" async></script>

  <!-- Favicon & App Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png?v=qA3OXqyw77">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png?v=qA3OXqyw77">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png?v=qA3OXqyw77">
  <link rel="manifest" href="/assets/img/icons/manifest.json?v=qA3OXqyw77">
  <link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg?v=qA3OXqyw77" color="#5bbad5">
  <link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77">
  <!--[if IE]><link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77"><![endif]-->

  <!-- App & Theme Info -->
  <meta name="apple-mobile-web-app-title" content="Sleek">
  <meta name="application-name" content="Sleek">
  <meta name="msapplication-config" content="/assets/img/icons/browserconfig.xml?v=qA3OXqyw77">
  <meta name="theme-color" content="#ffffff">

  
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-TCVFBKF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'GTM-TCVFBKF');
</script>

  

  <!-- Critical CSS Inline -->
  <style class="inlineCSS">
    h1{color:#313237;margin-top:0;margin-bottom:.5rem}.dark-bg{background-color:#19d319}@media (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:last-of-type,.post-card:nth-child(2n+2){margin-right:0}}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figure,main{display:block}figure{margin:1em 40px}a{background-color:transparent;-webkit-text-decoration-skip:objects}img{border-style:none}svg:not(:root){overflow:hidden}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}body{-webkit-overflow-scrolling:touch}*,::after,::before{-webkit-box-sizing:inherit;box-sizing:inherit}.site{display:-webkit-box;display:-ms-flexbox;display:flex;min-height:100vh;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.site__content{-webkit-box-flex:1;-ms-flex:1;flex:1}img{max-width:100%;height:auto;width:auto;vertical-align:middle}figure{margin:0}body{background-color:#fff;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Hiragino Sans GB","Microsoft YaHei","WenQuanYi Micro Hei",sans-serif;font-size:1rem;line-height:1.5;color:#343851;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%}p{margin-top:0;margin-bottom:1.25rem}h1,h2{color:#313237;margin-top:0;margin-bottom:.5rem}a{color:#277cea;text-decoration:none;border-bottom:1px dashed #277cea}.blur{background:#fff;filter:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg"><filter id="filter"><feGaussianBlur stdDeviation="16" /></filter></svg>#filter');-webkit-filter:blur(1rem);filter:blur(1rem)}.container{padding:0 20px}@media (min-width:0){.container{max-width:auto;margin:0 auto}}@media (min-width:36em){.container{max-width:540px;margin:0 auto}}@media (min-width:48em){.container{max-width:720px;margin:0 auto}}@media (min-width:62em){.container{max-width:960px;margin:0 auto}}@media (min-width:75em){.container{max-width:1170px;margin:0 auto}}.header{background-color:#fff;color:#343851;position:absolute;z-index:4;width:100%;top:0;left:0;will-change:transform;-webkit-transform:translateY(0);transform:translateY(0)}.header a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:0}.header__logo{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;overflow:hidden;padding:19px 0;margin-right:1.25rem;outline:0;border-bottom:0;color:#313237}.header__logo .header__logo--container{width:58px}.header__logo .header__logo--container .logo{fill:currentColor}.header__inner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:3.75em;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.header__links{padding-bottom:.5rem;display:none;position:absolute;top:3.75em;left:0;width:100%;height:auto;background:#fff}.header__link{color:#343851;padding:.938rem 0;border-top:1px solid #ededed}.header__toggle{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px;height:100%;background-color:transparent;padding-left:1.25rem}.header__toggle span{display:block;position:relative;margin-top:4px;background-color:#343851;width:100%;height:2px;border-radius:1px}.header__toggle span:first-child{margin-top:0}@media (min-width:62em){.header__toggle{display:none;visibility:hidden}.header__links{position:static;padding:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;visibility:visible;width:auto;height:100%}.header__links-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;padding:0}.header__link{position:relative;padding:.938rem 1rem;border:0;height:100%}.header__link::after{content:"";display:block;position:absolute;left:0;bottom:0;height:3px;width:100%;-webkit-transform:scaleX(0);transform:scaleX(0);background:#277cea}}.post-card{display:block;position:relative;width:100%;min-height:250px;border-radius:4px;overflow:hidden;background-color:#fff;-webkit-box-shadow:0 1px 3px rgba(0,0,0,.08);box-shadow:0 1px 3px rgba(0,0,0,.08);margin-bottom:2.25rem;border-bottom:0}@media (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:0}}@media (min-width:75em){.post-card{width:31.25%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:3.125%}}.post-card__label{position:absolute;top:1.5rem;left:1.5rem;z-index:2}.post-card__thumb{margin:0;background:#fff;position:relative;overflow:hidden}.post-card__thumb::after{content:"";display:block;height:0;width:100%;padding-bottom:56.25%}.post-card__thumb>*{position:absolute;top:0;left:0;width:100%;height:100%;display:block}.post-card__inner{padding:1.875rem 1.25rem .625rem;color:#838c8d}.post-card__header{margin-bottom:.75rem}.post-card__header .post-card__meta{font-size:.875rem}.label{padding:0 10px;margin-bottom:1rem;display:inline-block;line-height:20px;font-size:.75rem;text-transform:uppercase;letter-spacing:1px;color:rgba(255,255,255,.8);border:2px solid rgba(255,255,255,.5);border-radius:100px}.hero{margin:3.75rem auto 0;min-height:16.25rem;width:100%;position:relative;background-color:#dde5ea;background-repeat:no-repeat;background-position:50%;background-size:cover}@media (min-width:62em){.hero{margin:0 auto;height:36em}}.hero::before{position:absolute;display:block;content:"";top:0;left:0;width:100%;height:100%;background:rgba(52,56,81,.8)}.hero__wrap{position:absolute;margin:auto;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);text-align:center;color:rgba(255,255,255,.8);width:100%;max-width:90%;z-index:1}.hero__wrap .hero__title{font-size:1.8em;color:#fff}.blog{background-color:#f9f9f9}.post-list{padding-top:2.5em;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}@media (min-width:48em){.hero__wrap{max-width:40em}.hero__wrap .hero__title{padding:1rem 0;font-size:2.625em;line-height:3.125rem}.post-list{padding-top:5em}}
  </style>

  <!-- Main CSS -->
  <link rel="preload" href="/assets/css/main.css" as="style" onload="this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/assets/css/main.css"></noscript>

  <script type="text/javascript">
    /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
(function(w){"use strict";if(!w.loadCSS){w.loadCSS=function(){}}
var rp=loadCSS.relpreload={};rp.support=(function(){var ret;try{ret=w.document.createElement("link").relList.supports("preload")}catch(e){ret=!1}
return function(){return ret}})();rp.bindMediaToggle=function(link){var finalMedia=link.media||"all";function enableStylesheet(){link.media=finalMedia}
if(link.addEventListener){link.addEventListener("load",enableStylesheet)}else if(link.attachEvent){link.attachEvent("onload",enableStylesheet)}
setTimeout(function(){link.rel="stylesheet";link.media="only x"});setTimeout(enableStylesheet,3000)};rp.poly=function(){if(rp.support()){return}
var links=w.document.getElementsByTagName("link");for(var i=0;i<links.length;i++){var link=links[i];if(link.rel==="preload"&&link.getAttribute("as")==="style"&&!link.getAttribute("data-loadcss")){link.setAttribute("data-loadcss",!0);rp.bindMediaToggle(link)}}};if(!rp.support()){rp.poly();var run=w.setInterval(rp.poly,500);if(w.addEventListener){w.addEventListener("load",function(){rp.poly();w.clearInterval(run)})}else if(w.attachEvent){w.attachEvent("onload",function(){rp.poly();w.clearInterval(run)})}}
if(typeof exports!=="undefined"){exports.loadCSS=loadCSS}
else{w.loadCSS=loadCSS}}(typeof global!=="undefined"?global:this))

  </script>

  <!-- MathJax -->
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>


  <body class="site" itemscope itemtype="https://schema.org/WebPage">

    
      <!-- Google Tag Manager (noscript) -->
      <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TCVFBKF"
                height="0" width="0" style="display:none;visibility:hidden"></iframe>
      </noscript>
      <!-- End Google Tag Manager -->
    

    <header class="header"
  itemscope
  itemtype="http://schema.org/SiteNavigationElement"
  aria-label="Main navigation">

  <div class="container">
    <div class="header__inner">

      <!-- Logo -->
      <a class="header__logo" href="/">
        <div class="header__logo--container">
          <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
<g>
	<path d="M18.121,9.88l-7.832-7.836c-0.155-0.158-0.428-0.155-0.584,0L1.842,9.913c-0.262,0.263-0.073,0.705,0.292,0.705h2.069v7.042c0,0.227,0.187,0.414,0.414,0.414h3.725c0.228,0,0.414-0.188,0.414-0.414v-3.313h2.483v3.313c0,0.227,0.187,0.414,0.413,0.414h3.726c0.229,0,0.414-0.188,0.414-0.414v-7.042h2.068h0.004C18.331,10.617,18.389,10.146,18.121,9.88 M14.963,17.245h-2.896v-3.313c0-0.229-0.186-0.415-0.414-0.415H8.342c-0.228,0-0.414,0.187-0.414,0.415v3.313H5.032v-6.628h9.931V17.245z M3.133,9.79l6.864-6.868l6.867,6.868H3.133z"></path>

	
	
</g>
</svg>

        </div>
      </a>

      <!-- Navigation -->
      <nav class="header__links">
        <div class="header__links-wrapper">

          
            
              <a class="header__link" href="/">
                Home
              </a>
            
          
            
              <a class="header__link" href="/categories">
                Posts
              </a>
            
          
            

            <!-- Applications Dropdown -->
            <div class="header__dropdown">
              <span class="header__link header__dropdown-toggle">
                Applications
                <span class="dropdown-arrow">‚ñæ</span>
              </span>

              <div class="header__dropdown-menu">
                
                  <a class="header__dropdown-item"
                     href="/photo_correction">
                    Online Photo Correction
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/photo">
                    Online Passport Photo 20KB
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/finger.html">
                    Online Fingers Scanner
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/avatars">
                    Online Make Avatars
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/kanban/debounce.html">
                    Online Reminder App
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/converter.html">
                    Online Image Resize
                  </a>
                
              </div>
            </div>

            
          
            

            <!-- Applications Dropdown -->
            <div class="header__dropdown">
              <span class="header__link header__dropdown-toggle">
                Games
                <span class="dropdown-arrow">‚ñæ</span>
              </span>

              <div class="header__dropdown-menu">
                
                  <a class="header__dropdown-item"
                     href="/games/snake">
                    Snake Game
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/games/flappy-bird">
                    Flappy Bird
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/games/tetris">
                    Tetris
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/games/memory-match">
                    Memory Match
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/games/pong">
                    Pong
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/games/2048">
                    2048
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/games/battleship">
                    Battleship
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/games/go">
                    GO Game
                  </a>
                
              </div>
            </div>

            
          
            
              <a class="header__link" href="/about">
                About
              </a>
            
          
            
              <a class="header__link" href="/contact">
                Contact
              </a>
            
          
            
              <a class="header__link" href="/privacy">
                Privacy Policy
              </a>
            
          
            
              <a class="header__link" href="/disclaimer">
                Disclaimer
              </a>
            
          

        </div>
      </nav>

      <!-- Language Switcher -->
      

      <!-- Mobile Toggle -->
      <div class="header__toggle">
        <span></span><span></span><span></span>
      </div>

    </div>
  </div>

<style>
/* ==================================================
   üîí HEADER ‚Äî ALWAYS VISIBLE, FULL WIDTH COLOR
================================================== */
.header{
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;           /* full width */
  z-index: 10000;
  background: #FFFFFF;    /* uniform header background */
  box-shadow: 0 2px 12px rgba(0,0,0,.35);
  transform: none !important;
  transition: none !important;
}

/* Lock height to avoid reflow */
.header__inner{
  min-height: 72px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

/* Prevent content hiding under fixed header */
body{
  padding-top: 72px;
}

/* ===============================
   NAV BASE
=============================== */
.header__links-wrapper{
  display:flex;
  align-items:center;
  gap:1.5rem;
}

.header__link,
.header__dropdown-toggle{
  display:inline-flex;
  align-items:center;
  gap:6px;
  cursor:pointer;
  font-size:16px;
  font-weight:500;
  color:#000000;
}

/* ===============================
   DROPDOWN
=============================== */
.header__dropdown{
  position:relative;
}

.dropdown-arrow{
  font-size:1.4em;
  transition:transform .2s ease;
}

.header__dropdown:hover .dropdown-arrow{
  transform:rotate(180deg);
}

.header__dropdown-menu{
  position:absolute;
  top:100%;
  left:0;
  min-width:220px;
  background:#121212;
  border:1px solid #333;
  border-radius:10px;
  padding:6px 0;
  display:none;
  z-index:9999;
}

.header__dropdown:hover .header__dropdown-menu{
  display:block;
}

.header__dropdown-item{
  display:block;
  padding:10px 16px;
  color:#eaeaea;
  text-decoration:none;
}

.header__dropdown-item:hover{
  background:#1f1f1f;
}

/* ===============================
   MOBILE
=============================== */
@media (max-width:768px){

  body{
    padding-top: 64px;
  }

  .header__inner{
    min-height: 64px;
  }

  .header__links-wrapper{
    flex-direction:column;
    align-items:stretch;
    gap:0;
  }

  .header__dropdown-toggle{
    justify-content:space-between;
    padding:14px 16px;
  }

  .header__dropdown-menu{
    position:static;
    display:none;
    background:#0f0f0f;
    border:none;
  }

  .header__dropdown:hover .header__dropdown-menu{
    display:block;
  }

  .header__dropdown-item{
    padding:14px 20px;
    background:#1a1a1a;
    border-top:1px solid #2a2a2a;
    font-size:15px;
  }
}

/* ===============================
   LANGUAGE SWITCHER
=============================== */
.header__lang-switcher{
  display:inline-flex;
  gap:.5rem;
  align-items:center;
  font-size:1.3rem;
  margin-left:1rem;
}
.lang-flag.active{ text-decoration:underline }
.lang-flag.disabled{ opacity:.5; filter:grayscale(100%) }

</style>
</header>


    
      <div class="hero lazyload"
           data-bg="https://pyshine.com/assets/img/posts/26072022-python-logo.jpg"
           role="img"
           aria-label="How to Make a ChatGPT-like Application with FlexGen - Complete Tutorial">
    
        <div class="hero__wrap">

          
            <div class="hero__categories">
              
                <a class="label"
                   href="/categories/#AI tutorial series"
                   aria-label="Category: AI tutorial series">
                   AI tutorial series
                </a>
                
              
            </div>
          

          <h1 class="hero__title" itemprop="headline">How to Make a ChatGPT-like Application with FlexGen - Complete Tutorial</h1>

          <p class="hero__meta">
            <time datetime="2023-02-23T00:00:00+00:00" itemprop="datePublished">
              23 Feb 2023
            </time>
            &nbsp;¬∑&nbsp;
            
            <span itemprop="timeRequired">
              
                12 mins read
              
            </span>
          </p>
        </div>
      </div>

    <main class="site__content" role="main">

      <!-- ‚úÖ START: YouTube Video Section -->
      <section id="youtube-video" style="text-align:center; padding:5px 5px; background:#f8f8f8;">
        <div class="container">
          <div style="margin-top:25px;">
            <a href="https://www.youtube.com/@pyshine_official/shorts"
              target="_blank"
              style="background:#ff0000; color:white; padding:12px 24px; border-radius:6px; text-decoration:none; font-weight:bold; display:inline-flex; align-items:center; gap:8px;">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="16" viewBox="0 0 24 24">
                <path fill="#FFF" d="M23.5 6.2a3 3 0 0 0-2.1-2.1C19.5 3.5 12 3.5 12 3.5s-7.5 0-9.4.6A3 3 0 0 0 .5 6.2 31.5 31.5 0 0 0 0 12a31.5 31.5 0 0 0 .5 5.8 3 3 0 0 0 2.1 2.1c1.9.6 9.4.6 9.4.6s7.5 0 9.4-.6a3 3 0 0 0 2.1-2.1A31.5 31.5 0 0 0 24 12a31.5 31.5 0 0 0-.5-5.8z"/>
                <path fill="#FF0000" d="M9.75 15.02v-6l6 3z"/>
              </svg>
              Watch PyShine on YouTube
            </a>
          </div>
        </div>
      </section>

      <!-- ‚úÖ END: YouTube Video Section -->

      <div class="container post-layout">

        <!-- SIDEBAR TOC -->
        <aside class="post-toc" id="post-toc">
          <h3 class="no-toc">Contents</h3>
          <nav id="toc-list"></nav>
        </aside>

        <!-- MAIN CONTENT -->
        <article class="post-content"
                 itemprop="articleBody"
                 itemscope itemtype="https://schema.org/Article">

          <!-- INLINE TOC -->
          <div id="inline-toc" class="inline-toc-box">
            <h3 class="no-toc">Contents</h3>
            <nav id="inline-toc-list"></nav>
          </div>

          <h1 id="how-to-make-a-chatgpt-like-application-with-flexgen">How to Make a ChatGPT-like Application with FlexGen</h1>

<p>Hello friends! Yes, it is possible to make a chat GPT like application by compressing the GPT models to reduce their size and computational complexity. Model compression techniques can be used to reduce the number of parameters and operations required by the model without significantly impacting its performance. But before that let‚Äôs see what is GPT?</p>

<h1 id="gpt-generative-pre-trained-transformer">GPT (Generative Pre-trained Transformer)</h1>

<p>GPT (Generative Pre-trained Transformer) model consist of following components:</p>

<ul>
  <li>
    <p>Transformer architecture: GPT models are built using the Transformer architecture, which is a type of neural network that excels at processing sequences of variable length. The Transformer architecture is composed of multiple layers of self-attention and feedforward networks, which allows the model to attend to different parts of the input sequence and learn complex relationships between them.</p>
  </li>
  <li>
    <p>Pre-training task: GPT models are typically pre-trained on a large corpus of text using a language modeling objective, such as predicting the next word in a sequence given the previous words. Pre-training helps the model learn general language patterns and structures that can be fine-tuned for downstream tasks.</p>
  </li>
  <li>
    <p>Fine-tuning layers: After pre-training, the GPT model can be fine-tuned on a specific downstream task, such as text classification, question answering, or text generation. Fine-tuning involves adding task-specific layers on top of the pre-trained model and updating the model parameters on task-specific data.</p>
  </li>
  <li>
    <p>Embedding layer: The input to a GPT model is typically encoded as a sequence of tokens, which are converted into dense vector representations using an embedding layer. The embedding layer maps each token to a continuous vector space, which allows the model to capture the semantic relationships between the tokens.</p>
  </li>
  <li>
    <p>Positional encoding: The Transformer architecture does not inherently capture the order of the input sequence, so GPT models use a positional encoding scheme to incorporate positional information into the model. Positional encoding adds a learnable vector to each input token that encodes its position in the sequence.</p>
  </li>
  <li>
    <p>Vocabulary and tokenization: GPT models operate on a fixed vocabulary of tokens, which are typically selected based on their frequency in the training corpus. Text input is preprocessed by tokenizing it into a sequence of these vocabulary tokens, which are then fed into the GPT model.</p>
  </li>
  <li>
    <p>Together, these components allow GPT models to process and generate natural language text, making them powerful tools for a wide range of natural language processing tasks.</p>
  </li>
</ul>

<p>There are various approaches to compressing GPT models, including:</p>

<ul>
  <li>
    <p>Pruning: This involves removing the least important parameters from the model, based on their magnitude or sensitivity to perturbations. Pruning can significantly reduce the size of the model while preserving its accuracy.</p>
  </li>
  <li>
    <p>Quantization: This involves reducing the precision of the model‚Äôs weights and activations, such as converting them from 32-bit floating point to 16-bit or 8-bit integers. This reduces the model‚Äôs memory and computation requirements, but may slightly reduce its accuracy.</p>
  </li>
  <li>
    <p>Knowledge distillation: This involves training a smaller model to mimic the behavior of a larger, more complex model. The smaller model is trained using the larger model‚Äôs predictions as targets, which allows it to learn from the larger model‚Äôs knowledge. This can result in a smaller model with comparable performance to the larger one.</p>
  </li>
  <li>
    <p>Low-rank factorization: This involves decomposing the weight matrices of the model into lower-rank matrices, which reduces the number of parameters and computations required. This can be achieved using techniques such as singular value decomposition (SVD) or tensor decomposition.</p>
  </li>
  <li>
    <p>Grouped convolutions: This involves grouping the input and output channels of convolutional layers, which can reduce the number of parameters and computations required while preserving the spatial relationships between the features.</p>
  </li>
</ul>

<p>Overall, model compression techniques can help reduce the computational and memory requirements of GPT models, making them more efficient and practical for deployment in resource-constrained environments.</p>

<h2 id="lets-use-flexgen-to-make-a-chat-gpt-application">Let‚Äôs use FlexGen to make a chat GPT application</h2>

<h2 id="what-is-flexgen">What is FlexGen</h2>

<p>FlexGen is a method for compressing GPT (Generative Pre-trained Transformer) models, which was proposed in a research paper published by Facebook AI in 2021. The goal of FlexGen is to reduce the computational cost and memory footprint of GPT models without significantly affecting their performance.</p>

<p>FlexGen is based on the idea of dynamically adjusting the model‚Äôs architecture during inference based on the input sequence length. In traditional GPT models, the maximum sequence length is fixed during training and inference, which can lead to high computational and memory costs for long sequences. FlexGen addresses this issue by dividing the model into multiple stages, each optimized for a specific range of sequence lengths. During inference, FlexGen selects the appropriate stage based on the length of the input sequence, and only computes the necessary layers for that stage. This reduces the computational and memory cost compared to a traditional GPT model that computes all layers for every input sequence.</p>

<p>FlexGen also incorporates other model compression techniques such as weight pruning, quantization, and knowledge distillation to further reduce the size and computational cost of the model. Experimental results show that FlexGen can achieve significant speedup and memory savings compared to traditional GPT models, while maintaining similar or slightly improved performance on various language modeling benchmarks.</p>

<h2 id="make-the-simple-chat-gpt-like-application">Make the simple chat GPT like application</h2>

<h2 id="step-1-make-a-miniconda-environment-for-python-38">Step 1. Make a miniconda environment for python 3.8</h2>

<p>Download the appropriate version of Miniconda for your operating system from the official website: https://docs.conda.io/en/latest/miniconda.html</p>

<p>Install Miniconda by running the installer and following the on-screen instructions.</p>

<p>Open a terminal or command prompt and check that conda is installed and available in your path by running the command:</p>

<p><code class="language-plaintext highlighter-rouge">conda --version</code></p>

<p>Create a new Python 3.8 environment by running the following command:</p>

<p><code class="language-plaintext highlighter-rouge">conda create --name myenv python=3.8</code></p>

<p>Replace <code class="language-plaintext highlighter-rouge">myenv</code> with the name you want to give your new environment. You can choose any name you like.</p>

<p>Activate the new environment by running the following command:</p>

<p><code class="language-plaintext highlighter-rouge">conda activate myenv</code></p>

<p>Again, replace <code class="language-plaintext highlighter-rouge">myenv</code> with the name of your environment.</p>

<p>Now you can install packages and work with your Python 3.8 environment. For example, you can install NumPy by running the command:</p>

<p><code class="language-plaintext highlighter-rouge">conda install numpy</code></p>

<p>This will install the latest version of NumPy in your environment.</p>

<p>When you‚Äôre done working in your environment, you can deactivate it by running the following command:</p>

<p><code class="language-plaintext highlighter-rouge">conda deactivate</code></p>

<p>This will return you to your base environment.</p>

<p>That‚Äôs it! You now have Miniconda installed and a new Python 3.8 environment set up. You can create additional environments in the same way, each with its own set of packages and Python version.</p>

<h2 id="step-2-install-the-flexgen">Step 2. Install the FlexGen</h2>

<p>First of all activate the conda environment <code class="language-plaintext highlighter-rouge">conda activate myenv</code> for the python3.8.</p>

<p>Download the FlexGen repo and install by following the steps:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/FMInference/FlexGen.git
cd FlexGen
pip3 install -e .

## (Optional) Install openmpi for multi-gpu execution
## sudo apt install openmpi-bin
</code></pre></div></div>

<p>Now you can run the command to download the model and simply test.</p>

<p><code class="language-plaintext highlighter-rouge">python3 -m flexgen.flex_opt --model facebook/opt-1.3b</code></p>

<p>The command <code class="language-plaintext highlighter-rouge">python3 -m flexgen.flex_opt --model facebook/opt-1.3b</code> will be running a Python script that uses the FlexOpt model from Facebook AI Research.</p>

<p>FlexOpt is a neural network-based optimization solver that can be used to solve a wide range of optimization problems. It uses a neural network to learn how to solve optimization problems and can provide efficient solutions to problems with large-scale data.</p>

<p>The command ‚Äúpython3 -m flexgen.flex_opt‚Äù is used to run the FlexOpt module in Python 3. The ‚Äú‚Äìmodel facebook/opt-1.3b‚Äù argument specifies the location of the model file to be loaded for use in the optimization process. The model file is located in the ‚Äúfacebook/opt-1.3b‚Äù directory, and it contains the trained neural network parameters that are used to solve the optimization problem.</p>

<p>Here is a list of some of models to try</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>opt-1.3b
opt-3b
opt-6b
opt-12b
opt-24b
opt-30b
opt-175b
</code></pre></div></div>
<p>Each model has been trained on a large corpus of optimization problems and can be used to solve a wide range of optimization problems. The models vary in size and complexity, with opt-30b being the largest and most complex model with 175 billion parameters.</p>

<h2 id="step-3-run-the-app">Step 3 Run the app.</h2>

<p><code class="language-plaintext highlighter-rouge">python3 apps/chatbot.py --model facebook/opt-1.3b</code></p>

<h3 id="output">output</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Human: Hello! What can you do?
Assistant: As an AI assistant, I can answer questions and chat with you.
Human: What is the name of the tallest mountain in the world?
Assistant: Everest.
Human: I am planning a trip for our anniversary. What things can we do?
Assistant: Well, there are a number of things you can do for your anniversary. First, you can play cards. Second, you can go for a hike. Third, you can go to a museum.

</code></pre></div></div>

<h2 id="step-4-run-the-app-on-flask">Step 4 Run the app. on flask</h2>

<p>Follow the Flask tutorial as a reference to deploy your chat app</p>

<h2 id="major-advantages-of-chatgpt">Major advantages of ChatGPT</h2>

<ul>
  <li>
    <p>Improved customer service: Companies can use ChatGPT to provide automated chatbot-based customer service, which can help them to quickly and efficiently handle customer inquiries, provide solutions to common issues, and improve the overall customer experience.</p>
  </li>
  <li>
    <p>Enhanced customer engagement: By using ChatGPT, companies can engage with their customers in a more personalized and interactive way, which can help to build customer loyalty and improve brand recognition.</p>
  </li>
  <li>
    <p>Increased efficiency: ChatGPT can help automate a wide range of tasks, including customer service, scheduling, and data entry. By automating these tasks, companies can free up valuable time and resources, which can help to improve overall productivity and efficiency.</p>
  </li>
  <li>
    <p>Cost savings: By automating tasks and improving efficiency, ChatGPT can help companies reduce labor costs and improve overall profitability.</p>
  </li>
  <li>
    <p>Better insights: ChatGPT can help companies analyze customer interactions and conversations to gain insights into customer behavior, preferences, and needs. This information can be used to improve products and services, as well as to develop more targeted marketing campaigns.</p>
  </li>
</ul>

<h2 id="why-gpt-is-different-from-bert">Why GPT is different from BERT</h2>

<p>BERT (Bidirectional Encoder Representations from Transformers) and GPT (Generative Pre-trained Transformer) are both natural language processing (NLP) models developed by OpenAI and Google, respectively. While they share some similarities, they also have key differences, including:</p>

<ul>
  <li>
    <p>Task type: BERT is primarily used for bidirectional language modeling and pre-training for various downstream NLP tasks, such as question answering and sentiment analysis. GPT, on the other hand, is a generative language model that is primarily used for language generation and text completion tasks.</p>
  </li>
  <li>
    <p>Unidirectional vs bidirectional: BERT is a bidirectional model, meaning it takes into account both the preceding and succeeding words when making predictions, while GPT is a unidirectional model that only looks at the preceding words.</p>
  </li>
  <li>
    <p>Pre-training method: BERT is pre-trained using masked language modeling, where a portion of the input text is masked and the model is trained to predict the masked word. GPT, on the other hand, is pre-trained using a causal language modeling objective, where the model is trained to predict the next word in a sequence.</p>
  </li>
  <li>
    <p>Training data: BERT is pre-trained on a large corpus of unlabeled text from various sources, while GPT is pre-trained on a large corpus of web pages and text from various books.</p>
  </li>
  <li>
    <p>Output type: BERT produces contextualized word embeddings, while GPT produces a sequence of tokens that form a coherent text.</p>
  </li>
  <li>
    <p>Fine-tuning: BERT is typically fine-tuned for specific downstream tasks, while GPT is used as a general-purpose language model for generating text.</p>
  </li>
</ul>

<p>Both BERT and GPT are state-of-the-art NLP models that use the Transformer architecture, they have key differences in task type, pre-training method, training data, output type, and fine-tuning.</p>

<h2 id="conclusion">Conclusion</h2>

<p>A chat application, whether for personal or business use, can offer several advantages, including:</p>

<ul>
  <li>
    <p>Real-time communication: Chat applications enable users to communicate in real-time, making it an efficient and quick way to exchange information and have conversations. This can be particularly useful for businesses where fast communication is often necessary to make quick decisions or respond to customer inquiries.</p>
  </li>
  <li>
    <p>Accessible from anywhere: Chat applications are often cloud-based, which means they can be accessed from anywhere with an internet connection. This makes them particularly useful for remote teams, allowing team members to communicate and collaborate even when they are not in the same physical location.</p>
  </li>
  <li>
    <p>Cost-effective: Chat applications are often free or relatively low-cost, making them an affordable communication tool for both individuals and businesses. This can be particularly helpful for small businesses or startups with limited budgets.</p>
  </li>
  <li>
    <p>Record of communication: Chat applications typically provide a record of past conversations, which can be helpful for future reference or to keep a record of important information. This can be particularly useful in business settings where keeping track of conversations and decisions is crucial.</p>
  </li>
  <li>
    <p>Enhanced productivity: Chat applications can help enhance productivity by reducing the need for face-to-face meetings and phone calls. This can save time and allow team members to focus on their work without being interrupted.</p>
  </li>
  <li>
    <p>Increased engagement: Chat applications can provide a more engaging and interactive way for users to communicate, particularly when used in conjunction with features such as emojis, GIFs, and stickers. This can help build better relationships and improve the overall communication experience.</p>
  </li>
</ul>

<p>In summary, chat applications offer real-time communication, accessibility, cost-effectiveness, a record of communication, enhanced productivity, and increased engagement, making them a valuable tool for personal and business use.</p>

<h2 id="related-posts">Related Posts</h2>

<ul>
  <li><a href="/Learn-Python-Part-01/">Learn Python Part 01 - Complete Beginner‚Äôs Guide</a></li>
  <li><a href="/How-to-earn-money-online-using-python-programming-skills/">How to Earn Money Online Using Python Programming Skills</a></li>
  <li><a href="/Quick-Python-Tips/">75+ Good Python Coding Examples for Software Development</a></li>
</ul>



          <!-- Syntax Highlighting -->
          <link href="/assets/css/syntax.css" rel="stylesheet">
          <script src="/assets/scripts/copyCode.js" async></script>

          <!-- Ads -->
          <section aria-label="Advertisements" class="ads mt-4">
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-2976211678184829"
                 data-ad-slot="7658460605"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
              (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
          </section>

        </article>

      </div>

      <!-- Post Navigation -->
      <nav class="post-navigation controls__inner mt-5" aria-label="Post navigation">
        <div class="controls__item prev">
          
            <span>Previous</span>
            <a href="/Interview-questions-for-python-programming/" rel="prev">
              Interview questions for python progra...
            </a>
          
        </div>

        <div class="controls__item next">
          
            <span>Next</span>
            <a href="/what-is-svd/" rel="next">
              What is SVD
            </a>
          
        </div>
      </nav>

      <!-- Related Posts -->
      
      
      
      
      
      
      
      
      
      
        <section class="related-posts mt-5" aria-label="Related Posts">
          <div class="container">
            <h2 class="related-posts__title">Related Posts</h2>
            <div class="related-posts__grid">
              
                <a class="related-post-card" href="/Make-Rock-Scissors-Paper-Game/">
                  
                    <div class="related-post-card__image">
                      <img src="https://www.pyshine.com/assets/img/posts/26072022-python-logo_thumb.jpg" 
                           alt="Let's build a simple "Rock, Paper, Scissors" game"
                           loading="lazy" />
                    </div>
                  
                  <div class="related-post-card__content">
                    <h3 class="related-post-card__title">Let's build a simple "Rock, Paper, Scissors" game</h3>
                    <p class="related-post-card__excerpt">
                      
                        Let's create a simple "Rock, Paper, Scissors" game where the user can play against the...
                      
                    </p>
                    <span class="related-post-card__date">
                      May 25, 2024
                    </span>
                  </div>
                </a>
              
                <a class="related-post-card" href="/Easy-video-stream-using-picamera-over-wifi-python/">
                  
                    <div class="related-post-card__image">
                      <img src="https://www.pyshine.com/assets/img/posts/jeep03_thumb.jpg" 
                           alt="How to easily stream picamera video over wifi with..."
                           loading="lazy" />
                    </div>
                  
                  <div class="related-post-card__content">
                    <h3 class="related-post-card__title">How to easily stream picamera video over wifi with...</h3>
                    <p class="related-post-card__excerpt">
                      
                        Hi friends! Today‚Äôs tutorial is Part 03 of the Raspberry Pi learning series. You will...
                      
                    </p>
                    <span class="related-post-card__date">
                      Apr 16, 2021
                    </span>
                  </div>
                </a>
              
                <a class="related-post-card" href="/Make-GUI-With-Matplotlib-And-PyQt5-Video-Audio/">
                  
                    <div class="related-post-card__image">
                      <img src="https://www.pyshine.com/assets/img/posts/2022-01-17-plot-vi_thumb.jpg" 
                           alt="PytQt5 Video and Audio GUI with start and stop buttons"
                           loading="lazy" />
                    </div>
                  
                  <div class="related-post-card__content">
                    <h3 class="related-post-card__title">PytQt5 Video and Audio GUI with start and stop buttons</h3>
                    <p class="related-post-card__excerpt">
                      
                        Hello friends, this tutorial is about displaying mp4 video and its audio plot on the...
                      
                    </p>
                    <span class="related-post-card__date">
                      Jan 17, 2022
                    </span>
                  </div>
                </a>
              
                <a class="related-post-card" href="/Top-10-AI-Models/">
                  
                    <div class="related-post-card__image">
                      <img src="https://www.pyshine.com/assets/img/posts/2026-ai/2026-ai_thumb.jpg" 
                           alt="Top 10 AI Models You Need to Know in 2026 - Complete Guide"
                           loading="lazy" />
                    </div>
                  
                  <div class="related-post-card__content">
                    <h3 class="related-post-card__title">Top 10 AI Models You Need to Know in 2026 - Complete Guide</h3>
                    <p class="related-post-card__excerpt">
                      
                        # Top 10 AI Models You Need to Know in 2026 Artificial Intelligence has evolved...
                      
                    </p>
                    <span class="related-post-card__date">
                      Feb 16, 2026
                    </span>
                  </div>
                </a>
              
                <a class="related-post-card" href="/PyQt5-related-Questions-and-Answers/">
                  
                    <div class="related-post-card__image">
                      <img src="https://www.pyshine.com/assets/img/posts/pyqt5logo_thumb.jpg" 
                           alt="FAQs about PyQt5"
                           loading="lazy" />
                    </div>
                  
                  <div class="related-post-card__content">
                    <h3 class="related-post-card__title">FAQs about PyQt5</h3>
                    <p class="related-post-card__excerpt">
                      
                        Hi friends, we are going to start a Q and A about PyQt5 here. This...
                      
                    </p>
                    <span class="related-post-card__date">
                      Apr 19, 2022
                    </span>
                  </div>
                </a>
              
                <a class="related-post-card" href="/Faster-video-transfer-over-wifi/">
                  
                    <div class="related-post-card__image">
                      <img src="https://www.pyshine.com/assets/img/posts/pubsub_thumb.jpg" 
                           alt="Faster Video Transfer Over WiFi Using ZeroMQ - Python Tutorial"
                           loading="lazy" />
                    </div>
                  
                  <div class="related-post-card__content">
                    <h3 class="related-post-card__title">Faster Video Transfer Over WiFi Using ZeroMQ - Python Tut...</h3>
                    <p class="related-post-card__excerpt">
                      
                        Faster Video Transfer Over WiFi Using ZeroMQ Hi friends HAPPY NEW YEAR 2021! In a...
                      
                    </p>
                    <span class="related-post-card__date">
                      Jan 01, 2021
                    </span>
                  </div>
                </a>
              
            </div>
          </div>
        </section>
      

      <!-- Disqus -->
      
        <section class="comments mt-5" aria-label="Comments Section">
          
<section class="comments mt-5" aria-label="Comments Section" style="text-align: center; padding: 50px 0; background-color: #fafafa;">
  <div id="disqus_thread" style="max-width: 800px; margin: 0 auto;"></div>
  <script>

var disqus_config = function () {
this.page.url = 'https://pyshine.com/How-to-make-chat-GPT-like-application/';
this.page.identifier = 'https://pyshine.com/How-to-make-chat-GPT-like-application/';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://https-py2ai-github-io.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the comments.</noscript>
</section>


        </section>
      

    </main>

    <footer class="footer">
  <div class="container">
    <nav class="social">
      
      
      
    </nav>
    <span>&copy; 2026 PyShine. All rights reserved.</span>
  </div>
</footer>
<script async src="/assets/js/bundle.js"></script>

<script async>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js').then(function( registration ) {
      console.log('ServiceWorker registration successful with scope: ', registration.scope);
    })
    .catch(function(error) {
      console.log('ServiceWorker registration failed: ', error);
    });
  }
</script>



    <!-- Back to Top Button -->
    <button id="back-to-top" class="back-to-top" aria-label="Back to top">
      <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="18 15 12 9 6 15"></polyline>
      </svg>
    </button>

    <!-- MathJax -->
    
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script
  type="text/javascript"
  charset="utf-8"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
>
</script>
<script
  type="text/javascript"
  charset="utf-8"
  src="https://vincenttam.github.io/javascripts/MathJaxLocal.js"
>
</script>



    <!-- Ads -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

    <!-- SIDEBAR TOC SCRIPT -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
      const toc = document.getElementById("toc-list");
      const headings = document.querySelectorAll(
        ".post-content h2:not(.no-toc), .post-content h3:not(.no-toc)"
      );
      if (!toc || headings.length === 0) return;

      const ul = document.createElement("ul");
      headings.forEach(h => {
        const id = h.id || h.textContent.trim().toLowerCase().replace(/\s+/g, "-");
        h.id = id;

        const li = document.createElement("li");
        if (h.tagName === "H3") li.style.marginLeft = "1rem";

        li.innerHTML = `<a href="#${id}">${h.textContent}</a>`;
        ul.appendChild(li);
      });
      toc.appendChild(ul);
    });
    </script>

    <!-- INLINE TOC SCRIPT -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
      const tocTarget = document.getElementById("inline-toc-list");
      const headings = document.querySelectorAll(
        ".post-content h2:not(.no-toc), .post-content h3:not(.no-toc)"
      );
      if (!tocTarget || headings.length === 0) return;

      const ul = document.createElement("ul");
      headings.forEach(h => {
        const id = h.id || h.textContent.trim().toLowerCase().replace(/\s+/g, "-");
        h.id = id;

        const li = document.createElement("li");
        if (h.tagName === "H3") li.style.marginLeft = "1rem";

        li.innerHTML = `<a href="#${id}">${h.textContent}</a>`;
        ul.appendChild(li);
      });
      tocTarget.appendChild(ul);
    });
    </script>

    <!-- Back to Top Button Script -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
      const backToTopButton = document.getElementById("back-to-top");
      if (!backToTopButton) return;

      // Show button when scrolled down 300px
      window.addEventListener("scroll", function() {
        if (window.pageYOffset > 300) {
          backToTopButton.classList.add("visible");
        } else {
          backToTopButton.classList.remove("visible");
        }
      });

      // Smooth scroll to top when clicked
      backToTopButton.addEventListener("click", function() {
        window.scrollTo({
          top: 0,
          behavior: "smooth"
        });
      });
    });
    </script>

    <!-- INLINE TOC STYLES -->
    <style>
      .inline-toc-box {
        background: #D4EDFD;
        padding: 15px 20px;
        border-radius: 10px;
        margin-bottom: 25px;
        border: 1px solid #e0e0e0;
      }
      .inline-toc-box ul {
        margin: 0;
        padding-left: 18px;
      }
      .inline-toc-box li {
        margin-bottom: 6px;
      }
      /* Center post navigation */
      .post-navigation.controls__inner {
        justify-content: center !important;
        gap: 4rem;
      }
      /* Related Posts Styles */
      .related-posts {
        margin-top: 3rem;
        padding: 2rem 0;
        border-top: 1px solid #e0e0e0;
      }
      .related-posts .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1rem;
      }
      .related-posts__title {
        font-size: 1.75rem;
        margin-bottom: 1.5rem;
        color: #000000;
        text-align: center;
      }
      .related-posts__grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1.5rem;
        max-width: 1200px;
        margin: 0 auto;
      }
      .related-post-card {
        display: block;
        text-decoration: none;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        overflow: hidden;
        transition: box-shadow 0.3s ease, transform 0.3s ease;
      }
      .related-post-card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        transform: translateY(-4px);
      }
      .related-post-card__image {
        width: 100%;
        height: 100px;
        background: #f5f5f5;
      }
      .related-post-card__image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .related-post-card__content {
        padding: 0.75rem;
      }
      .related-post-card__title {
        font-size: 0.95rem;
        margin: 0 0 0.4rem 0;
        color: #000000;
        line-height: 1.3;
        font-weight: 600;
      }
      .related-post-card__excerpt {
        font-size: 0.8rem;
        color: #666;
        margin: 0 0 0.5rem 0;
        line-height: 1.4;
      }
      .related-post-card__date {
        font-size: 0.75rem;
        color: #999;
      }
      @media (max-width: 992px) {
        .related-posts__grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }
      @media (max-width: 600px) {
        .related-posts__grid {
          grid-template-columns: 1fr;
        }
      }
      /* Back to Top Button Styles */
      .back-to-top {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 50px;
        height: 50px;
        background: #000000;
        color: #ffffff;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        opacity: 0;
        visibility: hidden;
        transform: translateY(20px);
        transition: all 0.3s ease;
        z-index: 9999;
      }
      .back-to-top.visible {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }
      .back-to-top:hover {
        background: #333333;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
        transform: translateY(-2px);
      }
      .back-to-top:active {
        transform: translateY(0);
      }
      @media (max-width: 768px) {
        .back-to-top {
          bottom: 20px;
          right: 20px;
          width: 45px;
          height: 45px;
        }
      }
    </style>

  </body>
</html>


