<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.4">Jekyll</generator><link href="https://www.pyshine.com/atom.xml" rel="self" type="application/atom+xml" /><link href="https://www.pyshine.com/" rel="alternate" type="text/html" hreflang="en" /><updated>2025-11-12T11:13:49+00:00</updated><id>https://www.pyshine.com/atom.xml</id><title type="html">PyShine</title><subtitle>Simple and practical Python tutorials for everyone. Learn, build, and explore AI and coding step by step — no jargon, just clear explanations.</subtitle><author><name>PyShine Team</name></author><entry><title type="html">Garden Data Live Chart Tutorial with Python</title><link href="https://www.pyshine.com/Multiple-Categories-Plot-Excel/" rel="alternate" type="text/html" title="Garden Data Live Chart Tutorial with Python" /><published>2025-11-11T00:00:00+00:00</published><updated>2025-11-11T00:00:00+00:00</updated><id>https://www.pyshine.com/Multiple-Categories-Plot-Excel</id><content type="html" xml:base="https://www.pyshine.com/Multiple-Categories-Plot-Excel/"><![CDATA[<h1 id="garden-data-live-chart-in-python">Garden Data Live Chart in Python</h1>

<h3 id="beginner-friendly-tutorial--live-refreshing-excel-charts">Beginner-Friendly Tutorial – Live-Refreshing Excel Charts</h3>

<p>This tutorial walks you through creating a <strong>live-updating chart viewer</strong> for Excel sheets using <strong>Python</strong>, <strong>Pandas</strong>, <strong>Matplotlib</strong>, and <strong>Watchdog</strong>. By the end, you will have a tool that:</p>
<ul>
  <li>Reads multiple sheets from an Excel file.</li>
  <li>Displays <strong>grouped bar charts</strong> with proper labels.</li>
  <li>Automatically refreshes when the Excel file is updated.</li>
  <li>Allows switching between sheets using clickable buttons.</li>
</ul>

<h2 id="table-of-contents">Table of Contents</h2>
<ul>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#setting-up-your-environment">Setting Up Your Environment</a></li>
  <li><a href="#reading-excel-sheets">Reading Excel Sheets</a></li>
  <li><a href="#drawing-charts-with-matplotlib">Drawing Charts with Matplotlib</a></li>
  <li><a href="#adding-sheet-selection-buttons">Adding Sheet Selection Buttons</a></li>
  <li><a href="#watching-for-file-changes">Watching for File Changes</a></li>
  <li><a href="#putting-it-all-together">Putting It All Together</a></li>
  <li><a href="#complete-code">Complete Code</a></li>
  <li><a href="#running-the-script">Running the Script</a></li>
  <li><a href="#key-learnings">Key Learnings</a></li>
  <li><a href="#further-improvements">Further Improvements</a></li>
</ul>

<h2 id="overview">Overview</h2>

<p>We are building a <strong>live chart viewer</strong> for an Excel file named <code class="language-plaintext highlighter-rouge">garden_data.xlsx</code>. Each sheet in the Excel file can be visualized as a <strong>grouped bar chart</strong>. The program automatically detects changes in the Excel file and updates the chart, making it useful for monitoring live data.</p>

<p>Key features:</p>
<ul>
  <li>Live-refreshing grouped bar charts.</li>
  <li>Automatic detection of Excel sheet changes.</li>
  <li>Multiple numeric columns per chart.</li>
  <li>Interactive sheet selection buttons.</li>
  <li>Beginner-friendly structure and code clarity.</li>
</ul>

<h2 id="setting-up-your-environment">Setting Up Your Environment</h2>

<p>Install the required packages if you haven’t already:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>pandas matplotlib watchdog numpy
</code></pre></div></div>

<p>Import the necessary libraries in your Python script:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">watchdog.observers</span> <span class="kn">import</span> <span class="n">Observer</span>
<span class="kn">from</span> <span class="nn">watchdog.events</span> <span class="kn">import</span> <span class="n">FileSystemEventHandler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">Button</span>
</code></pre></div></div>

<h2 id="reading-excel-sheets">Reading Excel Sheets</h2>

<p>Define the Excel file to monitor and helper variables:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">filename</span> <span class="o">=</span> <span class="s">"garden_data.xlsx"</span>
<span class="n">needs_update</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">current_sheet</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">sheet_buttons</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></div>

<p>Function to get all sheet names:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_sheet_names</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">xls</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">xls</span><span class="p">.</span><span class="n">sheet_names</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error reading file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></div>

<p>This function uses <strong>Pandas</strong> to safely read the sheet names, handling errors if the file is missing or corrupted.</p>

<h2 id="drawing-charts-with-matplotlib">Drawing Charts with Matplotlib</h2>

<p>This function handles drawing <strong>grouped bar charts</strong> for a selected sheet:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">draw_chart</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">xls</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Error reading file:</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="n">sheet_names</span> <span class="o">=</span> <span class="n">xls</span><span class="p">.</span><span class="n">sheet_names</span>
    <span class="k">if</span> <span class="n">sheet_name</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">sheet_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sheet_names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sheet_names</span><span class="p">:</span>
            <span class="n">sheet_name</span> <span class="o">=</span> <span class="n">sheet_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s">"No sheets found"</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>
            <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">df</span><span class="p">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">f</span><span class="s">"No data in '</span><span class="si">{</span><span class="n">sheet_name</span><span class="si">}</span><span class="s">'"</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>
            <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">categorical_cols</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">number</span><span class="p">]).</span><span class="n">columns</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">numeric_cols</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">number</span><span class="p">]).</span><span class="n">columns</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">categorical_cols</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">numeric_cols</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Need both categorical and numeric columns in '</span><span class="si">{</span><span class="n">sheet_name</span><span class="si">}</span><span class="s">'"</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>
            <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">xcol</span> <span class="o">=</span> <span class="n">categorical_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">xcol</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">).</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">n_numeric</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">numeric_cols</span><span class="p">)</span>
        <span class="n">n_categories</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">Set3</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_numeric</span><span class="p">))</span>
        <span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="o">/</span> <span class="n">n_numeric</span>
        <span class="n">x_pos</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_categories</span><span class="p">)</span>

        <span class="n">bars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">numeric_col</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">numeric_cols</span><span class="p">,</span> <span class="n">colors</span><span class="p">)):</span>
            <span class="n">bar_positions</span> <span class="o">=</span> <span class="n">x_pos</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">bar_width</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.8</span> <span class="o">-</span> <span class="n">bar_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">bar</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">bar_positions</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">numeric_col</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">bar_width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">numeric_col</span><span class="p">)</span>
            <span class="n">bars</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">bar</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numeric_col</span><span class="p">]):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="p">.</span><span class="n">isna</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                    <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">bar_positions</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">value</span> <span class="o">+</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numeric_col</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">),</span> <span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="p">.</span><span class="mi">1</span><span class="n">f</span><span class="si">}</span><span class="s">'</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'bottom'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">sheet_name</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s">'bold'</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x_pos</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">'right'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s">'y'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'top'</span><span class="p">].</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'right'</span><span class="p">].</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">n_numeric</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">'best'</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_numeric</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xcol</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">)</span>
        <span class="n">y_label</span> <span class="o">=</span> <span class="n">numeric_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">n_numeric</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s">"Values"</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

        <span class="n">y_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="nb">max</span><span class="p">()</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_cols</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">isna</span><span class="p">().</span><span class="nb">all</span><span class="p">()])</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">*</span> <span class="mf">1.15</span><span class="p">)</span>

    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Error processing sheet '</span><span class="si">{</span><span class="n">sheet_name</span><span class="si">}</span><span class="s">':</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">traceback</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Detailed error: </span><span class="si">{</span><span class="n">traceback</span><span class="p">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
</code></pre></div></div>

<p>This function:</p>
<ul>
  <li>Handles empty sheets and missing numeric/categorical columns.</li>
  <li>Creates <strong>grouped bars</strong> if multiple numeric columns exist.</li>
  <li>Adds <strong>value labels</strong> on top of each bar.</li>
  <li>Styles the chart with <strong>grid, spines, and rotated labels</strong>.</li>
  <li>Adjusts y-axis to fit the tallest bar.</li>
</ul>

<h2 id="adding-sheet-selection-buttons">Adding Sheet Selection Buttons</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">on_sheet_button_clicked</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">current_sheet</span><span class="p">,</span> <span class="n">needs_update</span>
    <span class="n">current_sheet</span> <span class="o">=</span> <span class="n">sheet_name</span>
    <span class="n">needs_update</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">for</span> <span class="n">btn</span><span class="p">,</span> <span class="n">s_name</span> <span class="ow">in</span> <span class="n">sheet_buttons</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">s_name</span> <span class="o">==</span> <span class="n">sheet_name</span><span class="p">:</span>
            <span class="n">btn</span><span class="p">.</span><span class="n">color</span> <span class="o">=</span> <span class="s">'#4CAF50'</span>
            <span class="n">btn</span><span class="p">.</span><span class="n">hovercolor</span> <span class="o">=</span> <span class="s">'#45a049'</span>
            <span class="n">btn</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">'black'</span><span class="p">)</span>
            <span class="n">btn</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_fontweight</span><span class="p">(</span><span class="s">'bold'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">btn</span><span class="p">.</span><span class="n">color</span> <span class="o">=</span> <span class="s">'#f8f9fa'</span>
            <span class="n">btn</span><span class="p">.</span><span class="n">hovercolor</span> <span class="o">=</span> <span class="s">'#e9ecef'</span>
            <span class="n">btn</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">'black'</span><span class="p">)</span>
            <span class="n">btn</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_fontweight</span><span class="p">(</span><span class="s">'normal'</span><span class="p">)</span>
        <span class="n">btn</span><span class="p">.</span><span class="n">ax</span><span class="p">.</span><span class="n">figure</span><span class="p">.</span><span class="n">canvas</span><span class="p">.</span><span class="n">draw_idle</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">create_sheet_buttons</span><span class="p">(</span><span class="n">sheet_names</span><span class="p">,</span> <span class="n">fig</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">sheet_buttons</span><span class="p">,</span> <span class="n">current_sheet</span>
    <span class="k">for</span> <span class="n">btn</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sheet_buttons</span><span class="p">:</span>
        <span class="n">btn</span><span class="p">.</span><span class="n">ax</span><span class="p">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="n">sheet_buttons</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sheet_names</span><span class="p">:</span> <span class="k">return</span>
    <span class="n">n_sheets</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sheet_names</span><span class="p">)</span>
    <span class="n">max_buttons_per_row</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">button_height</span> <span class="o">=</span> <span class="mf">0.06</span>
    <span class="n">button_spacing</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_sheets</span> <span class="o">+</span> <span class="n">max_buttons_per_row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">max_buttons_per_row</span>
    <span class="n">buttons_per_row</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">n_sheets</span><span class="p">,</span> <span class="n">max_buttons_per_row</span><span class="p">)</span>
    <span class="n">button_width</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.8</span> <span class="o">-</span> <span class="p">(</span><span class="n">buttons_per_row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">button_spacing</span><span class="p">)</span> <span class="o">/</span> <span class="n">buttons_per_row</span>
    <span class="n">start_y</span> <span class="o">=</span> <span class="mf">0.15</span> <span class="o">-</span> <span class="p">(</span><span class="n">rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">button_height</span> <span class="o">+</span> <span class="mf">0.02</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sheet_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sheet_names</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">buttons_per_row</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">buttons_per_row</span>
        <span class="n">x_pos</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">+</span> <span class="n">col</span> <span class="o">*</span> <span class="p">(</span><span class="n">button_width</span> <span class="o">+</span> <span class="n">button_spacing</span><span class="p">)</span>
        <span class="n">y_pos</span> <span class="o">=</span> <span class="n">start_y</span> <span class="o">-</span> <span class="n">row</span> <span class="o">*</span> <span class="p">(</span><span class="n">button_height</span> <span class="o">+</span> <span class="mf">0.02</span><span class="p">)</span>
        <span class="n">btn_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">axes</span><span class="p">([</span><span class="n">x_pos</span><span class="p">,</span> <span class="n">y_pos</span><span class="p">,</span> <span class="n">button_width</span><span class="p">,</span> <span class="n">button_height</span><span class="p">])</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">btn_ax</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'#f8f9fa'</span><span class="p">,</span> <span class="n">hovercolor</span><span class="o">=</span><span class="s">'#e9ecef'</span><span class="p">)</span>
        <span class="n">btn</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">btn</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_fontweight</span><span class="p">(</span><span class="s">'normal'</span><span class="p">)</span>
        <span class="n">btn</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">'black'</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">btn_ax</span><span class="p">.</span><span class="n">spines</span><span class="p">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">spine</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">'#dee2e6'</span><span class="p">)</span>
            <span class="n">spine</span><span class="p">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">btn</span><span class="p">.</span><span class="n">on_clicked</span><span class="p">(</span><span class="k">lambda</span> <span class="n">event</span><span class="p">,</span> <span class="n">sn</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">:</span> <span class="n">on_sheet_button_clicked</span><span class="p">(</span><span class="n">sn</span><span class="p">))</span>
        <span class="n">sheet_buttons</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">btn</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">sheet_names</span><span class="p">:</span>
        <span class="n">current_sheet</span> <span class="o">=</span> <span class="n">sheet_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">on_sheet_button_clicked</span><span class="p">(</span><span class="n">current_sheet</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="watching-for-file-changes">Watching for File Changes</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Watcher</span><span class="p">(</span><span class="n">FileSystemEventHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_modified</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">needs_update</span>
        <span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="n">src_path</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">needs_update</span> <span class="o">=</span> <span class="bp">True</span>
</code></pre></div></div>

<p>This uses <strong>Watchdog</strong> to detect when the Excel file is modified and triggers a refresh of the chart.</p>

<h2 id="putting-it-all-together">Putting It All Together</h2>

<p>Initialize the figure, axes, buttons, and observer:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">axes</span><span class="p">([</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">ax_bg</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
<span class="n">ax_bg</span><span class="p">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">'#f1f3f4'</span><span class="p">)</span>
<span class="c1"># ... add labels and style
</span><span class="n">sheet_names</span> <span class="o">=</span> <span class="n">get_sheet_names</span><span class="p">()</span>
<span class="k">if</span> <span class="n">sheet_names</span><span class="p">:</span>
    <span class="n">create_sheet_buttons</span><span class="p">(</span><span class="n">sheet_names</span><span class="p">,</span> <span class="n">fig</span><span class="p">)</span>
<span class="n">draw_chart</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">current_sheet</span><span class="p">)</span>

<span class="n">observer</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">()</span>
<span class="n">event_handler</span> <span class="o">=</span> <span class="n">Watcher</span><span class="p">()</span>
<span class="n">observer</span><span class="p">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">event_handler</span><span class="p">,</span> <span class="s">"."</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">observer</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">needs_update</span><span class="p">:</span>
            <span class="n">draw_chart</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">current_sheet</span><span class="p">)</span>
            <span class="n">new_sheet_names</span> <span class="o">=</span> <span class="n">get_sheet_names</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">new_sheet_names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">sheet_names</span><span class="p">):</span>
                <span class="n">sheet_names</span> <span class="o">=</span> <span class="n">new_sheet_names</span>
                <span class="n">create_sheet_buttons</span><span class="p">(</span><span class="n">sheet_names</span><span class="p">,</span> <span class="n">fig</span><span class="p">)</span>
            <span class="n">needs_update</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
    <span class="n">observer</span><span class="p">.</span><span class="n">stop</span><span class="p">()</span>
<span class="n">observer</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="complete-code">Complete Code</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Source code at www.pyshine.com
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">watchdog.observers</span> <span class="kn">import</span> <span class="n">Observer</span>
<span class="kn">from</span> <span class="nn">watchdog.events</span> <span class="kn">import</span> <span class="n">FileSystemEventHandler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">Button</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s">"garden_data.xlsx"</span>
<span class="n">needs_update</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">current_sheet</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">sheet_buttons</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">get_sheet_names</span><span class="p">():</span>
    <span class="s">"""Get all sheet names from the Excel file"""</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">xls</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">xls</span><span class="p">.</span><span class="n">sheet_names</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error reading file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">draw_chart</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">xls</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Error reading file:</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> 
                <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="n">sheet_names</span> <span class="o">=</span> <span class="n">xls</span><span class="p">.</span><span class="n">sheet_names</span>
    
    <span class="k">if</span> <span class="n">sheet_name</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">sheet_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sheet_names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sheet_names</span><span class="p">:</span>
            <span class="n">sheet_name</span> <span class="o">=</span> <span class="n">sheet_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s">"No sheets found"</span><span class="p">,</span> 
                    <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>
            <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">return</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">)</span>
        
        <span class="c1"># Check if dataframe is empty
</span>        <span class="k">if</span> <span class="n">df</span><span class="p">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">f</span><span class="s">"No data in '</span><span class="si">{</span><span class="n">sheet_name</span><span class="si">}</span><span class="s">'"</span><span class="p">,</span> 
                    <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>
            <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">return</span>
            
        <span class="c1"># Identify categorical and numeric columns
</span>        <span class="n">categorical_cols</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">number</span><span class="p">]).</span><span class="n">columns</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">numeric_cols</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">number</span><span class="p">]).</span><span class="n">columns</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">categorical_cols</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">numeric_cols</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Need both categorical and numeric columns in '</span><span class="si">{</span><span class="n">sheet_name</span><span class="si">}</span><span class="s">'"</span><span class="p">,</span> 
                    <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>
            <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">return</span>
        
        <span class="c1"># Use first categorical column as x-axis
</span>        <span class="n">xcol</span> <span class="o">=</span> <span class="n">categorical_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">xcol</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">).</span><span class="n">tolist</span><span class="p">()</span>
        
        <span class="c1"># Create grouped bar chart for multiple numeric columns
</span>        <span class="n">n_numeric</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">numeric_cols</span><span class="p">)</span>
        <span class="n">n_categories</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span>
        
        <span class="c1"># Set up colors for different numeric columns
</span>        <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">Set3</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_numeric</span><span class="p">))</span>
        
        <span class="c1"># Calculate bar positions
</span>        <span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="o">/</span> <span class="n">n_numeric</span>
        <span class="n">x_pos</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_categories</span><span class="p">)</span>
        
        <span class="c1"># Create bars for each numeric column
</span>        <span class="n">bars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">numeric_col</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">numeric_cols</span><span class="p">,</span> <span class="n">colors</span><span class="p">)):</span>
            <span class="n">bar_positions</span> <span class="o">=</span> <span class="n">x_pos</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">bar_width</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.8</span> <span class="o">-</span> <span class="n">bar_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">bar</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">bar_positions</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">numeric_col</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">bar_width</span><span class="p">,</span> 
                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">numeric_col</span><span class="p">)</span>
            <span class="n">bars</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">bar</span><span class="p">)</span>
            
            <span class="c1"># Add value labels on top of bars
</span>            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numeric_col</span><span class="p">]):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="p">.</span><span class="n">isna</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                    <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">bar_positions</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">value</span> <span class="o">+</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numeric_col</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">),</span> 
                           <span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="p">.</span><span class="mi">1</span><span class="n">f</span><span class="si">}</span><span class="s">'</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'bottom'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        
        <span class="c1"># Customize the chart
</span>        <span class="n">ax</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">sheet_name</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s">'bold'</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># Increased pad for legend space
</span>        <span class="n">ax</span><span class="p">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x_pos</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">'right'</span><span class="p">)</span>
        
        <span class="c1"># Style the chart
</span>        <span class="n">ax</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s">'y'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'top'</span><span class="p">].</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'right'</span><span class="p">].</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        
        <span class="c1"># Add legend for numeric columns at top middle
</span>        <span class="k">if</span> <span class="n">n_numeric</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Place legend at top center, above the plot
</span>            <span class="n">ax</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">'best'</span><span class="p">,</span> 
                     <span class="n">ncol</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_numeric</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
        
        <span class="c1"># Position x-axis label at the end of the x-axis (right side)
</span>        <span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xcol</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">)</span>  <span class="c1"># Right end, slightly below
</span>        
        <span class="c1"># Add y-axis label for numeric values
</span>        <span class="k">if</span> <span class="n">n_numeric</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">y_label</span> <span class="o">=</span> <span class="n">numeric_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y_label</span> <span class="o">=</span> <span class="s">"Values"</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>  <span class="c1"># Left side, at top
</span>        
        <span class="c1"># Adjust y-axis limits to accommodate value labels
</span>        <span class="n">y_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="nb">max</span><span class="p">()</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_cols</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">isna</span><span class="p">().</span><span class="nb">all</span><span class="p">()])</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">*</span> <span class="mf">1.15</span><span class="p">)</span>
        
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Error processing sheet '</span><span class="si">{</span><span class="n">sheet_name</span><span class="si">}</span><span class="s">':</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>
                <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">traceback</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Detailed error: </span><span class="si">{</span><span class="n">traceback</span><span class="p">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">on_sheet_button_clicked</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">):</span>
    <span class="s">"""Callback when a sheet button is clicked"""</span>
    <span class="k">global</span> <span class="n">current_sheet</span><span class="p">,</span> <span class="n">needs_update</span>
    <span class="n">current_sheet</span> <span class="o">=</span> <span class="n">sheet_name</span>
    <span class="n">needs_update</span> <span class="o">=</span> <span class="bp">True</span>
    
    <span class="c1"># Update button colors to show active state with black text
</span>    <span class="k">for</span> <span class="n">btn</span><span class="p">,</span> <span class="n">s_name</span> <span class="ow">in</span> <span class="n">sheet_buttons</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">s_name</span> <span class="o">==</span> <span class="n">sheet_name</span><span class="p">:</span>
            <span class="c1"># Active button - colored background with black text
</span>            <span class="n">btn</span><span class="p">.</span><span class="n">color</span> <span class="o">=</span> <span class="s">'#4CAF50'</span>  <span class="c1"># Green background for active
</span>            <span class="n">btn</span><span class="p">.</span><span class="n">hovercolor</span> <span class="o">=</span> <span class="s">'#45a049'</span>
            <span class="n">btn</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">'black'</span><span class="p">)</span>  <span class="c1"># Black text
</span>            <span class="n">btn</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_fontweight</span><span class="p">(</span><span class="s">'bold'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Inactive button - light background with black text
</span>            <span class="n">btn</span><span class="p">.</span><span class="n">color</span> <span class="o">=</span> <span class="s">'#f8f9fa'</span>  <span class="c1"># Light gray background
</span>            <span class="n">btn</span><span class="p">.</span><span class="n">hovercolor</span> <span class="o">=</span> <span class="s">'#e9ecef'</span>
            <span class="n">btn</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">'black'</span><span class="p">)</span>  <span class="c1"># Black text
</span>            <span class="n">btn</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_fontweight</span><span class="p">(</span><span class="s">'normal'</span><span class="p">)</span>
        
        <span class="c1"># Force immediate redraw of the button
</span>        <span class="n">btn</span><span class="p">.</span><span class="n">ax</span><span class="p">.</span><span class="n">figure</span><span class="p">.</span><span class="n">canvas</span><span class="p">.</span><span class="n">draw_idle</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">create_sheet_buttons</span><span class="p">(</span><span class="n">sheet_names</span><span class="p">,</span> <span class="n">fig</span><span class="p">):</span>
    <span class="s">"""Create buttons for sheet selection at the bottom"""</span>
    <span class="k">global</span> <span class="n">sheet_buttons</span><span class="p">,</span> <span class="n">current_sheet</span>
    
    <span class="c1"># Clear existing buttons
</span>    <span class="k">for</span> <span class="n">btn</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sheet_buttons</span><span class="p">:</span>
        <span class="n">btn</span><span class="p">.</span><span class="n">ax</span><span class="p">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="n">sheet_buttons</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sheet_names</span><span class="p">:</span>
        <span class="k">return</span>
    
    <span class="c1"># Calculate button dimensions based on number of sheets
</span>    <span class="n">n_sheets</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sheet_names</span><span class="p">)</span>
    <span class="n">max_buttons_per_row</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">button_height</span> <span class="o">=</span> <span class="mf">0.06</span>
    <span class="n">button_spacing</span> <span class="o">=</span> <span class="mf">0.01</span>
    
    <span class="k">if</span> <span class="n">n_sheets</span> <span class="o">&lt;=</span> <span class="n">max_buttons_per_row</span><span class="p">:</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">buttons_per_row</span> <span class="o">=</span> <span class="n">n_sheets</span>
        <span class="n">button_width</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.8</span> <span class="o">-</span> <span class="p">(</span><span class="n">buttons_per_row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">button_spacing</span><span class="p">)</span> <span class="o">/</span> <span class="n">buttons_per_row</span>
        <span class="n">start_y</span> <span class="o">=</span> <span class="mf">0.15</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_sheets</span> <span class="o">+</span> <span class="n">max_buttons_per_row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">max_buttons_per_row</span>
        <span class="n">buttons_per_row</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">n_sheets</span><span class="p">,</span> <span class="n">max_buttons_per_row</span><span class="p">)</span>
        <span class="n">button_width</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.8</span> <span class="o">-</span> <span class="p">(</span><span class="n">buttons_per_row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">button_spacing</span><span class="p">)</span> <span class="o">/</span> <span class="n">buttons_per_row</span>
        <span class="n">start_y</span> <span class="o">=</span> <span class="mf">0.15</span> <span class="o">-</span> <span class="p">(</span><span class="n">rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">button_height</span> <span class="o">+</span> <span class="mf">0.02</span><span class="p">)</span>
    
    <span class="c1"># Create buttons in a grid
</span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sheet_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sheet_names</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">buttons_per_row</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">buttons_per_row</span>
        
        <span class="n">x_pos</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">+</span> <span class="n">col</span> <span class="o">*</span> <span class="p">(</span><span class="n">button_width</span> <span class="o">+</span> <span class="n">button_spacing</span><span class="p">)</span>
        <span class="n">y_pos</span> <span class="o">=</span> <span class="n">start_y</span> <span class="o">-</span> <span class="n">row</span> <span class="o">*</span> <span class="p">(</span><span class="n">button_height</span> <span class="o">+</span> <span class="mf">0.02</span><span class="p">)</span>
        
        <span class="n">btn_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">axes</span><span class="p">([</span><span class="n">x_pos</span><span class="p">,</span> <span class="n">y_pos</span><span class="p">,</span> <span class="n">button_width</span><span class="p">,</span> <span class="n">button_height</span><span class="p">])</span>
        
        <span class="c1"># Create button with initial inactive style
</span>        <span class="n">btn</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">btn_ax</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'#f8f9fa'</span><span class="p">,</span> <span class="n">hovercolor</span><span class="o">=</span><span class="s">'#e9ecef'</span><span class="p">)</span>
        
        <span class="c1"># Style the button - set text color to black
</span>        <span class="n">btn</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">btn</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_fontweight</span><span class="p">(</span><span class="s">'normal'</span><span class="p">)</span>
        <span class="n">btn</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">'black'</span><span class="p">)</span>  <span class="c1"># Always black text
</span>        
        <span class="c1"># Add border to all buttons
</span>        <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">btn_ax</span><span class="p">.</span><span class="n">spines</span><span class="p">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">spine</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">'#dee2e6'</span><span class="p">)</span>
            <span class="n">spine</span><span class="p">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># Use lambda to capture the current sheet_name
</span>        <span class="n">btn</span><span class="p">.</span><span class="n">on_clicked</span><span class="p">(</span><span class="k">lambda</span> <span class="n">event</span><span class="p">,</span> <span class="n">sn</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">:</span> <span class="n">on_sheet_button_clicked</span><span class="p">(</span><span class="n">sn</span><span class="p">))</span>
        
        <span class="n">sheet_buttons</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">btn</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">))</span>
    
    <span class="c1"># Set initial active button
</span>    <span class="k">if</span> <span class="n">sheet_names</span><span class="p">:</span>
        <span class="n">current_sheet</span> <span class="o">=</span> <span class="n">sheet_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">on_sheet_button_clicked</span><span class="p">(</span><span class="n">current_sheet</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Watcher</span><span class="p">(</span><span class="n">FileSystemEventHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_modified</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">needs_update</span>
        <span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="n">src_path</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">needs_update</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ion</span><span class="p">()</span>
    <span class="c1"># You can use any figure size now - legend will stay inside
</span>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">))</span>  <span class="c1"># Smaller figure size as requested
</span>    
    <span class="c1"># Create main axes for chart - adjusted for top legend
</span>    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">axes</span><span class="p">([</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>  <span class="c1"># Centered with margins
</span>    
    <span class="c1"># Get initial sheet names
</span>    <span class="n">sheet_names</span> <span class="o">=</span> <span class="n">get_sheet_names</span><span class="p">()</span>
    
    <span class="c1"># Create button container background at bottom
</span>    <span class="n">ax_bg</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>  <span class="c1"># Adjusted height
</span>    <span class="n">ax_bg</span><span class="p">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">'#f1f3f4'</span><span class="p">)</span>
    <span class="n">ax_bg</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'top'</span><span class="p">].</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ax_bg</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'top'</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="s">'#dadce0'</span><span class="p">)</span>
    <span class="n">ax_bg</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'right'</span><span class="p">].</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax_bg</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'bottom'</span><span class="p">].</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax_bg</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="s">'left'</span><span class="p">].</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax_bg</span><span class="p">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s">'both'</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> 
                     <span class="n">labelbottom</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    
    <span class="c1"># Add title for button section
</span>    <span class="n">ax_bg</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s">'SHEET SELECTOR'</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_bg</span><span class="p">.</span><span class="n">transAxes</span><span class="p">,</span>
               <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s">'bold'</span><span class="p">,</span>
               <span class="n">color</span><span class="o">=</span><span class="s">'black'</span><span class="p">)</span>
    
    <span class="c1"># Add instruction text
</span>    <span class="n">ax_bg</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.82</span><span class="p">,</span> <span class="s">'Click any sheet to view its data'</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_bg</span><span class="p">.</span><span class="n">transAxes</span><span class="p">,</span>
               <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'#666666'</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">sheet_names</span><span class="p">:</span>
        <span class="n">create_sheet_buttons</span><span class="p">(</span><span class="n">sheet_names</span><span class="p">,</span> <span class="n">fig</span><span class="p">)</span>
    
    <span class="c1"># Style the main figure
</span>    <span class="n">fig</span><span class="p">.</span><span class="n">patch</span><span class="p">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">'white'</span><span class="p">)</span>
    
    <span class="c1"># Draw initial chart
</span>    <span class="k">if</span> <span class="n">sheet_names</span><span class="p">:</span>
        <span class="n">draw_chart</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">current_sheet</span><span class="p">)</span>
    
    <span class="n">event_handler</span> <span class="o">=</span> <span class="n">Watcher</span><span class="p">()</span>
    <span class="n">observer</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">()</span>
    <span class="n">observer</span><span class="p">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">event_handler</span><span class="p">,</span> <span class="s">"."</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">observer</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>
    
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Watching '</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s">'... (Ctrl+C to stop)"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Click sheet buttons at the bottom to view different data"</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">needs_update</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Refreshing chart for sheet: </span><span class="si">{</span><span class="n">current_sheet</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                <span class="n">draw_chart</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">current_sheet</span><span class="p">)</span>
                
                <span class="c1"># Update buttons if sheet list changed
</span>                <span class="n">new_sheet_names</span> <span class="o">=</span> <span class="n">get_sheet_names</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">new_sheet_names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">sheet_names</span><span class="p">):</span>
                    <span class="n">sheet_names</span> <span class="o">=</span> <span class="n">new_sheet_names</span>
                    <span class="n">create_sheet_buttons</span><span class="p">(</span><span class="n">sheet_names</span><span class="p">,</span> <span class="n">fig</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">sheet_names</span> <span class="ow">and</span> <span class="n">current_sheet</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sheet_names</span><span class="p">:</span>
                        <span class="n">current_sheet</span> <span class="o">=</span> <span class="n">sheet_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">on_sheet_button_clicked</span><span class="p">(</span><span class="n">current_sheet</span><span class="p">)</span>
                
                <span class="n">needs_update</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">plt</span><span class="p">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
        <span class="n">observer</span><span class="p">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="n">observer</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="running-the-script">Running the Script</h2>

<ol>
  <li>Ensure your Excel file <code class="language-plaintext highlighter-rouge">garden_data.xlsx</code> exists.</li>
  <li>Save the script as <code class="language-plaintext highlighter-rouge">garden_live_chart.py</code>.</li>
  <li>Run:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python garden_live_chart.py
</code></pre></div></div>
<ol>
  <li>Click sheet buttons to switch sheets.</li>
  <li>Modify the Excel file while the script is running to see live updates.</li>
</ol>

<h2 id="key-learnings">Key Learnings</h2>

<ul>
  <li>Reading Excel sheets dynamically with Pandas.</li>
  <li>Handling multiple numeric columns in grouped bar charts.</li>
  <li>Creating interactive Matplotlib buttons.</li>
  <li>Detecting file changes using Watchdog.</li>
  <li>Combining all components in a live-updating visualization.</li>
</ul>

<h2 id="further-improvements">Further Improvements</h2>

<ul>
  <li>Add support for multiple categorical columns.</li>
  <li>Enhance chart styling (colors, fonts, themes).</li>
  <li>Export charts to images automatically.</li>
  <li>Support larger datasets with scrolling buttons.</li>
  <li>Add filters for numeric ranges or categories.</li>
</ul>

<hr />

<p>This tutorial provides a <strong>complete beginner-friendly guide</strong> to creating <strong>interactive, live-refreshing Excel visualizations</strong> in Python.</p>]]></content><author><name>PyShine Team</name></author><category term="python" /><category term="excel" /><category term="pandas" /><category term="matplotlib" /><category term="watchdog" /><category term="data-visualization" /><category term="automation" /><category term="beginner" /><category term="tutorial" /><summary type="html"><![CDATA[Learn how to create a live-updating Excel chart in Python using Pandas, Matplotlib, and Watchdog. Step-by-step beginner-friendly guide for real-time data visualization.]]></summary></entry><entry><title type="html">Real-Time Excel Chart Updater with Python and Watchdog</title><link href="https://www.pyshine.com/Real-Time-Excel-Chart-Dashboard/" rel="alternate" type="text/html" title="Real-Time Excel Chart Updater with Python and Watchdog" /><published>2025-11-10T00:00:00+00:00</published><updated>2025-11-10T00:00:00+00:00</updated><id>https://www.pyshine.com/Real-Time-Excel-Chart-Dashboard</id><content type="html" xml:base="https://www.pyshine.com/Real-Time-Excel-Chart-Dashboard/"><![CDATA[<h1 id="real-time-excel-chart-updater-with-python-and-watchdog">Real-Time Excel Chart Updater with Python and Watchdog</h1>

<h3 id="automatically-refresh-charts-when-excel-files-change">Automatically Refresh Charts When Excel Files Change</h3>

<p>This tutorial shows you how to build a <strong>real-time Excel chart visualizer</strong> using <strong>Python</strong>, <strong>pandas</strong>, <strong>matplotlib</strong>, and <strong>watchdog</strong>.<br />
The script detects changes in an Excel file and automatically <strong>updates a live chart</strong> without manual refresh — perfect for dashboards, live monitoring, and educational demos.</p>

<hr />

<h2 id="table-of-contents">Table of Contents</h2>
<ul>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#how-it-works">How It Works</a></li>
  <li><a href="#setup-instructions">Setup Instructions</a></li>
  <li><a href="#core-components">Core Components</a>
    <ul>
      <li><a href="#1-drawing-the-chart">1. Drawing the Chart</a></li>
      <li><a href="#2-watching-for-file-changes">2. Watching for File Changes</a></li>
      <li><a href="#3-main-loop">3. Main Loop</a></li>
    </ul>
  </li>
  <li><a href="#complete-code">Complete Code</a></li>
  <li><a href="#how-to-run">How to Run</a></li>
  <li><a href="#key-learnings">Key Learnings</a></li>
  <li><a href="#further-ideas">Further Ideas</a></li>
</ul>

<hr />

<h2 id="overview">Overview</h2>

<p>This project continuously monitors an Excel file named <strong><code class="language-plaintext highlighter-rouge">garden_data.xlsx</code></strong>.<br />
Whenever the file changes, the Python program automatically <strong>reloads it</strong> and <strong>redraws the chart</strong>.</p>

<p>Ideal for:</p>
<ul>
  <li>Real-time data logging dashboards</li>
  <li>Automatically visualizing IoT or sensor data</li>
  <li>Tracking and plotting financial trends in Excel</li>
</ul>

<hr />

<h2 id="how-it-works">How It Works</h2>

<ol>
  <li><strong>Watchdog</strong> detects when the Excel file changes.</li>
  <li><strong>pandas</strong> loads and parses the Excel data.</li>
  <li><strong>matplotlib</strong> renders an interactive live chart.</li>
  <li>The chart updates instantly — no need to rerun the program.</li>
</ol>

<hr />

<h2 id="setup-instructions">Setup Instructions</h2>

<p>First, install the dependencies:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>pandas matplotlib watchdog numpy openpyxl
</code></pre></div></div>

<p>Next, create a file named <strong><code class="language-plaintext highlighter-rouge">garden_data.xlsx</code></strong> in the same folder.<br />
Example sheet content:</p>

<table>
  <thead>
    <tr>
      <th>Plant</th>
      <th>Height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Rose</td>
      <td>30</td>
    </tr>
    <tr>
      <td>Tulip</td>
      <td>25</td>
    </tr>
    <tr>
      <td>Lily</td>
      <td>35</td>
    </tr>
  </tbody>
</table>

<p>Now, you’re ready to run the script!</p>

<hr />

<h2 id="core-components">Core Components</h2>

<h3 id="1-drawing-the-chart">1. Drawing the Chart</h3>

<p>The <code class="language-plaintext highlighter-rouge">draw_chart(ax)</code> function automatically detects numeric columns from your Excel sheet and plots them.<br />
It also handles errors gracefully if the file is missing or contains no numeric data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">draw_chart</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">xls</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Error reading file:</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>
                <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="n">sheet_names</span> <span class="o">=</span> <span class="n">xls</span><span class="p">.</span><span class="n">sheet_names</span>
    <span class="n">numeric_sheets</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="n">sheet_names</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet</span><span class="p">)</span>
        <span class="n">numeric_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">number</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">numeric_df</span><span class="p">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">numeric_sheets</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">sheet</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">numeric_df</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">numeric_sheets</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s">"No numeric data found"</span><span class="p">,</span> 
                <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="c1"># Use the first numeric sheet found
</span>    <span class="n">sheet</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">numeric_df</span> <span class="o">=</span> <span class="n">numeric_sheets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x_candidates</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">select_dtypes</span><span class="p">(</span>
        <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">number</span><span class="p">]).</span><span class="n">columns</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">y_candidates</span> <span class="o">=</span> <span class="n">numeric_df</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">ycol</span> <span class="o">=</span> <span class="n">y_candidates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">xcol</span> <span class="o">=</span> <span class="n">x_candidates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">x_candidates</span> <span class="k">else</span> <span class="n">ycol</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">xcol</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">ycol</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">"steelblue"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">ycol</span><span class="p">])),</span> <span class="n">df</span><span class="p">[</span><span class="n">ycol</span><span class="p">],</span>
               <span class="n">color</span><span class="o">=</span><span class="s">"steelblue"</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">sheet</span><span class="si">}</span><span class="s"> — </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s"> vs </span><span class="si">{</span><span class="n">xcol</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xcol</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ycol</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
</code></pre></div></div>

<hr />

<h3 id="2-watching-for-file-changes">2. Watching for File Changes</h3>

<p>The <code class="language-plaintext highlighter-rouge">Watcher</code> class listens for file modification events using <strong>watchdog</strong>.<br />
Whenever the Excel file changes, a flag is triggered to refresh the chart.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Watcher</span><span class="p">(</span><span class="n">FileSystemEventHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_modified</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">needs_update</span>
        <span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="n">src_path</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">needs_update</span> <span class="o">=</span> <span class="bp">True</span>
</code></pre></div></div>

<hr />

<h3 id="3-main-loop">3. Main Loop</h3>

<p>The main loop runs continuously with <code class="language-plaintext highlighter-rouge">plt.ion()</code> (interactive mode).<br />
It checks for updates and redraws the chart automatically.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ion</span><span class="p">()</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">event_handler</span> <span class="o">=</span> <span class="n">Watcher</span><span class="p">()</span>
    <span class="n">observer</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">()</span>
    <span class="n">observer</span><span class="p">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">event_handler</span><span class="p">,</span> <span class="s">"."</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">observer</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Watching '</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s">'... (Ctrl+C to stop)"</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">needs_update</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Excel refreshing chart..."</span><span class="p">)</span>
                <span class="n">draw_chart</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
                <span class="n">needs_update</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">plt</span><span class="p">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
        <span class="n">observer</span><span class="p">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="n">observer</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>
</code></pre></div></div>

<hr />

<h2 id="complete-code">Complete Code</h2>

<p>Here’s the entire script in one block:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">watchdog.observers</span> <span class="kn">import</span> <span class="n">Observer</span>
<span class="kn">from</span> <span class="nn">watchdog.events</span> <span class="kn">import</span> <span class="n">FileSystemEventHandler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s">"garden_data.xlsx"</span>
<span class="n">needs_update</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">def</span> <span class="nf">draw_chart</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">xls</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">f</span><span class="s">"Error reading file:</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>
                <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="n">sheet_names</span> <span class="o">=</span> <span class="n">xls</span><span class="p">.</span><span class="n">sheet_names</span>
    <span class="n">numeric_sheets</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="n">sheet_names</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet</span><span class="p">)</span>
        <span class="n">numeric_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">number</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">numeric_df</span><span class="p">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">numeric_sheets</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">sheet</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">numeric_df</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">numeric_sheets</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s">"No numeric data found"</span><span class="p">,</span> 
                <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="c1"># Use the first numeric sheet found
</span>    <span class="n">sheet</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">numeric_df</span> <span class="o">=</span> <span class="n">numeric_sheets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x_candidates</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">select_dtypes</span><span class="p">(</span>
        <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">number</span><span class="p">]).</span><span class="n">columns</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">y_candidates</span> <span class="o">=</span> <span class="n">numeric_df</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">ycol</span> <span class="o">=</span> <span class="n">y_candidates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">xcol</span> <span class="o">=</span> <span class="n">x_candidates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">x_candidates</span> <span class="k">else</span> <span class="n">ycol</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">xcol</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">ycol</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">"steelblue"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">ycol</span><span class="p">])),</span> <span class="n">df</span><span class="p">[</span><span class="n">ycol</span><span class="p">],</span>
               <span class="n">color</span><span class="o">=</span><span class="s">"steelblue"</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">sheet</span><span class="si">}</span><span class="s"> — </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s"> vs </span><span class="si">{</span><span class="n">xcol</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xcol</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ycol</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">draw</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">Watcher</span><span class="p">(</span><span class="n">FileSystemEventHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_modified</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">needs_update</span>
        <span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="n">src_path</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">needs_update</span> <span class="o">=</span> <span class="bp">True</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ion</span><span class="p">()</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">event_handler</span> <span class="o">=</span> <span class="n">Watcher</span><span class="p">()</span>
    <span class="n">observer</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">()</span>
    <span class="n">observer</span><span class="p">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">event_handler</span><span class="p">,</span> <span class="s">"."</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">observer</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Watching '</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s">'... (Ctrl+C to stop)"</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">needs_update</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Excel refreshing chart..."</span><span class="p">)</span>
                <span class="n">draw_chart</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
                <span class="n">needs_update</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">plt</span><span class="p">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
        <span class="n">observer</span><span class="p">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="n">observer</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>
</code></pre></div></div>

<hr />

<h2 id="how-to-run">How to Run</h2>

<ol>
  <li>Save the above script as <strong><code class="language-plaintext highlighter-rouge">excel_chart_watcher.py</code></strong></li>
  <li>Place <strong><code class="language-plaintext highlighter-rouge">garden_data.xlsx</code></strong> in the same directory</li>
  <li>Run:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python excel_chart_watcher.py
</code></pre></div></div>

<p>Make any edits to the Excel file — and watch your chart refresh instantly! ⚡</p>

<hr />

<h2 id="key-learnings">Key Learnings</h2>

<ul>
  <li>Real-time file watching with <strong>watchdog</strong></li>
  <li>Automated Excel parsing with <strong>pandas</strong></li>
  <li>Smart detection of numeric vs non-numeric columns</li>
  <li>Live visualization using <strong>matplotlib</strong></li>
</ul>

<hr />

<h2 id="further-ideas">Further Ideas</h2>

<ul>
  <li>Display multiple charts (for each sheet)</li>
  <li>Add filtering or smoothing for better clarity</li>
  <li>Save charts as images automatically</li>
  <li>Integrate with <strong>Tkinter</strong> or <strong>Streamlit</strong> for dashboards</li>
</ul>

<hr />

<p><strong>You’ve built a live Excel chart updater in Python!</strong><br />
Perfect for automation, teaching, and data monitoring projects.</p>]]></content><author><name>PyShine Team</name></author><category term="python" /><category term="excel" /><category term="pandas" /><category term="matplotlib" /><category term="watchdog" /><category term="automation" /><category term="beginner" /><category term="data-visualization" /><category term="tutorial" /><summary type="html"><![CDATA[Step-by-step beginner-friendly guide to create a live-updating Excel chart using Python's pandas, matplotlib, and watchdog libraries.]]></summary></entry><entry><title type="html">Create Excel Files with Python and pandas</title><link href="https://www.pyshine.com/Make-Excel-File-in-Seconds/" rel="alternate" type="text/html" title="Create Excel Files with Python and pandas" /><published>2025-11-09T00:00:00+00:00</published><updated>2025-11-09T00:00:00+00:00</updated><id>https://www.pyshine.com/Make-Excel-File-in-Seconds</id><content type="html" xml:base="https://www.pyshine.com/Make-Excel-File-in-Seconds/"><![CDATA[<h1 id="table-of-contents">Table of Contents</h1>

<ol>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#understanding-the-requirements">Understanding the Requirements</a></li>
  <li><a href="#setting-up-your-environment">Setting Up Your Environment</a></li>
  <li><a href="#breaking-down-the-code">Breaking Down the Code</a>
    <ol>
      <li><a href="#importing-pandas">Importing pandas</a></li>
      <li><a href="#preparing-data">Preparing Data</a></li>
      <li><a href="#writing-to-excel">Writing to Excel</a></li>
    </ol>
  </li>
  <li><a href="#running-the-script">Running the Script</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
</ol>

<hr />

<h2 id="introduction">Introduction</h2>

<p>In this tutorial, we will learn how to create an Excel workbook with multiple sheets using Python’s <strong>pandas</strong> library. This guide is written for absolute beginners and explains every line of the code.</p>

<hr />

<h2 id="understanding-the-requirements">Understanding the Requirements</h2>

<p>Before we start, you need:</p>

<ul>
  <li>Python 3 installed</li>
  <li>pandas library installed (<code class="language-plaintext highlighter-rouge">pip install pandas openpyxl</code>)</li>
  <li>A terminal or IDE to run the Python script</li>
</ul>

<p>We will create an Excel file named <code class="language-plaintext highlighter-rouge">garden_data.xlsx</code> with two sheets:</p>

<ol>
  <li><strong>Trees</strong> – shows the quantity of Mango and Apple trees.</li>
  <li><strong>Fruits</strong> – shows the color of Mango and Apple fruits.</li>
</ol>

<hr />

<h2 id="setting-up-your-environment">Setting Up Your Environment</h2>

<ol>
  <li>Install pandas and openpyxl:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>pandas openpyxl
</code></pre></div></div>

<ol>
  <li>Open your preferred editor and create a new file named <code class="language-plaintext highlighter-rouge">create_excel.py</code>.</li>
</ol>

<hr />

<h2 id="breaking-down-the-code">Breaking Down the Code</h2>

<h3 id="importing-pandas">Importing pandas</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">pandas</code> is a powerful library for data analysis and manipulation in Python.</li>
  <li>We use it here to create DataFrames and export them to Excel.</li>
</ul>

<h3 id="preparing-data">Preparing Data</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">filename</span> <span class="o">=</span> <span class="s">"garden_data.xlsx"</span>

<span class="n">sheets_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"Trees"</span><span class="p">:</span> <span class="p">{</span><span class="s">"Mango"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">"Apple"</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span>
    <span class="s">"Fruits"</span><span class="p">:</span> <span class="p">{</span><span class="s">"Mango"</span><span class="p">:</span> <span class="s">"Yellow"</span><span class="p">,</span> <span class="s">"Apple"</span><span class="p">:</span> <span class="s">"Red"</span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">filename</code> is the name of the Excel file that will be generated.</li>
  <li><code class="language-plaintext highlighter-rouge">sheets_data</code> is a dictionary where:
    <ul>
      <li>Each key is the sheet name.</li>
      <li>Each value is another dictionary containing the data for that sheet.</li>
    </ul>
  </li>
</ul>

<h3 id="writing-to-excel">Writing to Excel</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="n">pd</span><span class="p">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">sheet</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">sheets_data</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">items</span><span class="p">()),</span>
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">"Name"</span><span class="p">,</span> <span class="s">"Value"</span><span class="p">])</span>
          <span class="p">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">pd.ExcelWriter(filename)</code> opens a new Excel file to write multiple sheets.</li>
  <li><code class="language-plaintext highlighter-rouge">for sheet, data in sheets_data.items()</code> loops through each sheet and its data.</li>
  <li><code class="language-plaintext highlighter-rouge">pd.DataFrame(list(data.items()), columns=["Name", "Value"])</code> converts the dictionary into a DataFrame suitable for Excel.</li>
  <li><code class="language-plaintext highlighter-rouge">.to_excel(writer, sheet_name=sheet, index=False)</code> writes the DataFrame to the Excel sheet without adding the index column.</li>
  <li>Using <code class="language-plaintext highlighter-rouge">with</code> ensures that the file is properly saved and closed after writing.</li>
</ul>

<h3 id="confirming-file-generation">Confirming File Generation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s"> Generated!"</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>Prints a message to confirm that the Excel file has been created successfully.</li>
</ul>

<hr />

<h2 id="running-the-script">Running the Script</h2>

<ol>
  <li>Save the file as <code class="language-plaintext highlighter-rouge">create_excel.py</code>.</li>
  <li>Run it in your terminal or IDE:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python create_excel.py
</code></pre></div></div>

<ol>
  <li>Check your project folder for <code class="language-plaintext highlighter-rouge">garden_data.xlsx</code>.</li>
  <li>Open the Excel file to see the two sheets with the correct data.</li>
</ol>

<hr />

<h2 id="conclusion">Conclusion</h2>

<p>You have successfully created an Excel workbook with multiple sheets using Python’s pandas library. This beginner-friendly tutorial demonstrated:</p>

<ul>
  <li>How to structure data for multiple sheets</li>
  <li>How to convert dictionaries to pandas DataFrames</li>
  <li>How to write multiple sheets to a single Excel file</li>
</ul>

<p>Feel free to expand this example by adding more sheets or more complex data. Pandas makes working with Excel files both simple and powerful!</p>]]></content><author><name>PyShine Team</name></author><category term="python" /><category term="excel" /><category term="pandas" /><category term="beginner" /><category term="data-processing" /><category term="tutorial" /><summary type="html"><![CDATA[Step-by-step beginner-friendly tutorial to create Excel workbooks with multiple sheets using Python's pandas library.]]></summary></entry><entry><title type="html">Matrix Rain Animation in Python – Complete Beginner’s Guide</title><link href="https://www.pyshine.com/How-to-rain-text/" rel="alternate" type="text/html" title="Matrix Rain Animation in Python – Complete Beginner’s Guide" /><published>2025-11-08T00:00:00+00:00</published><updated>2025-11-08T00:00:00+00:00</updated><id>https://www.pyshine.com/How-to-rain-text</id><content type="html" xml:base="https://www.pyshine.com/How-to-rain-text/"><![CDATA[<h1 id="table-of-contents">Table of Contents</h1>

<ol>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#understanding-the-requirements">Understanding the Requirements</a></li>
  <li><a href="#setting-up-your-environment">Setting Up Your Environment</a></li>
  <li><a href="#breaking-down-the-code">Breaking Down the Code</a>
    <ol>
      <li><a href="#importing-modules">Importing Modules</a></li>
      <li><a href="#terminal-size">Terminal Size</a></li>
      <li><a href="#characters-and-streams">Characters and Streams</a></li>
      <li><a href="#lime-green-color-function">Lime Green Color Function</a></li>
      <li><a href="#ansi-escape-codes-explained">ANSI Escape Codes Explained</a></li>
      <li><a href="#the-main-animation-loop">The Main Animation Loop</a></li>
      <li><a href="#exiting-the-animation">Exiting the Animation</a></li>
    </ol>
  </li>
  <li><a href="#running-the-script">Running the Script</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
</ol>

<hr />

<h2 id="introduction">Introduction</h2>

<p>Have you ever wanted to recreate the iconic Matrix “digital rain” effect in your terminal using Python? In this tutorial, we’ll build a fully working terminal-based Matrix rain animation. This guide is written for absolute beginners, so no prior experience with terminal animations is required.</p>

<hr />

<h2 id="understanding-the-requirements">Understanding the Requirements</h2>

<p>Before we dive into coding, let’s understand what we need:</p>

<ul>
  <li><strong>Python 3 installed</strong></li>
  <li>A <strong>terminal or command prompt</strong> to run the script</li>
  <li>Familiarity with basic Python concepts (variables, loops, functions)</li>
</ul>

<p>We’ll create an animation that:</p>

<ul>
  <li>Streams random characters in vertical columns</li>
  <li>Changes the intensity of green color to create the falling effect</li>
  <li>Runs continuously until you stop it with a keyboard shortcut</li>
</ul>

<hr />

<h2 id="setting-up-your-environment">Setting Up Your Environment</h2>

<ol>
  <li>Ensure Python 3 is installed on your system by running:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 <span class="nt">--version</span>
</code></pre></div></div>

<ol>
  <li>
    <p>Open your terminal or command prompt.</p>
  </li>
  <li>
    <p>Create a new Python file called <code class="language-plaintext highlighter-rouge">matrix_rain.py</code>.</p>
  </li>
</ol>

<hr />

<h2 id="breaking-down-the-code">Breaking Down the Code</h2>

<h3 id="importing-modules">Importing Modules</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">time</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">randint</code> and <code class="language-plaintext highlighter-rouge">choice</code> from <code class="language-plaintext highlighter-rouge">random</code> allow us to generate random numbers and pick random characters.</li>
  <li><code class="language-plaintext highlighter-rouge">shutil</code> helps get the terminal size.</li>
  <li><code class="language-plaintext highlighter-rouge">time</code> allows us to control the speed of animation.</li>
</ul>

<h3 id="terminal-size">Terminal Size</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">columns</span><span class="p">,</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">shutil</span><span class="p">.</span><span class="n">get_terminal_size</span><span class="p">()</span>
</code></pre></div></div>

<p>This gets the width (<code class="language-plaintext highlighter-rouge">columns</code>) and height (<code class="language-plaintext highlighter-rouge">rows</code>) of your terminal so our animation fills it perfectly.</p>

<h3 id="characters-and-streams">Characters and Streams</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">chars</span> <span class="o">=</span> <span class="s">"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span>
<span class="n">streams</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
    <span class="n">streams</span><span class="p">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s">"pos"</span><span class="p">:</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rows</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
        <span class="s">"length"</span><span class="p">:</span> <span class="n">randint</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">rows</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span>
        <span class="s">"tail"</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">})</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">chars</code> are the characters displayed in the rain.</li>
  <li>Each column (<code class="language-plaintext highlighter-rouge">stream</code>) has:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">pos</code>: the current head position</li>
      <li><code class="language-plaintext highlighter-rouge">length</code>: the length of the falling tail</li>
      <li><code class="language-plaintext highlighter-rouge">tail</code>: a list of characters currently visible in the column</li>
    </ul>
  </li>
</ul>

<h3 id="lime-green-color-function">Lime Green Color Function</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">lime_color</span><span class="p">(</span><span class="n">intensity</span><span class="p">):</span>
    <span class="n">green</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">intensity</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="se">\033</span><span class="s">[38;2;0;</span><span class="si">{</span><span class="n">green</span><span class="si">}</span><span class="s">;0m"</span>
</code></pre></div></div>

<ul>
  <li>This function generates a string that applies an RGB color to terminal text using ANSI escape codes.</li>
  <li><code class="language-plaintext highlighter-rouge">intensity</code> is a value between 0.2 and 1 that determines how bright the green color is.</li>
  <li><code class="language-plaintext highlighter-rouge">green = int(255 * intensity)</code> calculates the green channel value. 255 is the maximum intensity.</li>
</ul>

<h3 id="ansi-escape-codes-explained">ANSI Escape Codes Explained</h3>

<ul>
  <li><strong>ANSI</strong> stands for <strong>American National Standards Institute</strong>. It defines standards for terminal control sequences that allow you to format text, control cursor position, and manipulate colors in a terminal.</li>
  <li>The escape code <code class="language-plaintext highlighter-rouge">\033</code> (or <code class="language-plaintext highlighter-rouge">\x1b</code>) is the standard prefix for ANSI sequences, telling the terminal to interpret the following characters as a command rather than text.</li>
  <li>Example: <code class="language-plaintext highlighter-rouge">\033[38;2;0;255;0m</code>:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">38;2;R;G;B</code> sets the foreground color in true RGB mode.</li>
      <li><code class="language-plaintext highlighter-rouge">0;255;0</code> is green at full intensity.</li>
      <li><code class="language-plaintext highlighter-rouge">\033[0m</code> resets formatting to default.</li>
    </ul>
  </li>
</ul>

<p><strong>History &amp; Importance:</strong></p>
<ul>
  <li>ANSI escape codes originated in the 1970s to provide consistent terminal behavior across different computer systems.</li>
  <li>They remain crucial today because they allow developers to create colorful, dynamic, and interactive terminal applications without relying on GUI frameworks.</li>
  <li>For future development, mastering ANSI codes is essential for CLI tools, terminal games, and custom dashboards.</li>
</ul>

<h3 id="the-main-animation-loop">The Main Animation Loop</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\033</span><span class="s">[?25l"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>  <span class="c1"># Hide cursor
</span><span class="k">try</span><span class="p">:</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">screen_buffer</span> <span class="o">=</span> <span class="p">[[</span><span class="s">" "</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columns</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">stream</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">streams</span><span class="p">):</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s">"pos"</span><span class="p">]</span>
            <span class="n">length</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s">"length"</span><span class="p">]</span>
            <span class="n">char</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span>
            <span class="n">stream</span><span class="p">[</span><span class="s">"tail"</span><span class="p">].</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">char</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s">"tail"</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">length</span><span class="p">:</span>
                <span class="n">stream</span><span class="p">[</span><span class="s">"tail"</span><span class="p">].</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s">"tail"</span><span class="p">]):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">rows</span>
                <span class="n">intensity</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="n">length</span><span class="p">)</span>
                <span class="n">screen_buffer</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">lime_color</span><span class="p">(</span><span class="n">intensity</span><span class="p">)</span><span class="si">}{</span><span class="n">c</span><span class="si">}</span><span class="se">\033</span><span class="s">[0m"</span>
            <span class="n">stream</span><span class="p">[</span><span class="s">"pos"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">rows</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\033</span><span class="s">[H"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>  <span class="c1"># Move cursor to top-left
</span>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">screen_buffer</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>Hides the cursor and animates the Matrix rain using the concepts explained above.</li>
  <li>Uses ANSI sequences for color and cursor movement.</li>
</ul>

<h3 id="exiting-the-animation">Exiting the Animation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\033</span><span class="s">[0m</span><span class="se">\033</span><span class="s">[?25h"</span><span class="p">)</span>  <span class="c1"># reset color and show cursor
</span>    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Matrix rain stopped."</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>Restores default formatting and shows the cursor when you exit with Ctrl+C.</li>
</ul>

<hr />

<h2 id="running-the-script">Running the Script</h2>

<ol>
  <li>Save the file as <code class="language-plaintext highlighter-rouge">matrix_rain.py</code>.</li>
  <li>Open your terminal and navigate to the file location.</li>
  <li>Run the script:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 matrix_rain.py
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Tutorial and Source code at www.pyshine.com
</span><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span>
<span class="kn">import</span> <span class="nn">shutil</span><span class="p">,</span> <span class="n">time</span>
<span class="c1"># Your Terminal window Size
</span><span class="n">columns</span><span class="p">,</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">shutil</span><span class="p">.</span><span class="n">get_terminal_size</span><span class="p">()</span>
<span class="c1"># Characters to display
</span><span class="n">chars</span> <span class="o">=</span> <span class="s">"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span>
<span class="c1"># Initialize streams
</span><span class="n">streams</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
    <span class="n">streams</span><span class="p">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s">"pos"</span><span class="p">:</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rows</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="c1"># head pos
</span>        <span class="s">"length"</span><span class="p">:</span> <span class="n">randint</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">rows</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span> <span class="c1"># tail length
</span>        <span class="s">"tail"</span><span class="p">:</span> <span class="p">[]</span> <span class="c1"># list of tail characters
</span>    <span class="p">})</span>
<span class="c1"># Function to generate the lime Green with Intensity
</span><span class="k">def</span> <span class="nf">lime_color</span><span class="p">(</span><span class="n">intensity</span><span class="p">):</span>
    <span class="n">green</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">255</span><span class="o">*</span><span class="n">intensity</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="se">\033</span><span class="s">[38;2;0;</span><span class="si">{</span><span class="n">green</span><span class="si">}</span><span class="s">;0m"</span>
<span class="c1"># Hide cursor for better effect
</span><span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\033</span><span class="s">[?25l"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="c1"># Create empty screen buffer
</span>        <span class="n">screen_buffer</span> <span class="o">=</span> <span class="p">[[</span><span class="s">" "</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columns</span><span class="p">)]</span>
                         <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">stream</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">streams</span><span class="p">):</span>
            <span class="n">head</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s">"pos"</span><span class="p">]</span>
            <span class="n">length</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s">"length"</span><span class="p">]</span>
            <span class="c1"># Add a new random character at the head
</span>            <span class="n">char</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span>
            <span class="n">stream</span><span class="p">[</span><span class="s">"tail"</span><span class="p">].</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">char</span><span class="p">)</span>
            <span class="c1"># Keep tail at fixed length
</span>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s">"tail"</span><span class="p">])</span><span class="o">&gt;</span> <span class="n">length</span><span class="p">:</span>
                <span class="n">stream</span><span class="p">[</span><span class="s">"tail"</span><span class="p">].</span><span class="n">pop</span><span class="p">()</span>
            <span class="c1"># Draw tail characters in the screen buffer
</span>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s">"tail"</span><span class="p">]):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">rows</span>
                <span class="n">intensity</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span><span class="n">i</span> <span class="o">/</span><span class="n">length</span><span class="p">)</span>
                <span class="n">screen_buffer</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">=</span>\
                <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">lime_color</span><span class="p">(</span><span class="n">intensity</span><span class="p">)</span><span class="si">}{</span><span class="n">c</span><span class="si">}</span><span class="se">\033</span><span class="s">[0m"</span>
            <span class="c1"># Move head down
</span>            <span class="n">stream</span><span class="p">[</span><span class="s">"pos"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">rows</span>
        <span class="c1"># Move cursor to the top-left
</span>        <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\033</span><span class="s">[H"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
        <span class="c1"># Print all rows
</span>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">screen_buffer</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
        <span class="c1"># Small delay for smooth animation
</span>        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\033</span><span class="s">[0m</span><span class="se">\033</span><span class="s">[?25h"</span><span class="p">)</span> <span class="c1"># Reset color show cursor
</span>    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Matrix rain stopped."</span><span class="p">)</span>

</code></pre></div></div>

<ol>
  <li>Watch the Matrix rain animation in action.</li>
  <li>Stop the animation with <code class="language-plaintext highlighter-rouge">Ctrl+C</code>.</li>
</ol>

<hr />

<h2 id="conclusion">Conclusion</h2>

<p>You now have a fully functional Matrix rain animation running in your terminal! This project introduces:</p>

<ul>
  <li>Random number generation</li>
  <li>ANSI escape codes for color and cursor control</li>
  <li>Terminal manipulation with Python</li>
  <li>Animation using loops and buffers</li>
</ul>

<p>Mastering ANSI codes opens the door to advanced terminal applications, interactive CLI tools, and colorful animations. Happy coding!</p>]]></content><author><name>PyShine Team</name></author><category term="python" /><category term="matrix" /><category term="animation" /><category term="terminal" /><category term="ANSI" /><category term="beginner" /><category term="tutorial" /><summary type="html"><![CDATA[Learn how to create a terminal-based Matrix rain animation in Python. Step-by-step beginner-friendly guide to build the iconic green digital rain effect.]]></summary></entry><entry><title type="html">Create Excel Files with Python – Complete Beginner’s Guide</title><link href="https://www.pyshine.com/Make-Excel-File-Quickly-in-Python/" rel="alternate" type="text/html" title="Create Excel Files with Python – Complete Beginner’s Guide" /><published>2025-11-07T00:00:00+00:00</published><updated>2025-11-07T00:00:00+00:00</updated><id>https://www.pyshine.com/Make-Excel-File-Quickly-in-Python</id><content type="html" xml:base="https://www.pyshine.com/Make-Excel-File-Quickly-in-Python/"><![CDATA[<h1 id="create-excel-files-with-python--complete-beginners-guide">Create Excel Files with Python – Complete Beginner’s Guide</h1>

<h2 id="learn-how-to-automate-excel-file-creation-with-pythons-openpyxl-library">Learn How to Automate Excel File Creation with Python’s openpyxl Library</h2>

<p>Excel spreadsheets are everywhere in the business world, but did you know you can create them automatically using Python? This beginner-friendly tutorial will teach you how to generate Excel files with multiple sheets using the <strong>openpyxl</strong> library. You’ll learn everything from installation to creating organized data sheets – perfect for automating reports or organizing data!</p>

<hr />

<h2 id="table-of-contents">Table of Contents</h2>
<ul>
  <li><a href="#what-were-building">What We’re Building</a></li>
  <li><a href="#why-use-python-for-excel">Why Use Python for Excel?</a></li>
  <li><a href="#step-0-installing-openpyxl">Step 0: Installing openpyxl</a></li>
  <li><a href="#step-1-importing-the-library">Step 1: Importing the Library</a></li>
  <li><a href="#step-2-creating-your-first-workbook">Step 2: Creating Your First Workbook</a></li>
  <li><a href="#step-3-understanding-sheets-and-active-sheet">Step 3: Understanding Sheets and Active Sheet</a></li>
  <li><a href="#step-4-naming-your-first-sheet">Step 4: Naming Your First Sheet</a></li>
  <li><a href="#step-5-adding-data-to-cells">Step 5: Adding Data to Cells</a></li>
  <li><a href="#step-6-adding-multiple-rows-with-append">Step 6: Adding Multiple Rows with append()</a></li>
  <li><a href="#step-7-creating-a-second-sheet">Step 7: Creating a Second Sheet</a></li>
  <li><a href="#step-8-organizing-related-data">Step 8: Organizing Related Data</a></li>
  <li><a href="#step-9-saving-your-excel-file">Step 9: Saving Your Excel File</a></li>
  <li><a href="#complete-code">Complete Code</a></li>
  <li><a href="#understanding-the-output">Understanding the Output</a></li>
  <li><a href="#common-mistakes-to-avoid">Common Mistakes to Avoid</a></li>
  <li><a href="#next-steps">Next Steps</a></li>
</ul>

<hr />

<h2 id="what-were-building">What We’re Building</h2>

<p>In this tutorial, we’ll create an Excel file called <strong>“garden_data.xlsx”</strong> that contains two sheets:</p>

<ol>
  <li><strong>“Trees” sheet</strong>: Lists different types of trees and their heights</li>
  <li><strong>“Fruits” sheet</strong>: Shows fruits and their colors</li>
</ol>

<p>This demonstrates how to organize related but separate data in different tabs within the same Excel file.</p>

<hr />

<h2 id="why-use-python-for-excel">Why Use Python for Excel?</h2>

<ul>
  <li><strong>Automate repetitive tasks</strong>: Generate weekly/monthly reports automatically</li>
  <li><strong>Handle large datasets</strong>: Process thousands of rows efficiently</li>
  <li><strong>Integrate with other systems</strong>: Pull data from databases or APIs into Excel</li>
  <li><strong>Reduce errors</strong>: Eliminate manual copy-paste mistakes</li>
  <li><strong>Schedule tasks</strong>: Run Python scripts to update Excel files automatically</li>
</ul>

<hr />

<h2 id="step-0-installing-openpyxl">Step 0: Installing openpyxl</h2>

<p>Before we start coding, we need to install the openpyxl library. Open your command prompt or terminal and type:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>openpyxl
</code></pre></div></div>
<h3 id="what-is-pip">What is pip?</h3>

<p>pip is Python’s package manager that helps install external libraries</p>

<p>It comes automatically with Python (if you installed Python from python.org)</p>

<h3 id="verifying-installation">Verifying Installation:</h3>
<p>After installation, you can verify it worked by opening Python and typing:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import openpyxl
</code></pre></div></div>

<p>If no error appears, you’re ready to go!</p>

<hr />

<h2 id="step-1-importing-the-library">Step 1: Importing the Library</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from openpyxl import Workbook
</code></pre></div></div>

<p>Let’s break this down:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">from openpyxl</code>: We’re taking something from the openpyxl library</li>
  <li><code class="language-plaintext highlighter-rouge">import Workbook</code>: We’re specifically importing the Workbook class</li>
</ul>

<h3 id="whats-a-workbook">What’s a Workbook?</h3>

<ul>
  <li>In Excel terms, a Workbook is the entire Excel file (the .xlsx file)</li>
  <li>It can contain multiple Sheets (the tabs you see at the bottom)</li>
  <li>The Workbook class is like a blueprint for creating Excel files</li>
</ul>

<hr />

<h2 id="step-2-creating-your-first-workbook">Step 2: Creating Your First Workbook</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Create a new Excel workbook
</span><span class="n">workbook</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">"garden_data.xlsx"</span>
</code></pre></div></div>

<h3 id="understanding-this-code">Understanding this code:</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">workbook = Workbook()</code>: Creates a new, empty Excel workbook in memory</li>
  <li>Think of this as opening Excel and creating a “New Blank Workbook”</li>
  <li><code class="language-plaintext highlighter-rouge">filename = "garden_data.xlsx"</code>: Sets the name for our output file</li>
</ul>

<h3 id="important-notes">Important Notes:</h3>

<ul>
  <li>The workbook exists only in computer memory until we save it</li>
  <li>We can name our file anything, but .xlsx is the standard Excel extension</li>
</ul>

<hr />

<h2 id="step-3-understanding-sheets-and-active-sheet">Step 3: Understanding Sheets and Active Sheet</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## The default workbook starts with one sheet
sheet1 = workbook.active
</code></pre></div></div>

<h3 id="what-is-a-sheet">What is a Sheet?</h3>

<ul>
  <li>Sheets are the individual tabs in an Excel file</li>
  <li>By default, every new Excel workbook starts with one sheet (usually named “Sheet1”)</li>
</ul>

<h3 id="what-does-active-mean">What does <code class="language-plaintext highlighter-rouge">.active</code> mean?</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">workbook.active</code> gets the currently active (selected) sheet</li>
  <li>Since we just created the workbook, there’s only one sheet, so it’s automatically active</li>
</ul>

<hr />

<h2 id="step-4-naming-your-first-sheet">Step 4: Naming Your First Sheet</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sheet1</span><span class="p">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">"Trees"</span>
</code></pre></div></div>

<h3 id="why-rename-sheets">Why rename sheets?</h3>

<ul>
  <li>Default names like “Sheet1” aren’t descriptive</li>
  <li>Good sheet names help people understand what data they contain</li>
  <li>In our case, “Trees” clearly indicates this sheet contains tree data</li>
</ul>

<h3 id="sheet-name-rules">Sheet Name Rules:</h3>

<ul>
  <li>Maximum 31 characters</li>
  <li>Cannot contain: <code class="language-plaintext highlighter-rouge">: \ / ? * [ ]</code></li>
  <li>Cannot be blank</li>
</ul>

<hr />

<h2 id="step-5-adding-data-to-cells">Step 5: Adding Data to Cells</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Add data to the Trees sheet
</span><span class="n">sheet1</span><span class="p">[</span><span class="s">"A1"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Tree Name"</span>   <span class="c1"># First Column
</span><span class="n">sheet1</span><span class="p">[</span><span class="s">"B1"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Height (m)"</span>  <span class="c1"># Second Column
</span></code></pre></div></div>

<h3 id="understanding-excel-cell-references">Understanding Excel Cell References:</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">A1</code> means Column A, Row 1</li>
  <li><code class="language-plaintext highlighter-rouge">B1</code> means Column B, Row 1</li>
  <li>This is the same coordinate system you use in Excel</li>
</ul>

<h3 id="what-were-creating">What we’re creating:</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>| A        | B          |
|----------|------------|
| Tree Name| Height (m) |
</code></pre></div></div>

<h3 id="why-add-headers">Why add headers?</h3>

<ul>
  <li>Headers describe what each column contains</li>
  <li>Makes your data understandable to others</li>
  <li>Follows good data organization practices</li>
</ul>

<hr />

<h2 id="step-6-adding-multiple-rows-with-append">Step 6: Adding Multiple Rows with append()</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sheet1</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="s">"Mango"</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>   <span class="c1"># First Row
</span><span class="n">sheet1</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="s">"Apple"</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>    <span class="c1"># Second Row
</span><span class="n">sheet1</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="s">"Banana"</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>   <span class="c1"># Third Row
</span></code></pre></div></div>

<h3 id="how-append-works">How append() works:</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">append()</code> adds a new row at the bottom of your data</li>
  <li>Each item in the list becomes a cell in that row</li>
  <li><code class="language-plaintext highlighter-rouge">["Mango", 10]</code> becomes: Cell A2 = “Mango”, Cell B2 = 10</li>
</ul>

<h3 id="visualizing-the-data">Visualizing the data:</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>| A         | B          |
|-----------|------------|
| Tree Name | Height (m) |
| Mango     | 10         |
| Apple     | 6          |
| Banana    | 5          |
</code></pre></div></div>

<h3 id="why-use-append-instead-of-cell-references">Why use append() instead of cell references?</h3>

<ul>
  <li>Faster for adding multiple rows</li>
  <li>Less error-prone than manually tracking row numbers</li>
  <li>More readable code</li>
</ul>

<hr />

<h2 id="step-7-creating-a-second-sheet">Step 7: Creating a Second Sheet</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Create another sheet for Fruits
</span><span class="n">sheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="p">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Fruits"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="multiple-sheets-organization">Multiple Sheets Organization:</h3>

<ul>
  <li>
    <p>Different types of data belong in different sheets</p>
  </li>
  <li>
    <p>“Trees” sheet: Information about trees</p>
  </li>
  <li>
    <p>“Fruits” sheet: Information about fruits</p>
  </li>
  <li>
    <p>This keeps related data together and separate from unrelated data</p>
  </li>
</ul>

<h3 id="what-happens-behind-the-scenes">What happens behind the scenes:</h3>

<ul>
  <li>Python creates a new sheet tab in the workbook</li>
  <li>The new sheet becomes the active sheet temporarily</li>
  <li>We now have two sheets: “Trees” and “Fruits”</li>
</ul>

<hr />

<h2 id="step-8-organizing-related-data">Step 8: Organizing Related Data</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sheet2</span><span class="p">[</span><span class="s">"A1"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Fruit Name"</span>
<span class="n">sheet2</span><span class="p">[</span><span class="s">"B1"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Color"</span>
<span class="n">sheet2</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="s">"Mango"</span><span class="p">,</span> <span class="s">"Yellow"</span><span class="p">])</span>
<span class="n">sheet2</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="s">"Apple"</span><span class="p">,</span> <span class="s">"Red"</span><span class="p">])</span>
<span class="n">sheet2</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="s">"Banana"</span><span class="p">,</span> <span class="s">"Yellow"</span><span class="p">])</span>
</code></pre></div></div>

<h3 id="creating-consistent-structure">Creating Consistent Structure:</h3>

<ul>
  <li>Both sheets have similar layouts (headers in row 1, data below)</li>
  <li>This makes the Excel file easy to navigate and understand</li>
  <li>Notice how “Mango” appears in both sheets but with different information</li>
</ul>

<h2 id="the-fruits-sheet-looks-like">The Fruits sheet looks like:</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>| A         | B      |
|-----------|--------|
| Fruit Name| Color  |
| Mango     | Yellow |
| Apple     | Red    |
| Banana    | Yellow |
</code></pre></div></div>

<hr />

<h2 id="step-9-saving-your-excel-file">Step 9: Saving Your Excel File</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Save the workbook
</span><span class="n">workbook</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s"> created, Trees and Fruits!"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="why-do-we-need-to-save">Why do we need to save?</h2>

<ul>
  <li>Until now, everything existed only in computer memory</li>
  <li><code class="language-plaintext highlighter-rouge">workbook.save()</code> writes the data to an actual file on your computer</li>
  <li>Without saving, your work would be lost when the program ends</li>
</ul>

<h2 id="file-location">File Location:</h2>

<ul>
  <li>The file saves in the same folder where your Python script is running</li>
  <li>You can specify a path: <code class="language-plaintext highlighter-rouge">workbook.save("C:/Users/Name/Documents/garden_data.xlsx")</code></li>
</ul>

<h3 id="the-print-statement">The print() statement:</h3>

<ul>
  <li>Provides confirmation that the script ran successfully</li>
  <li><code class="language-plaintext highlighter-rouge">f"{filename}"</code> inserts the filename into the message</li>
  <li>Output: <code class="language-plaintext highlighter-rouge">garden_data.xlsx created, Trees and Fruits!</code></li>
</ul>

<hr />

<h2 id="complete-code">Complete Code</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## simple_excel_two_sheets.py
</span><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>

<span class="c1">## Create a new Excel workbook
</span><span class="n">workbook</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">"garden_data.xlsx"</span>
<span class="c1">## The default workbook starts with one sheet
</span><span class="n">sheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="p">.</span><span class="n">active</span>
<span class="n">sheet1</span><span class="p">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">"Trees"</span>

<span class="c1">## Add data to the Trees sheet
</span><span class="n">sheet1</span><span class="p">[</span><span class="s">"A1"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Tree Name"</span>   <span class="c1"># First Column
</span><span class="n">sheet1</span><span class="p">[</span><span class="s">"B1"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Height (m)"</span>  <span class="c1"># Second Column
</span><span class="n">sheet1</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="s">"Mango"</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span> <span class="c1"># First Row
</span><span class="n">sheet1</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="s">"Apple"</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>  <span class="c1"># Second Row
</span><span class="n">sheet1</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="s">"Banana"</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span> <span class="c1"># Third Row
</span>
<span class="c1">## Create another sheet for Fruits
</span><span class="n">sheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="p">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Fruits"</span><span class="p">)</span>
<span class="n">sheet2</span><span class="p">[</span><span class="s">"A1"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Fruit Name"</span>
<span class="n">sheet2</span><span class="p">[</span><span class="s">"B1"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Color"</span>
<span class="n">sheet2</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="s">"Mango"</span><span class="p">,</span> <span class="s">"Yellow"</span><span class="p">])</span>
<span class="n">sheet2</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="s">"Apple"</span><span class="p">,</span> <span class="s">"Red"</span><span class="p">])</span>
<span class="n">sheet2</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="s">"Banana"</span><span class="p">,</span> <span class="s">"Yellow"</span><span class="p">])</span>

<span class="c1">## Save the workbook
</span><span class="n">workbook</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s"> created, Trees and Fruits!"</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h2 id="understanding-the-output">Understanding the Output</h2>

<p>After running the code, you’ll find “garden_data.xlsx” in your project folder. When you open it:</p>

<h3 id="sheet-1---trees">Sheet 1 - “Trees”:</h3>

<ul>
  <li>Shows three types of trees with their heights</li>
  <li>Organized with clear headers</li>
  <li>Ready for further analysis or reporting</li>
</ul>

<h3 id="sheet-2---fruits">Sheet 2 - “Fruits”:</h3>

<ul>
  <li>Shows the same plants but focused on fruit characteristics</li>
  <li>Demonstrates how different aspects of related data can be separated</li>
</ul>

<h3 id="file-properties">File Properties:</h3>

<ul>
  <li>Format: Standard Excel (.xlsx) format</li>
  <li>Compatibility: Can be opened in Excel, Google Sheets, LibreOffice</li>
  <li>Structure: Professional-looking with proper headers and organization</li>
</ul>

<hr />

<h2 id="common-mistakes-to-avoid">Common Mistakes to Avoid</h2>

<ol>
  <li>Forgetting to save: Your work won’t be preserved without workbook.save()</li>
  <li>Incorrect cell references:
    <ul>
      <li>Wrong: <code class="language-plaintext highlighter-rouge">sheet1["1A"]</code> (number first)</li>
      <li>Right: <code class="language-plaintext highlighter-rouge">sheet1["A1"]</code> (letter first)</li>
    </ul>
  </li>
  <li>Missing installation: Forgetting to run <code class="language-plaintext highlighter-rouge">pip install openpyxl</code> first</li>
  <li>File permission issues: Trying to save to protected folders</li>
  <li>Overwriting files: Saving with same filename overwrites existing files</li>
</ol>

<hr />

<h2 id="next-steps">Next Steps</h2>

<p>Now that you can create basic Excel files, try these enhancements:</p>

<h3 id="add-more-data">Add More Data:</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Add more tree data
</span><span class="n">sheet1</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="s">"Oak"</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>
<span class="n">sheet1</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="s">"Pine"</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>

</code></pre></div></div>

<h3 id="format-cells">Format Cells:</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">Font</span>

<span class="c1">## Make headers bold
</span><span class="n">sheet1</span><span class="p">[</span><span class="s">"A1"</span><span class="p">].</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sheet1</span><span class="p">[</span><span class="s">"B1"</span><span class="p">].</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="add-formulas">Add Formulas:</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Calculate average height
</span><span class="n">sheet1</span><span class="p">[</span><span class="s">"A5"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Average Height:"</span>
<span class="n">sheet1</span><span class="p">[</span><span class="s">"B5"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"=AVERAGE(B2:B4)"</span>
</code></pre></div></div>

<h3 id="read-existing-files">Read Existing Files:</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">load_workbook</span>

<span class="c1">## Open the file we just created
</span><span class="n">workbook</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s">"garden_data.xlsx"</span><span class="p">)</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="p">.</span><span class="n">active</span>
<span class="k">print</span><span class="p">(</span><span class="n">sheet</span><span class="p">[</span><span class="s">"A2"</span><span class="p">].</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># Prints "Mango"
</span></code></pre></div></div>

<hr />

<p>Congratulations! You’ve just automated Excel file creation using Python. This fundamental skill opens doors to automated reporting, data processing, and much more. The simple garden data example demonstrates principles you can apply to business reports, scientific data, or any structured information that needs organizing.</p>

<p><em>Try modifying the code to create your own custom Excel files – the possibilities are endless!</em></p>]]></content><author><name>PyShine Team</name></author><category term="python" /><category term="excel" /><category term="openpyxl" /><category term="beginner" /><category term="data-processing" /><category term="tutorial" /><summary type="html"><![CDATA[Learn how to create Excel workbooks with multiple sheets using Python's openpyxl library. Step-by-step tutorial for absolute beginners.]]></summary></entry><entry><title type="html">Animated Flower Tree with Python Turtle – Growing &amp;amp;…</title><link href="https://www.pyshine.com/Tree-grow-and-falling-flowers/" rel="alternate" type="text/html" title="Animated Flower Tree with Python Turtle – Growing &amp;amp;…" /><published>2025-11-06T00:00:00+00:00</published><updated>2025-11-06T00:00:00+00:00</updated><id>https://www.pyshine.com/Tree-grow-and-falling-flowers</id><content type="html" xml:base="https://www.pyshine.com/Tree-grow-and-falling-flowers/"><![CDATA[<h1 id="animated-flower-tree-with-python-turtle--growing--falling-flowers">Animated Flower Tree with Python Turtle – Growing &amp; Falling Flowers</h1>

<h2 id="create-stunning-animated-nature-scenes-with-pythons-built-in-turtle-module">Create Stunning Animated Nature Scenes with Python’s Built-in Turtle Module</h2>

<p>Python’s Turtle graphics module isn’t just for simple shapes – it can create beautiful, complex animations with physics simulations! This tutorial shows you how to build an <strong>animated flowering tree</strong> where blossoms gradually grow on branches and then gently fall with realistic physics. You’ll learn recursive tree generation, color blending, growth animation, and basic physics simulation – all with pure Python.</p>

<hr />

<h2 id="table-of-contents">Table of Contents</h2>
<ul>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#what-youll-learn">What You’ll Learn</a></li>
  <li><a href="#step-1-setting-up-the-environment">Step 1: Setting Up the Environment</a></li>
  <li><a href="#step-2-generating-the-tree-structure">Step 2: Generating the Tree Structure</a></li>
  <li><a href="#step-3-color-blending-for-natural-look">Step 3: Color Blending for Natural Look</a></li>
  <li><a href="#step-4-drawing-flowers-with-growth-animation">Step 4: Drawing Flowers with Growth Animation</a></li>
  <li><a href="#step-5-physics-for-falling-flowers">Step 5: Physics for Falling Flowers</a></li>
  <li><a href="#complete-code">Complete Code</a></li>
  <li><a href="#how-it-works">How It Works</a></li>
  <li><a href="#customization-ideas">Customization Ideas</a></li>
  <li><a href="#key-learnings">Key Learnings</a></li>
</ul>

<hr />

<h2 id="overview">Overview</h2>

<p>This project creates a <strong>procedurally generated tree</strong> with these animated features:</p>

<ol>
  <li><strong>Recursive tree generation</strong> with random branching angles</li>
  <li><strong>Color blending</strong> from brown trunk to green branches</li>
  <li><strong>Gradual flower growth</strong> animation</li>
  <li><strong>Realistic flower falling</strong> with gravity and wind physics</li>
  <li><strong>Natural swaying motion</strong> for attached flowers</li>
</ol>

<hr />

<h2 id="what-youll-learn">What You’ll Learn</h2>

<ul>
  <li><strong>Recursive algorithms</strong> for tree generation</li>
  <li><strong>Turtle graphics</strong> advanced techniques</li>
  <li><strong>Color theory</strong> and RGB blending</li>
  <li><strong>Animation principles</strong> with growth stages</li>
  <li><strong>Basic physics simulation</strong> (gravity, wind, rotation)</li>
  <li><strong>Object-oriented thinking</strong> with flower data structures</li>
</ul>

<hr />

<h2 id="step-1-setting-up-the-environment">Step 1: Setting Up the Environment</h2>

<p>We start by importing necessary modules and setting up configuration constants.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">turtle</span> 
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">seed</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1">## Settings 
</span><span class="n">W</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="mi">420</span><span class="p">,</span> <span class="mi">420</span>          <span class="c1"># Window dimensions
</span><span class="n">DEPTH</span> <span class="o">=</span> <span class="mi">7</span>                <span class="c1"># Recursion depth for tree
</span><span class="n">LENGTH</span> <span class="o">=</span> <span class="mi">80</span>              <span class="c1"># Initial branch length
</span><span class="n">BA</span> <span class="o">=</span> <span class="mi">25</span>                  <span class="c1"># Base branching angle
</span><span class="n">GRAVITY</span> <span class="o">=</span> <span class="mf">1.5</span>            <span class="c1"># Physics constants
</span><span class="n">WIND</span> <span class="o">=</span> <span class="mf">2.0</span>               <span class="c1"># Wind strength
</span><span class="n">FPS</span> <span class="o">=</span> <span class="mf">0.02</span>               <span class="c1"># Animation frame delay
</span><span class="n">seed</span><span class="p">(</span><span class="mi">192</span><span class="p">)</span>                <span class="c1"># Seed for reproducible randomness
</span>
<span class="n">branch_params</span> <span class="o">=</span> <span class="p">[]</span>

</code></pre></div></div>

<p>Key Settings Explained:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">DEPTH</code> Controls how detailed the tree is (higher = more branches)</li>
  <li><code class="language-plaintext highlighter-rouge">LENGTH</code> Starting branch length in pixels</li>
  <li><code class="language-plaintext highlighter-rouge">GRAVITY/WIND</code> Physics parameters for falling animation</li>
  <li><code class="language-plaintext highlighter-rouge">seed(192)</code> Ensures the same tree generates every time</li>
</ul>

<hr />

<h2 id="step-2-generating-the-tree-structure">Step 2: Generating the Tree Structure</h2>

<p>We use recursion to generate tree parameters before drawing.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">record_my_params</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="s">"""Recursively generate tree branch parameters"""</span>
    <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>
    
    <span class="c1">## Randomize angles and lengths for natural look
</span>    <span class="n">a1</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">BA</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">BA</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">BA</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">BA</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">l1</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>  <span class="c1"># Child branches are shorter
</span>    <span class="n">l2</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    
    <span class="n">branch_params</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">level</span><span class="p">))</span>
    
    <span class="c1">## Recursive calls for sub-branches
</span>    <span class="n">record_my_params</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">record_my_params</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">record_my_params</span><span class="p">(</span><span class="n">LENGTH</span><span class="p">,</span> <span class="n">DEPTH</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">param_gen</span><span class="p">():</span>
    <span class="s">"""Generator for branch parameters"""</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">branch_params</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">p</span>

</code></pre></div></div>

<p>How Recursion Works:</p>

<ul>
  <li>Each branch splits into two sub-branches</li>
  <li>Sub-branches have randomized angles and lengths</li>
  <li>Process continues until depth reaches 0</li>
  <li>Parameters are stored for consistent drawing</li>
</ul>

<hr />

<h2 id="step-3-color-blending-for-natural-look">Step 3: Color Blending for Natural Look</h2>

<p>We blend colors from brown (trunk) to green (branches) based on branch level.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">blend</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="s">"""Linear color interpolation between two RGB colors"""</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
        <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
        <span class="n">c1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
    <span class="p">)</span>

<span class="c1">## Usage in drawing:
</span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">DEPTH</span> <span class="o">-</span> <span class="n">depth</span><span class="p">)</span> <span class="o">/</span> <span class="n">DEPTH</span>  <span class="c1"># Normalized position (0=trunk, 1=tip)
</span><span class="n">brown</span> <span class="o">=</span> <span class="p">(</span><span class="mi">139</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">69</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">19</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>
<span class="n">green</span> <span class="o">=</span> <span class="p">(</span><span class="mi">34</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">139</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">34</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>
<span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">blend</span><span class="p">(</span><span class="n">brown</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="color-theory">Color Theory:</h3>

<ul>
  <li>Brown trunk: (139/255, 69/255, 19/255) - earthy, strong</li>
  <li>Green tips: (34/255, 139/255, 34/255) - vibrant, leafy</li>
  <li>Linear interpolation: Creates smooth color transitions</li>
</ul>

<hr />

<h2 id="step-4-drawing-flowers-with-growth-animation">Step 4: Drawing Flowers with Growth Animation</h2>

<p>Flowers are drawn as pentagram shapes with gradual growth animation.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">draw_flower_at_position</span><span class="p">(</span><span class="n">pen</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">growth_factor</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="s">"""Draw a flower at specific position with growth animation"""</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">goto</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">setheading</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">pendown</span><span class="p">()</span>
    
    <span class="c1">## Apply growth factor to size
</span>    <span class="n">current_size</span> <span class="o">=</span> <span class="n">size</span> <span class="o">*</span> <span class="n">growth_factor</span>
    <span class="k">if</span> <span class="n">current_size</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>  <span class="c1"># Don't draw if too small
</span>        <span class="k">return</span>
        
    <span class="n">pen</span><span class="p">.</span><span class="n">fillcolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">pencolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">begin_fill</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">circle</span><span class="p">(</span><span class="n">current_size</span><span class="p">,</span> <span class="mi">72</span><span class="p">)</span>  <span class="c1"># Draw petal
</span>        <span class="n">pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="mi">144</span><span class="p">)</span>                 <span class="c1"># Turn for next petal
</span>    <span class="n">pen</span><span class="p">.</span><span class="n">end_fill</span><span class="p">()</span>
    
    <span class="c1">## Draw flower center
</span>    <span class="n">pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">goto</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">current_size</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">animate_flower_growth</span><span class="p">(</span><span class="n">screen</span><span class="p">,</span> <span class="n">tree_pen</span><span class="p">,</span> <span class="n">flower_positions</span><span class="p">):</span>
    <span class="s">"""Animate flowers growing on the tree"""</span>
    <span class="n">flower_pen</span> <span class="o">=</span> <span class="n">turtle</span><span class="p">.</span><span class="n">Turtle</span><span class="p">()</span>
    <span class="n">flower_pen</span><span class="p">.</span><span class="n">hideturtle</span><span class="p">()</span>
    <span class="n">flower_pen</span><span class="p">.</span><span class="n">speed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">flower_pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
    
    <span class="n">growth_stages</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Number of growth stages
</span>    
    <span class="k">for</span> <span class="n">stage</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">growth_stages</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">flower_pen</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">growth_factor</span> <span class="o">=</span> <span class="n">stage</span> <span class="o">/</span> <span class="n">growth_stages</span>  <span class="c1"># 0 to 1
</span>        
        <span class="k">for</span> <span class="n">flower</span> <span class="ow">in</span> <span class="n">flower_positions</span><span class="p">:</span>
            <span class="n">draw_flower_at_position</span><span class="p">(</span>
                <span class="n">flower_pen</span><span class="p">,</span> 
                <span class="n">flower</span><span class="p">[</span><span class="s">'x'</span><span class="p">],</span> 
                <span class="n">flower</span><span class="p">[</span><span class="s">'y'</span><span class="p">],</span> 
                <span class="n">flower</span><span class="p">[</span><span class="s">'color'</span><span class="p">],</span> 
                <span class="n">flower</span><span class="p">[</span><span class="s">'size'</span><span class="p">],</span> 
                <span class="n">growth_factor</span><span class="o">=</span><span class="n">growth_factor</span>
            <span class="p">)</span>
        
        <span class="n">screen</span><span class="p">.</span><span class="n">update</span><span class="p">()</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="growth-animation-features">Growth Animation Features:</h3>

<ul>
  <li>20 growth stages for smooth appearance</li>
  <li>Size scaling from 0% to 100%</li>
  <li>Separate turtle for flowers vs tree</li>
  <li>Controlled frame rate for smooth animation</li>
</ul>

<hr />

<h3 id="step-5-physics-for-falling-flowers">Step 5: Physics for Falling Flowers</h3>

<p>Realistic falling animation with gravity, wind, and rotation physics.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">make_flowers_fall</span><span class="p">(</span><span class="n">screen</span><span class="p">,</span> <span class="n">tree_pen</span><span class="p">,</span> <span class="n">flower_pen</span><span class="p">,</span> <span class="n">flower_positions</span><span class="p">):</span>
    <span class="s">"""Animate flowers falling with physics simulation"""</span>
    
    <span class="n">velocities</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Store velocity for each flower
</span>    <span class="n">rotations</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1"># Store rotation for each flower
</span>    
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">flower_pen</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
        
        <span class="c1">## Randomly detach flowers over time
</span>        <span class="k">for</span> <span class="n">flower</span> <span class="ow">in</span> <span class="n">flower_positions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">flower</span><span class="p">[</span><span class="s">'attached'</span><span class="p">]</span> <span class="ow">and</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.03</span><span class="p">:</span>
                <span class="n">flower</span><span class="p">[</span><span class="s">'attached'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="n">flower_id</span> <span class="o">=</span> <span class="n">flower</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span>
                
                <span class="c1">## Initialize physics properties
</span>                <span class="n">velocities</span><span class="p">[</span><span class="n">flower_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="n">WIND</span><span class="p">,</span> <span class="n">WIND</span><span class="p">),</span>  <span class="c1"># Horizontal velocity (wind)
</span>                    <span class="o">-</span><span class="n">GRAVITY</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>  <span class="c1"># Vertical velocity
</span>                <span class="p">]</span>
                <span class="n">rotations</span><span class="p">[</span><span class="n">flower_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>  <span class="c1"># Initial rotation
</span>        
        <span class="c1">## Update falling flowers
</span>        <span class="k">for</span> <span class="n">flower</span> <span class="ow">in</span> <span class="n">flower_positions</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">flower</span><span class="p">[</span><span class="s">'attached'</span><span class="p">]:</span>
                <span class="n">flower_id</span> <span class="o">=</span> <span class="n">flower</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span>
                <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">velocities</span><span class="p">[</span><span class="n">flower_id</span><span class="p">]</span>
                
                <span class="c1">## Apply physics
</span>                <span class="n">flower</span><span class="p">[</span><span class="s">'x'</span><span class="p">]</span> <span class="o">+=</span> <span class="n">vx</span>
                <span class="n">flower</span><span class="p">[</span><span class="s">'y'</span><span class="p">]</span> <span class="o">+=</span> <span class="n">vy</span>
                <span class="n">vy</span> <span class="o">-=</span> <span class="n">GRAVITY</span> <span class="o">*</span> <span class="mf">0.08</span>  <span class="c1"># Gravity acceleration
</span>                
                <span class="c1">## Air resistance and random movement
</span>                <span class="n">vx</span> <span class="o">*=</span> <span class="mf">0.998</span>
                <span class="n">vy</span> <span class="o">*=</span> <span class="mf">0.998</span>
                <span class="n">vx</span> <span class="o">+=</span> <span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">)</span>
                
                <span class="c1">## Update rotation based on horizontal movement
</span>                <span class="n">rotations</span><span class="p">[</span><span class="n">flower_id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">vx</span> <span class="o">*</span> <span class="mi">3</span>
                
                <span class="c1">## Ground collision
</span>                <span class="k">if</span> <span class="n">flower</span><span class="p">[</span><span class="s">'y'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">H</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">20</span><span class="p">:</span>
                    <span class="n">flower</span><span class="p">[</span><span class="s">'y'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">H</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">20</span>  <span class="c1"># Stop at ground
</span>                    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">vy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.3</span><span class="p">:</span>
                        <span class="n">vy</span> <span class="o">=</span> <span class="o">-</span><span class="n">vy</span> <span class="o">*</span> <span class="mf">0.2</span>  <span class="c1"># Bounce
</span>                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">vy</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Stop moving
</span>                
                <span class="n">velocities</span><span class="p">[</span><span class="n">flower_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">]</span>
                
                <span class="c1">## Draw with current rotation
</span>                <span class="n">draw_flower_at_position</span><span class="p">(</span>
                    <span class="n">flower_pen</span><span class="p">,</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'x'</span><span class="p">],</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'y'</span><span class="p">],</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'color'</span><span class="p">],</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'size'</span><span class="p">],</span> 
                    <span class="n">rotations</span><span class="p">[</span><span class="n">flower_id</span><span class="p">]</span>
                <span class="p">)</span>
        
        <span class="n">screen</span><span class="p">.</span><span class="n">update</span><span class="p">()</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="physics-simulation-elements">Physics Simulation Elements:</h3>

<ul>
  <li>Gravity: Constant downward acceleration</li>
  <li>Wind: Random horizontal movement</li>
  <li>Rotation: Flowers spin as they fall</li>
  <li>Air resistance: Velocity gradually decreases</li>
  <li>Ground collision: Realistic bouncing and stopping</li>
  <li>Random variations: Natural, non-uniform movement</li>
</ul>

<hr />

<h2 id="complete-code">Complete Code</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## source code at www.pyshine.com
</span><span class="kn">import</span> <span class="nn">turtle</span> 
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">seed</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1">## Settings 
</span><span class="n">W</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="mi">420</span><span class="p">,</span> <span class="mi">420</span>
<span class="n">DEPTH</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">LENGTH</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">BA</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">GRAVITY</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">WIND</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">FPS</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">192</span><span class="p">)</span>

<span class="n">branch_params</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">record_my_params</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">BA</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">BA</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">BA</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">BA</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">l1</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">l2</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">branch_params</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">level</span><span class="p">))</span>
    <span class="n">record_my_params</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">record_my_params</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">record_my_params</span><span class="p">(</span><span class="n">LENGTH</span><span class="p">,</span> <span class="n">DEPTH</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">param_gen</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">branch_params</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">p</span>

<span class="k">def</span> <span class="nf">blend</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
        <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
        <span class="n">c1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">draw_flower_at_position</span><span class="p">(</span><span class="n">pen</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">growth_factor</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="s">"""Draw a flower at a specific position with growth animation"""</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">goto</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">setheading</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">pendown</span><span class="p">()</span>
    
    <span class="c1">## Apply growth factor to size
</span>    <span class="n">current_size</span> <span class="o">=</span> <span class="n">size</span> <span class="o">*</span> <span class="n">growth_factor</span>
    <span class="k">if</span> <span class="n">current_size</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>  <span class="c1"># Don't draw if too small
</span>        <span class="k">return</span>
        
    <span class="n">pen</span><span class="p">.</span><span class="n">fillcolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">pencolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">begin_fill</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">circle</span><span class="p">(</span><span class="n">current_size</span><span class="p">,</span> <span class="mi">72</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="mi">144</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">end_fill</span><span class="p">()</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">goto</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">current_size</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">draw_tree_with_flowers</span><span class="p">():</span>
    <span class="n">screen</span> <span class="o">=</span> <span class="n">turtle</span><span class="p">.</span><span class="n">Screen</span><span class="p">()</span>
    <span class="n">screen</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
    <span class="n">screen</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Turtle Tree with Growing and Falling Flowers"</span><span class="p">)</span>
    <span class="n">screen</span><span class="p">.</span><span class="n">bgcolor</span><span class="p">(</span><span class="s">"black"</span><span class="p">)</span>
    <span class="n">screen</span><span class="p">.</span><span class="n">tracer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Turn off animation for initial drawing
</span>    
    <span class="c1">## Create main tree pen
</span>    <span class="n">tree_pen</span> <span class="o">=</span> <span class="n">turtle</span><span class="p">.</span><span class="n">Turtle</span><span class="p">()</span>
    <span class="n">tree_pen</span><span class="p">.</span><span class="n">hideturtle</span><span class="p">()</span>
    <span class="n">tree_pen</span><span class="p">.</span><span class="n">speed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">tree_pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">tree_pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
    <span class="n">tree_pen</span><span class="p">.</span><span class="n">goto</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">H</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">tree_pen</span><span class="p">.</span><span class="n">pendown</span><span class="p">()</span>

    <span class="c1">## Store flower positions during tree drawing
</span>    <span class="n">flower_positions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">draw_branch</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">depth</span><span class="p">):</span>
        <span class="s">"""Recursively draw tree branches and record flower positions."""</span>
        <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1">## Record leaf/flower position but don't draw yet
</span>            <span class="n">size</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">))</span>
            <span class="n">flower_positions</span><span class="p">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s">'x'</span><span class="p">:</span> <span class="n">tree_pen</span><span class="p">.</span><span class="n">xcor</span><span class="p">(),</span>
                <span class="s">'y'</span><span class="p">:</span> <span class="n">tree_pen</span><span class="p">.</span><span class="n">ycor</span><span class="p">(),</span>
                <span class="s">'color'</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span>
                <span class="s">'size'</span><span class="p">:</span> <span class="n">size</span><span class="p">,</span>
                <span class="s">'attached'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="s">'grown'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>  <span class="c1"># Flower hasn't grown yet
</span>                <span class="s">'id'</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">flower_positions</span><span class="p">)</span>  <span class="c1"># Unique ID for each flower
</span>            <span class="p">})</span>
            <span class="k">return</span>
            
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">DEPTH</span> <span class="o">-</span> <span class="n">depth</span><span class="p">)</span> <span class="o">/</span> <span class="n">DEPTH</span>
        <span class="n">brown</span> <span class="o">=</span> <span class="p">(</span><span class="mi">139</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">69</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">19</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>
        <span class="n">green</span> <span class="o">=</span> <span class="p">(</span><span class="mi">34</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">139</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">34</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">blend</span><span class="p">(</span><span class="n">brown</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">pencolor</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">pensize</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">forward</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.12</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">&lt;</span> <span class="n">DEPTH</span> <span class="o">-</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1">## Record branch flower position but don't draw yet
</span>            <span class="n">size</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">))</span>
            <span class="n">flower_positions</span><span class="p">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s">'x'</span><span class="p">:</span> <span class="n">tree_pen</span><span class="p">.</span><span class="n">xcor</span><span class="p">(),</span>
                <span class="s">'y'</span><span class="p">:</span> <span class="n">tree_pen</span><span class="p">.</span><span class="n">ycor</span><span class="p">(),</span>
                <span class="s">'color'</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span>
                <span class="s">'size'</span><span class="p">:</span> <span class="n">size</span><span class="p">,</span>
                <span class="s">'attached'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="s">'grown'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>  <span class="c1"># Flower hasn't grown yet
</span>                <span class="s">'id'</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">flower_positions</span><span class="p">)</span>  <span class="c1"># Unique ID for each flower
</span>            <span class="p">})</span>
            
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">StopIteration</span><span class="p">:</span>
            <span class="k">return</span>
            
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
        <span class="n">draw_branch</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">right</span><span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span>
        <span class="n">draw_branch</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">backward</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>

    <span class="c1">## Draw the initial tree structure (without flowers)
</span>    <span class="n">params</span> <span class="o">=</span> <span class="n">param_gen</span><span class="p">()</span>
    <span class="n">draw_branch</span><span class="p">(</span><span class="n">LENGTH</span><span class="p">,</span> <span class="n">DEPTH</span><span class="p">)</span>
    
    <span class="n">screen</span><span class="p">.</span><span class="n">update</span><span class="p">()</span>  <span class="c1"># Show the initial tree
</span>    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Tree structure complete. </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">flower_positions</span><span class="p">)</span><span class="si">}</span><span class="s"> flower positions recorded."</span><span class="p">)</span>
    
    <span class="c1">## Now animate flowers growing
</span>    <span class="n">animate_flower_growth</span><span class="p">(</span><span class="n">screen</span><span class="p">,</span> <span class="n">tree_pen</span><span class="p">,</span> <span class="n">flower_positions</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">animate_flower_growth</span><span class="p">(</span><span class="n">screen</span><span class="p">,</span> <span class="n">tree_pen</span><span class="p">,</span> <span class="n">flower_positions</span><span class="p">):</span>
    <span class="s">"""Animate flowers growing on the tree"""</span>
    
    <span class="c1">## Create a separate pen for flowers
</span>    <span class="n">flower_pen</span> <span class="o">=</span> <span class="n">turtle</span><span class="p">.</span><span class="n">Turtle</span><span class="p">()</span>
    <span class="n">flower_pen</span><span class="p">.</span><span class="n">hideturtle</span><span class="p">()</span>
    <span class="n">flower_pen</span><span class="p">.</span><span class="n">speed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">flower_pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s">"Flowers growing..."</span><span class="p">)</span>
    
    <span class="c1">## Grow flowers gradually
</span>    <span class="n">growth_stages</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Number of growth stages
</span>    <span class="n">breeze_phase</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">breeze_strength</span> <span class="o">=</span> <span class="mf">0.8</span>
    <span class="n">breeze_frequency</span> <span class="o">=</span> <span class="mf">0.08</span>
    
    <span class="k">for</span> <span class="n">stage</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">growth_stages</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">flower_pen</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
        
        <span class="c1">## Calculate breeze effect for subtle movement
</span>        <span class="n">breeze_phase</span> <span class="o">+=</span> <span class="n">breeze_frequency</span>
        <span class="n">current_breeze</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">breeze_phase</span><span class="p">)</span> <span class="o">*</span> <span class="n">breeze_strength</span>
        
        <span class="c1">## Calculate growth factor (0 to 1)
</span>        <span class="n">growth_factor</span> <span class="o">=</span> <span class="n">stage</span> <span class="o">/</span> <span class="n">growth_stages</span>
        
        <span class="c1">## Draw each flower with current growth factor
</span>        <span class="k">for</span> <span class="n">flower</span> <span class="ow">in</span> <span class="n">flower_positions</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">flower</span><span class="p">[</span><span class="s">'grown'</span><span class="p">]:</span>
                <span class="c1">## Slight sway with breeze
</span>                <span class="n">sway_x</span> <span class="o">=</span> <span class="n">current_breeze</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">math</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">stage</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">flower</span><span class="p">[</span><span class="s">'x'</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">)</span>
                
                <span class="n">draw_flower_at_position</span><span class="p">(</span>
                    <span class="n">flower_pen</span><span class="p">,</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'x'</span><span class="p">]</span> <span class="o">+</span> <span class="n">sway_x</span><span class="p">,</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'y'</span><span class="p">],</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'color'</span><span class="p">],</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'size'</span><span class="p">],</span> 
                    <span class="n">current_breeze</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="n">growth_factor</span>
                <span class="p">)</span>
        
        <span class="n">screen</span><span class="p">.</span><span class="n">update</span><span class="p">()</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
    
    <span class="c1">## Mark all flowers as fully grown
</span>    <span class="k">for</span> <span class="n">flower</span> <span class="ow">in</span> <span class="n">flower_positions</span><span class="p">:</span>
        <span class="n">flower</span><span class="p">[</span><span class="s">'grown'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s">"All flowers have grown!"</span><span class="p">)</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Pause to show fully grown flowers
</span>    
    <span class="c1">## Now start the falling animation
</span>    <span class="n">make_flowers_fall</span><span class="p">(</span><span class="n">screen</span><span class="p">,</span> <span class="n">tree_pen</span><span class="p">,</span> <span class="n">flower_pen</span><span class="p">,</span> <span class="n">flower_positions</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">make_flowers_fall</span><span class="p">(</span><span class="n">screen</span><span class="p">,</span> <span class="n">tree_pen</span><span class="p">,</span> <span class="n">flower_pen</span><span class="p">,</span> <span class="n">initial_flowers</span><span class="p">):</span>
    <span class="s">"""Animate flowers falling from the tree"""</span>
    
    <span class="c1">## Create a separate pen for falling flowers
</span>    <span class="n">fall_pen</span> <span class="o">=</span> <span class="n">turtle</span><span class="p">.</span><span class="n">Turtle</span><span class="p">()</span>
    <span class="n">fall_pen</span><span class="p">.</span><span class="n">hideturtle</span><span class="p">()</span>
    <span class="n">fall_pen</span><span class="p">.</span><span class="n">speed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">fall_pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
    
    <span class="c1">## Copy initial flowers for animation
</span>    <span class="n">flowers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">flower</span> <span class="ow">in</span> <span class="n">initial_flowers</span><span class="p">:</span>
        <span class="n">flowers</span><span class="p">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s">'x'</span><span class="p">:</span> <span class="n">flower</span><span class="p">[</span><span class="s">'x'</span><span class="p">],</span>
            <span class="s">'y'</span><span class="p">:</span> <span class="n">flower</span><span class="p">[</span><span class="s">'y'</span><span class="p">],</span> 
            <span class="s">'color'</span><span class="p">:</span> <span class="n">flower</span><span class="p">[</span><span class="s">'color'</span><span class="p">],</span>
            <span class="s">'size'</span><span class="p">:</span> <span class="n">flower</span><span class="p">[</span><span class="s">'size'</span><span class="p">],</span>
            <span class="s">'attached'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">'grown'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">'id'</span><span class="p">:</span> <span class="n">flower</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span>
        <span class="p">})</span>
    
    <span class="c1">## Initialize velocities and rotations
</span>    <span class="n">velocities</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">rotations</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">fallen_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">frame_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">breeze_phase</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">breeze_strength</span> <span class="o">=</span> <span class="mf">0.8</span>
    <span class="n">breeze_frequency</span> <span class="o">=</span> <span class="mf">0.08</span>

    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Flowers starting to fall..."</span><span class="p">)</span>

    <span class="c1">## Store which flowers are currently attached to the tree
</span>    <span class="n">attached_flowers</span> <span class="o">=</span> <span class="p">{</span><span class="n">flower</span><span class="p">[</span><span class="s">'id'</span><span class="p">]:</span> <span class="n">flower</span> <span class="k">for</span> <span class="n">flower</span> <span class="ow">in</span> <span class="n">flowers</span> <span class="k">if</span> <span class="n">flower</span><span class="p">[</span><span class="s">'attached'</span><span class="p">]}</span>
    
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">frame_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">fall_pen</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">flower_pen</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># Clear the flower pen to remove flowers from tree
</span>        
        <span class="c1">## Calculate breeze effect
</span>        <span class="n">breeze_phase</span> <span class="o">+=</span> <span class="n">breeze_frequency</span>
        <span class="n">current_breeze</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">breeze_phase</span><span class="p">)</span> <span class="o">*</span> <span class="n">breeze_strength</span>

        <span class="c1">## Check for flowers starting to fall
</span>        <span class="n">flowers_to_detach</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">flower</span> <span class="ow">in</span> <span class="n">flowers</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">flower</span><span class="p">[</span><span class="s">'attached'</span><span class="p">]</span> <span class="ow">and</span> <span class="n">frame_count</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="ow">and</span> 
                <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.03</span> <span class="ow">and</span> <span class="n">frame_count</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">flowers_to_detach</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">flower</span><span class="p">[</span><span class="s">'id'</span><span class="p">])</span>
        
        <span class="c1">## Detach the flowers
</span>        <span class="k">for</span> <span class="n">flower_id</span> <span class="ow">in</span> <span class="n">flowers_to_detach</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">flower</span> <span class="ow">in</span> <span class="n">flowers</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">flower</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span> <span class="o">==</span> <span class="n">flower_id</span> <span class="ow">and</span> <span class="n">flower</span><span class="p">[</span><span class="s">'attached'</span><span class="p">]:</span>
                    <span class="n">flower</span><span class="p">[</span><span class="s">'attached'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="n">velocities</span><span class="p">[</span><span class="n">flower_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="n">WIND</span> <span class="o">*</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">WIND</span> <span class="o">*</span> <span class="mf">0.7</span><span class="p">)</span> <span class="o">+</span> <span class="n">current_breeze</span> <span class="o">*</span> <span class="mf">0.4</span><span class="p">,</span>
                        <span class="o">-</span><span class="n">GRAVITY</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
                    <span class="p">]</span>
                    <span class="n">rotations</span><span class="p">[</span><span class="n">flower_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>
                    <span class="n">fallen_count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="c1">## Remove from attached flowers
</span>                    <span class="k">if</span> <span class="n">flower_id</span> <span class="ow">in</span> <span class="n">attached_flowers</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">attached_flowers</span><span class="p">[</span><span class="n">flower_id</span><span class="p">]</span>
                    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"🌸 Flower </span><span class="si">{</span><span class="n">flower_id</span><span class="si">}</span><span class="s"> dropped! </span><span class="si">{</span><span class="n">fallen_count</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">flowers</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

        <span class="c1">## Draw only the flowers that are still attached to the tree
</span>        <span class="k">for</span> <span class="n">flower</span> <span class="ow">in</span> <span class="n">attached_flowers</span><span class="p">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">flower</span><span class="p">[</span><span class="s">'attached'</span><span class="p">]:</span>
                <span class="c1">## Draw attached flower with slight sway
</span>                <span class="n">sway_x</span> <span class="o">=</span> <span class="n">current_breeze</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">math</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">frame_count</span> <span class="o">*</span> <span class="mf">0.2</span> <span class="o">+</span> <span class="n">flower</span><span class="p">[</span><span class="s">'x'</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">)</span>
                <span class="n">draw_flower_at_position</span><span class="p">(</span>
                    <span class="n">flower_pen</span><span class="p">,</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'x'</span><span class="p">]</span> <span class="o">+</span> <span class="n">sway_x</span><span class="p">,</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'y'</span><span class="p">],</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'color'</span><span class="p">],</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'size'</span><span class="p">],</span> 
                    <span class="n">current_breeze</span> <span class="o">*</span> <span class="mi">2</span>
                <span class="p">)</span>

        <span class="c1">## Update and draw falling flowers
</span>        <span class="n">all_fallen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">attached_flowers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">active_falling_flowers</span> <span class="o">=</span> <span class="bp">False</span>
        
        <span class="k">for</span> <span class="n">flower</span> <span class="ow">in</span> <span class="n">flowers</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">flower</span><span class="p">[</span><span class="s">'attached'</span><span class="p">]:</span>
                <span class="c1">## Update falling flower physics
</span>                <span class="n">flower_id</span> <span class="o">=</span> <span class="n">flower</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span>
                <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">velocities</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">flower_id</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                
                <span class="c1">## Apply physics
</span>                <span class="n">flower</span><span class="p">[</span><span class="s">'x'</span><span class="p">]</span> <span class="o">+=</span> <span class="n">vx</span> <span class="o">+</span> <span class="n">current_breeze</span> <span class="o">*</span> <span class="mf">0.05</span>
                <span class="n">flower</span><span class="p">[</span><span class="s">'y'</span><span class="p">]</span> <span class="o">+=</span> <span class="n">vy</span>
                <span class="n">vy</span> <span class="o">-=</span> <span class="n">GRAVITY</span> <span class="o">*</span> <span class="mf">0.08</span>
                <span class="n">vx</span> <span class="o">+=</span> <span class="n">current_breeze</span> <span class="o">*</span> <span class="mf">0.015</span> <span class="o">+</span> <span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">)</span>
                <span class="n">vx</span> <span class="o">*=</span> <span class="mf">0.998</span>
                <span class="n">vy</span> <span class="o">*=</span> <span class="mf">0.998</span>
                
                <span class="c1">## Update rotation
</span>                <span class="k">if</span> <span class="n">flower_id</span> <span class="ow">in</span> <span class="n">rotations</span><span class="p">:</span>
                    <span class="n">rotations</span><span class="p">[</span><span class="n">flower_id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">vx</span> <span class="o">*</span> <span class="mi">3</span>
                
                <span class="c1">## Ground collision
</span>                <span class="n">ground_level</span> <span class="o">=</span> <span class="o">-</span><span class="n">H</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="n">flower</span><span class="p">[</span><span class="s">'size'</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.4</span> <span class="o">+</span> <span class="mi">20</span>
                <span class="k">if</span> <span class="n">flower</span><span class="p">[</span><span class="s">'y'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">ground_level</span><span class="p">:</span>
                    <span class="n">flower</span><span class="p">[</span><span class="s">'y'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ground_level</span>
                    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">vy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.3</span><span class="p">:</span>
                        <span class="n">vy</span> <span class="o">=</span> <span class="o">-</span><span class="n">vy</span> <span class="o">*</span> <span class="mf">0.2</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">vy</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="n">vx</span> <span class="o">*=</span> <span class="mf">0.8</span>
                
                <span class="n">velocities</span><span class="p">[</span><span class="n">flower_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">]</span>
                <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotations</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">flower_id</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                
                <span class="c1">## Draw falling flower
</span>                <span class="n">draw_flower_at_position</span><span class="p">(</span>
                    <span class="n">fall_pen</span><span class="p">,</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'x'</span><span class="p">],</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'y'</span><span class="p">],</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'color'</span><span class="p">],</span> 
                    <span class="n">flower</span><span class="p">[</span><span class="s">'size'</span><span class="p">],</span> 
                    <span class="n">rotation</span>
                <span class="p">)</span>
                
                <span class="k">if</span> <span class="n">vy</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">vx</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">active_falling_flowers</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">screen</span><span class="p">.</span><span class="n">update</span><span class="p">()</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">FPS</span><span class="p">)</span>
        
        <span class="c1">## End condition: all flowers have fallen and stopped moving
</span>        <span class="k">if</span> <span class="n">all_fallen</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">active_falling_flowers</span> <span class="ow">and</span> <span class="n">frame_count</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"All </span><span class="si">{</span><span class="n">fallen_count</span><span class="si">}</span><span class="s"> flowers have fallen!"</span><span class="p">)</span>
    
    <span class="c1">## Keep the window open
</span>    <span class="n">screen</span><span class="p">.</span><span class="n">exitonclick</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">draw_tree_with_flowers</span><span class="p">()</span>
</code></pre></div></div>

<hr />

<h2 id="how-it-works">How It Works</h2>

<ul>
  <li>Tree Generation: Recursive algorithm builds tree structure with random variations</li>
  <li>Flower Placement: Flowers are positioned at branch endpoints during tree drawing</li>
  <li>Growth Animation: Flowers appear gradually over 20 animation frames</li>
  <li>Physics Simulation: Each flower gets velocity and rotation properties</li>
  <li>Natural Falling: Random detachment with gravity, wind, and collision detection</li>
</ul>

<hr />

<h2 id="customization-ideas">Customization Ideas</h2>

<ul>
  <li>Seasonal Colors: Change flower colors for different seasons</li>
  <li>Different Tree Types: Modify branching patterns for various tree species</li>
  <li>Weather Effects: Add rain, snow, or stronger wind</li>
  <li>Interactive Elements: Click to make flowers fall or grow new ones</li>
  <li>Background: Add sky, ground, or other landscape elements</li>
</ul>

<hr />

<h2 id="key-learnings">Key Learnings</h2>

<ul>
  <li>Recursive Algorithms: Perfect for tree-like structures and branching patterns</li>
  <li>Turtle Graphics: Advanced techniques beyond basic shapes</li>
  <li>Animation Principles: Gradual growth, smooth transitions, frame control</li>
  <li>Physics Simulation: Gravity, wind, rotation, and collision detection</li>
  <li>Color Theory: Natural color blending and RGB manipulation</li>
  <li>Data Structures: Using dictionaries to track multiple animated objects</li>
</ul>

<hr />

<p>This project demonstrates that Python’s Turtle graphics can create much more than simple drawings. By combining recursive algorithms, color theory, and physics simulation, you can build beautiful, complex animations that bring digital nature to life. The techniques learned here can be applied to game development, data visualization, or interactive art projects.</p>

<p>Try modifying the parameters to create your own unique animated scenes!</p>]]></content><author><name>PyShine Team</name></author><category term="python" /><category term="turtle-graphics" /><category term="animation" /><category term="recursion" /><category term="physics" /><category term="tutorial" /><summary type="html"><![CDATA[Learn how to create a beautiful animated tree with growing and falling flowers using Python's Turtle graphics module. Step-by-step tutorial with physics simu...]]></summary></entry><entry><title type="html">Matrix Multiplication Performance Comparison Python vs…</title><link href="https://www.pyshine.com/Matrix-Multiplication-Perfomance-Comparison/" rel="alternate" type="text/html" title="Matrix Multiplication Performance Comparison Python vs…" /><published>2025-11-05T00:00:00+00:00</published><updated>2025-11-05T00:00:00+00:00</updated><id>https://www.pyshine.com/Matrix-Multiplication-Perfomance-Comparison</id><content type="html" xml:base="https://www.pyshine.com/Matrix-Multiplication-Perfomance-Comparison/"><![CDATA[<h1 id="matrix-multiplication-performance-comparison-python-vs-c-vs-numpy">Matrix Multiplication Performance Comparison: Python vs C++ vs NumPy</h1>

<h2 id="-beginner-friendly-tutorial-to-understand-matrix-computation-and-optimization"># Beginner-Friendly Tutorial to Understand Matrix Computation and Optimization</h2>

<p>This tutorial will walk you through performing <strong>matrix multiplication</strong> using three approaches:</p>
<ol>
  <li>Naive Python nested loops</li>
  <li>Compiled C++ code executed from Python</li>
  <li>Optimized NumPy operations</li>
</ol>

<p>We’ll compare the execution times and understand why optimized libraries like NumPy are much faster.</p>

<hr />

<h2 id="-table-of-contents"># Table of Contents</h2>
<ul>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#setup-and-imports">Setup and Imports</a></li>
  <li><a href="#generate-random-matrices">Generate Random Matrices</a></li>
  <li><a href="#naive-python-multiplication">Naive Python Multiplication</a></li>
  <li><a href="#c-multiplication-from-python">C++ Multiplication from Python</a></li>
  <li><a href="#numpy-multiplication">NumPy Multiplication</a></li>
  <li><a href="#performance-comparison">Performance Comparison</a></li>
  <li><a href="#key-takeaways">Key Takeaways</a></li>
  <li><a href="#running-the-code">Running the Code</a></li>
  <li><a href="#why-some-are-faster">Why Some Are Faster</a></li>
</ul>

<hr />

<h2 id="-introduction"># Introduction</h2>

<p>Matrix multiplication is a fundamental operation in mathematics, computer science, and data science. However, <strong>naive implementations in Python</strong> are slow for large matrices because Python loops are interpreted at runtime.</p>

<p>Optimized libraries like <strong>NumPy</strong> and compiled languages like <strong>C++</strong> can significantly reduce computation time.</p>

<hr />

<h2 id="-setup-and-imports"># Setup and Imports</h2>

<p>We’ll use the following Python libraries:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">time</span>          <span class="c1"># To measure execution time
</span><span class="kn">import</span> <span class="nn">subprocess</span>    <span class="c1"># To compile and run C++ code from Python
</span><span class="n">tempfile</span>             <span class="c1"># To create temporary files for C++ code
</span><span class="kn">import</span> <span class="nn">os</span>            <span class="c1"># To handle file operations
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>   <span class="c1"># Highly optimized matrix operations
</span></code></pre></div></div>

<p>Make sure you have <strong>NumPy</strong> installed. You can install it using:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>numpy
</code></pre></div></div>
<hr />

<h2 id="-generate-random-matrices"># Generate Random Matrices</h2>

<p>We’ll generate two square matrices <code class="language-plaintext highlighter-rouge">A</code> and <code class="language-plaintext highlighter-rouge">B</code> of size <code class="language-plaintext highlighter-rouge">N x N</code> with random integers between 0 and 10.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## # Matrix Size
</span><span class="n">N</span> <span class="o">=</span> <span class="mi">600</span>  <span class="c1"># Increase N to see larger performance differences
</span>
<span class="c1">## # Generate Matrices
</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
</code></pre></div></div>

<blockquote>
  <p>Tip: For beginners, start with smaller values like <code class="language-plaintext highlighter-rouge">N=100</code> to test the code faster.</p>
</blockquote>

<hr />

<h2 id="-naive-python-multiplication"># Naive Python Multiplication</h2>

<p>Using nested loops, we multiply matrices manually.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">start_py</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">C</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
<span class="n">end_py</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">python_time</span> <span class="o">=</span> <span class="n">end_py</span> <span class="o">-</span> <span class="n">start_py</span>
</code></pre></div></div>

<h2 id="-how-it-works"># How It Works</h2>
<ul>
  <li>We create an empty matrix <code class="language-plaintext highlighter-rouge">C</code> with zeros.</li>
  <li>Three nested loops compute the dot product.</li>
  <li>Time is recorded using <code class="language-plaintext highlighter-rouge">time.time()</code>.</li>
</ul>

<p><strong>Note:</strong> This is extremely slow for large matrices due to Python’s interpreted loops.</p>

<hr />

<h2 id="-c-multiplication-from-python"># C++ Multiplication from Python</h2>

<p>We can speed things up using <strong>C++</strong>, a compiled language. We’ll:</p>
<ol>
  <li>Write the C++ code to a temporary file.</li>
  <li>Compile it using <code class="language-plaintext highlighter-rouge">g++</code>.</li>
  <li>Run the executable and capture the runtime.</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cpp_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"""
## # include &lt;iostream&gt;
## # include &lt;vector&gt;
## # include &lt;cstdlib&gt;
## # include &lt;ctime&gt;
using namespace std;
int main(){{
    int N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s">;
    vector&lt;vector&lt;int&gt;&gt; A(N, vector&lt;int&gt;(N));
    vector&lt;vector&lt;int&gt;&gt; B(N, vector&lt;int&gt;(N));
    vector&lt;vector&lt;long long&gt;&gt; C(N, vector&lt;long long&gt;(N, 0));
    srand(time(0));
    for(int i=0;i&lt;N;i++)
        for(int j=0;j&lt;N;j++){{
            A[i][j] = rand() % 11;
            B[i][j] = rand() % 11;
        }}
    clock_t start = clock();
    for(int i=0;i&lt;N;i++)
        for(int j=0;j&lt;N;j++)
            for(int k=0;k&lt;N;k++)
                C[i][j] += (long long)A[i][k]*B[k][j];
    clock_t end = clock();
    cout &lt;&lt; double(end-start)/CLOCKS_PER_SEC &lt;&lt; endl;
    return 0;
}}
"""</span>

<span class="c1">## # Write to temp file
</span><span class="k">with</span> <span class="n">tempfile</span><span class="p">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s">".cpp"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">cpp_file</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">name</span>
    <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">cpp_code</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>

<span class="n">exe_file</span> <span class="o">=</span> <span class="n">cpp_file</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">".cpp"</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>

<span class="c1">## # Compile
</span><span class="n">compile_proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">([</span><span class="s">"g++"</span><span class="p">,</span> <span class="n">cpp_file</span><span class="p">,</span> <span class="s">"-O2"</span><span class="p">,</span> <span class="s">"-o"</span><span class="p">,</span> <span class="n">exe_file</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">compile_proc</span><span class="p">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"C++ Compilation failed!"</span><span class="p">,</span> <span class="n">compile_proc</span><span class="p">.</span><span class="n">stderr</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">([</span><span class="n">exe_file</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">cpp_time</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">strip</span><span class="p">())</span>

<span class="c1">## # Cleanup
</span><span class="n">ios</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">cpp_file</span><span class="p">)</span>
<span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">exe_file</span><span class="p">):</span> <span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">exe_file</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Explanation:</strong></p>
<ul>
  <li>We generate the matrices inside C++ with <code class="language-plaintext highlighter-rouge">rand()</code>.</li>
  <li>Use triple nested loops to calculate multiplication.</li>
  <li>Capture execution time using <code class="language-plaintext highlighter-rouge">clock()</code>.</li>
  <li>Compile with <code class="language-plaintext highlighter-rouge">-O2</code> optimization flag.</li>
</ul>

<hr />

<h2 id="-numpy-multiplication"># NumPy Multiplication</h2>

<p>NumPy provides optimized matrix multiplication using highly efficient C/Fortran libraries under the hood.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A_np</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">B_np</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>

<span class="n">start_np</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">C_np</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A_np</span><span class="p">,</span> <span class="n">B_np</span><span class="p">)</span>
<span class="n">end_np</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">numpy_time</span> <span class="o">=</span> <span class="n">end_np</span> <span class="o">-</span> <span class="n">start_np</span>
</code></pre></div></div>
<h2 id="-why-numpy-is-fast"># Why NumPy is Fast</h2>
<ul>
  <li>NumPy leverages <strong>vectorized operations</strong>.</li>
  <li>Internal loops are compiled in <strong>C/Fortran</strong>, avoiding Python overhead.</li>
  <li>Utilizes CPU cache and SIMD instructions for speed.</li>
</ul>

<hr />

<h2 id="-performance-comparison"># Performance Comparison</h2>

<p>Finally, let’s compare all three methods:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">=== Performance Comparison ==="</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Python: </span><span class="si">{</span><span class="n">python_time</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> s"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"C++: </span><span class="si">{</span><span class="n">cpp_time</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> s"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"NumPy: </span><span class="si">{</span><span class="n">numpy_time</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> s"</span><span class="p">)</span>
</code></pre></div></div>

<p>You will usually find:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Python &gt;&gt; C++ &gt;&gt; NumPy
</code></pre></div></div>
<p>for execution speed, with NumPy being the fastest.</p>

<hr />

<h2 id="-key-takeaways"># Key Takeaways</h2>
<ul>
  <li>Naive Python loops are slow for large matrices.</li>
  <li>C++ is faster due to compilation, but requires more setup.</li>
  <li>NumPy is both <strong>fast</strong> and <strong>easy to use</strong> in Python.</li>
  <li>Optimized libraries are crucial for performance-critical applications.</li>
</ul>

<hr />

<h2 id="-running-the-code"># Running the Code</h2>

<ol>
  <li>Copy the code into a <code class="language-plaintext highlighter-rouge">.py</code> file.</li>
  <li>Ensure you have <strong>NumPy</strong> and <strong>g++ compiler</strong> installed.</li>
  <li>Run the Python script:</li>
</ol>

<hr />

<h2 id="-why-some-are-faster"># Why Some Are Faster</h2>

<p>The speed differences are due to how the code is executed:</p>

<ul>
  <li><strong>Python</strong>: Slower because it interprets loops at runtime in a high-level language, which adds overhead for each iteration.</li>
  <li><strong>C++</strong>: Faster because it is compiled into machine code, reducing runtime overhead. The <code class="language-plaintext highlighter-rouge">-O2</code> flag also optimizes loops.</li>
  <li><strong>NumPy</strong>: Fastest because it is written in C and Fortran under the hood and uses highly optimized, vectorized operations that leverage CPU features.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python matrix_comparison.py
</code></pre></div></div>
<h2 id="-complete-code"># Complete Code</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">time</span><span class="p">,</span> <span class="n">subprocess</span><span class="p">,</span> <span class="n">tempfile</span><span class="p">,</span> <span class="n">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span> <span class="c1"># Highly optimized C/Fortran based
</span>
<span class="c1">## # Matrix Size
</span><span class="n">N</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># Adjust bigger N shows bigger speed difference
## # Generate Matrices
</span><span class="n">A</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">,(</span><span class="mi">2</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>

<span class="c1">## # Python Naive matrix Multiplication
</span><span class="n">start_py</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">C</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
<span class="n">end_py</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">python_time</span> <span class="o">=</span> <span class="n">end_py</span> <span class="o">-</span> <span class="n">start_py</span>

<span class="c1">## # C++ version from Python
</span><span class="n">cpp_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"""
## # include &lt;iostream&gt;
## # include &lt;vector&gt;
## # include &lt;cstdlib&gt;
## # include &lt;ctime&gt;
using namespace std;
int main(){{
    int N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s">;
    vector&lt;vector&lt;int&gt; &gt; A(N, vector&lt;int&gt;(N));
    vector&lt;vector&lt;int&gt; &gt; B(N, vector&lt;int&gt;(N));
    vector&lt;vector&lt;long long&gt; &gt;
    C(N, vector&lt;long long&gt;(N, 0));
    
    srand(time(0));
    for(int i=0; i&lt;N; i++)
        for(int j=0; j&lt;N; j++) {{
            A[i][j] = rand() % 11;
            B[i][j] = rand() % 11;
        }}
    clock_t start = clock();
    for (int i=0; i&lt;N; i++)
        for(int j=0; j&lt;N; j++)
            for(int k=0; k&lt;N; k++)
                C[i][j] += (long long)A[i][k]*B[k][j];
    clock_t end  = clock();
    double duration = double(end-start)/CLOCKS_PER_SEC;
    cout &lt;&lt; duration &lt;&lt; endl;
    return 0;
}}
"""</span> 

<span class="c1">## # Write C++ code to temp file
</span><span class="k">with</span> <span class="n">tempfile</span><span class="p">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                 <span class="n">suffix</span><span class="o">=</span><span class="s">".cpp"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">cpp_file</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">name</span>
    <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">cpp_code</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>
<span class="n">exe_file</span> <span class="o">=</span> <span class="n">cpp_file</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">".cpp"</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>
<span class="n">compile_proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">([</span><span class="s">"g++"</span><span class="p">,</span> <span class="n">cpp_file</span><span class="p">,</span>
                               <span class="s">"-O2"</span><span class="p">,</span> <span class="s">"-o"</span><span class="p">,</span> <span class="n">exe_file</span><span class="p">],</span>
                              <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                              <span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">compile_proc</span><span class="p">.</span><span class="n">returncode</span> <span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"C++ Compilation failed!"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">compile_proc</span><span class="p">.</span><span class="n">stderr</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1">## Run C++ executable and capture time
</span>    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">([</span><span class="n">exe_file</span><span class="p">],</span>
                            <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                            <span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">cpp_time</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">strip</span><span class="p">())</span>

<span class="c1">## # Cleanup temporary files
</span><span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">cpp_file</span><span class="p">)</span>
<span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">exe_file</span><span class="p">):</span>
    <span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">exe_file</span><span class="p">)</span>

<span class="c1">## # Numpy Matrix Multiplication
</span><span class="n">A_np</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">B_np</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>

<span class="n">start_np</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">C_np</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A_np</span><span class="p">,</span> <span class="n">B_np</span><span class="p">)</span>
<span class="n">end_np</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">numpy_time</span> <span class="o">=</span> <span class="n">end_np</span> <span class="o">-</span> <span class="n">start_np</span>

<span class="c1">## # Compare All
</span><span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">=== Performance Comparison ==="</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Python: </span><span class="si">{</span><span class="n">python_time</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> s"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"C++: </span><span class="si">{</span><span class="n">cpp_time</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> s"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Numpy: </span><span class="si">{</span><span class="n">numpy_time</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> s"</span><span class="p">)</span>
</code></pre></div></div>

<p>You’ll see execution times for Python, C++, and NumPy.</p>

<hr />

<p>This tutorial demonstrates how <strong>choosing the right tools</strong> can drastically impact performance in numerical computing.</p>]]></content><author><name>PyShine Team</name></author><category term="matrix-multiplication" /><category term="Python" /><category term="C++" /><category term="NumPy" /><category term="performance" /><summary type="html"><![CDATA[Learn how to compare matrix multiplication speeds using naive Python, compiled C++, and optimized NumPy.]]></summary></entry><entry><title type="html">Make a Tree with falling Flowers</title><link href="https://www.pyshine.com/Make-a-tree-with-Falling-Flowers/" rel="alternate" type="text/html" title="Make a Tree with falling Flowers" /><published>2025-11-04T00:00:00+00:00</published><updated>2025-11-04T00:00:00+00:00</updated><id>https://www.pyshine.com/Make-a-tree-with-Falling-Flowers</id><content type="html" xml:base="https://www.pyshine.com/Make-a-tree-with-Falling-Flowers/"><![CDATA[<hr />

<h1 id="table-of-contents">Table of Contents</h1>
<ol>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#setup-and-imports">Setup and Imports</a></li>
  <li><a href="#generating-branch-parameters">Generating Branch Parameters</a></li>
  <li><a href="#tree-and-flower-drawing-functions">Tree and Flower Drawing Functions</a></li>
  <li><a href="#animating-falling-blossoms">Animating Falling Blossoms</a></li>
  <li><a href="#complete-code">Complete Code</a></li>
  <li><a href="#how-it-works">How It Works</a></li>
  <li><a href="#run-the-script">Run the Script</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
</ol>

<hr />

<h2 id="overview">Overview</h2>
<p>This tutorial expands on our previous <strong>Cherry Blossom Tree</strong> by adding <strong>animated falling petals</strong> that gently sway in the wind and settle on the ground.<br />
We’ll use <code class="language-plaintext highlighter-rouge">turtle</code> graphics and a lightweight physics simulation with gravity, wind, and smooth animation updates.</p>

<hr />

<h2 id="setup-and-imports">Setup and Imports</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">turtle</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">seed</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c1">## === Settings ===
</span><span class="n">W</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="mi">420</span><span class="p">,</span> <span class="mi">420</span>
<span class="n">DEPTH</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">LENGTH</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">BA</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">GRAVITY</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">WIND</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">FPS</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">192</span><span class="p">)</span>
</code></pre></div></div>
<p>We initialize the screen size, branch depth, and animation constants for wind and gravity.</p>

<hr />

<h2 id="generating-branch-parameters">Generating Branch Parameters</h2>

<p>Before drawing, we create random parameters for branch angles and lengths.<br />
This ensures a natural look while keeping the structure reproducible.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">branch_params</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">def</span> <span class="nf">record_my_params</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">BA</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">BA</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">BA</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">BA</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">l1</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">l2</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">branch_params</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">level</span><span class="p">))</span>
    <span class="n">record_my_params</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">record_my_params</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">record_my_params</span><span class="p">(</span><span class="n">LENGTH</span><span class="p">,</span> <span class="n">DEPTH</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">param_gen</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">branch_params</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">p</span>
</code></pre></div></div>
<p>The <code class="language-plaintext highlighter-rouge">record_my_params()</code> function recursively stores all angles and lengths before we start drawing.</p>

<hr />

<h2 id="tree-and-flower-drawing-functions">Tree and Flower Drawing Functions</h2>

<p>We use helper functions to <strong>blend colors</strong>, <strong>draw flowers</strong>, and <strong>build branches</strong> recursively.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">blend</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
        <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
        <span class="n">c1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">draw_flower</span><span class="p">(</span><span class="n">pen</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">goto</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">setheading</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">pendown</span><span class="p">()</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">fillcolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">pencolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">begin_fill</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">circle</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">72</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="mi">144</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">end_fill</span><span class="p">()</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">goto</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">))</span>
</code></pre></div></div>
<p>Each blossom is drawn using a <strong>five-petal shape</strong> with subtle pink tones.</p>

<hr />

<h2 id="animating-falling-blossoms">Animating Falling Blossoms</h2>

<p>After building the tree, we animate petals detaching, swaying in the wind, and landing softly.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Main animation loop
</span><span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">frame_count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">tree_pen</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">fall_pen</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">draw_tree</span><span class="p">()</span>

    <span class="n">breeze_phase</span> <span class="o">+=</span> <span class="n">breeze_frequency</span>
    <span class="n">current_breeze</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">breeze_phase</span><span class="p">)</span> <span class="o">*</span> <span class="n">breeze_strength</span>

    <span class="c1">## Detach blossoms randomly
</span>    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">flowers</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">and</span> <span class="n">frame_count</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="ow">and</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.04</span><span class="p">:</span>
            <span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">velocities</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="n">WIND</span> <span class="o">*</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">WIND</span> <span class="o">*</span> <span class="mf">0.7</span><span class="p">)</span> <span class="o">+</span> <span class="n">current_breeze</span> <span class="o">*</span> <span class="mf">0.4</span><span class="p">,</span>
                <span class="o">-</span><span class="n">GRAVITY</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">rotations</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>
            <span class="n">fallen_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"🌸 dropped! Total fallen: </span><span class="si">{</span><span class="n">fallen_count</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">flowers</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

    <span class="c1">## Move and draw each blossom
</span>    <span class="p">...</span>
</code></pre></div></div>
<p>The simulation uses <strong>gravity and sinusoidal wind motion</strong> for realistic drifting.</p>

<hr />

<h2 id="complete-code">Complete Code</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">turtle</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">seed</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c1">## === Settings ===
</span><span class="n">W</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="mi">420</span><span class="p">,</span> <span class="mi">420</span>
<span class="n">DEPTH</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">LENGTH</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">BA</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">GRAVITY</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">WIND</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">FPS</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">192</span><span class="p">)</span>

<span class="c1">## === Pre-generate random branch params ===
</span><span class="n">branch_params</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">def</span> <span class="nf">record_my_params</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">BA</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">BA</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">BA</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">BA</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">l1</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">l2</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">branch_params</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">level</span><span class="p">))</span>
    <span class="n">record_my_params</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">record_my_params</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">record_my_params</span><span class="p">(</span><span class="n">LENGTH</span><span class="p">,</span> <span class="n">DEPTH</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">param_gen</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">branch_params</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">p</span>


<span class="k">def</span> <span class="nf">turtle_tree</span><span class="p">():</span>
    <span class="n">screen</span> <span class="o">=</span> <span class="n">turtle</span><span class="p">.</span><span class="n">Screen</span><span class="p">()</span>
    <span class="n">screen</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
    <span class="n">screen</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Turtle Tree with Falling Flowers"</span><span class="p">)</span>
    <span class="n">screen</span><span class="p">.</span><span class="n">bgcolor</span><span class="p">(</span><span class="s">"black"</span><span class="p">)</span>
    <span class="n">screen</span><span class="p">.</span><span class="n">tracer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">tree_pen</span> <span class="o">=</span> <span class="n">turtle</span><span class="p">.</span><span class="n">Turtle</span><span class="p">()</span>
    <span class="n">tree_pen</span><span class="p">.</span><span class="n">hideturtle</span><span class="p">()</span>
    <span class="n">tree_pen</span><span class="p">.</span><span class="n">speed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">fall_pen</span> <span class="o">=</span> <span class="n">turtle</span><span class="p">.</span><span class="n">Turtle</span><span class="p">()</span>
    <span class="n">fall_pen</span><span class="p">.</span><span class="n">hideturtle</span><span class="p">()</span>
    <span class="n">fall_pen</span><span class="p">.</span><span class="n">speed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">fall_pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>

    <span class="n">flowers</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># [x, y, color, size, attached]
</span>    <span class="n">fallen_count</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># &lt;--- NEW counter
</span>
    <span class="k">def</span> <span class="nf">blend</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
            <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
            <span class="n">c1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">draw_flower</span><span class="p">(</span><span class="n">pen</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">goto</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">setheading</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">pendown</span><span class="p">()</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">fillcolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">pencolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">begin_fill</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">pen</span><span class="p">.</span><span class="n">circle</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">72</span><span class="p">)</span>
            <span class="n">pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="mi">144</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">end_fill</span><span class="p">()</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">goto</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">draw_tree</span><span class="p">():</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">goto</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">H</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">30</span><span class="p">)</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">setheading</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">pendown</span><span class="p">()</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">param_gen</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">draw_branch</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">depth</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">DEPTH</span> <span class="o">-</span> <span class="n">depth</span><span class="p">)</span> <span class="o">/</span> <span class="n">DEPTH</span>
            <span class="n">brown</span> <span class="o">=</span> <span class="p">(</span><span class="mi">139</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">69</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">19</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>
            <span class="n">green</span> <span class="o">=</span> <span class="p">(</span><span class="mi">34</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">139</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">34</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>
            <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">blend</span><span class="p">(</span><span class="n">brown</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
            <span class="n">tree_pen</span><span class="p">.</span><span class="n">pencolor</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">tree_pen</span><span class="p">.</span><span class="n">pensize</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">tree_pen</span><span class="p">.</span><span class="n">forward</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
            <span class="k">except</span> <span class="nb">StopIteration</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="n">tree_pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
            <span class="n">draw_branch</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">tree_pen</span><span class="p">.</span><span class="n">right</span><span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span>
            <span class="n">draw_branch</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">tree_pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
            <span class="n">tree_pen</span><span class="p">.</span><span class="n">backward</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>

        <span class="n">draw_branch</span><span class="p">(</span><span class="n">LENGTH</span><span class="p">,</span> <span class="n">DEPTH</span><span class="p">)</span>

    <span class="c1">## === Build tree &amp; record flower positions ===
</span>    <span class="n">tree_pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
    <span class="n">tree_pen</span><span class="p">.</span><span class="n">goto</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">H</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">tree_pen</span><span class="p">.</span><span class="n">setheading</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">param_gen</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">add_flowers</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">depth</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">))</span>
            <span class="n">flowers</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="n">tree_pen</span><span class="p">.</span><span class="n">xcor</span><span class="p">(),</span> <span class="n">tree_pen</span><span class="p">.</span><span class="n">ycor</span><span class="p">(),</span> <span class="n">color</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="bp">True</span><span class="p">])</span>
            <span class="k">return</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">forward</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.12</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">&lt;</span> <span class="n">DEPTH</span> <span class="o">-</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">))</span>
            <span class="n">flowers</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="n">tree_pen</span><span class="p">.</span><span class="n">xcor</span><span class="p">(),</span> <span class="n">tree_pen</span><span class="p">.</span><span class="n">ycor</span><span class="p">(),</span> <span class="n">color</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="bp">True</span><span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">StopIteration</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
        <span class="n">add_flowers</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">right</span><span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span>
        <span class="n">add_flowers</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">backward</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>

    <span class="n">add_flowers</span><span class="p">(</span><span class="n">LENGTH</span><span class="p">,</span> <span class="n">DEPTH</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Tree complete with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">flowers</span><span class="p">)</span><span class="si">}</span><span class="s"> blossoms"</span><span class="p">)</span>

    <span class="n">velocities</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">rotations</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">frame_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">breeze_phase</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">breeze_strength</span> <span class="o">=</span> <span class="mf">0.8</span>
    <span class="n">breeze_frequency</span> <span class="o">=</span> <span class="mf">0.08</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">frame_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">tree_pen</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">fall_pen</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">draw_tree</span><span class="p">()</span>

        <span class="n">breeze_phase</span> <span class="o">+=</span> <span class="n">breeze_frequency</span>
        <span class="n">current_breeze</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">breeze_phase</span><span class="p">)</span> <span class="o">*</span> <span class="n">breeze_strength</span>

        <span class="c1">## Detach blossoms
</span>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">flowers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">and</span> <span class="n">frame_count</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="ow">and</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.04</span><span class="p">:</span>
                <span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="n">velocities</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="n">WIND</span> <span class="o">*</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">WIND</span> <span class="o">*</span> <span class="mf">0.7</span><span class="p">)</span> <span class="o">+</span> <span class="n">current_breeze</span> <span class="o">*</span> <span class="mf">0.4</span><span class="p">,</span>
                    <span class="o">-</span><span class="n">GRAVITY</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="n">rotations</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>
                <span class="n">fallen_count</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># increment counter
</span>                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"🌸 dropped! Total fallen: </span><span class="si">{</span><span class="n">fallen_count</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">flowers</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

        <span class="n">all_fallen</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">flowers</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">attached</span> <span class="o">=</span> <span class="n">f</span>
            <span class="k">if</span> <span class="n">attached</span><span class="p">:</span>
                <span class="n">sway_x</span> <span class="o">=</span> <span class="n">current_breeze</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">math</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">frame_count</span> <span class="o">*</span> <span class="mf">0.2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">)</span>
                <span class="n">draw_flower</span><span class="p">(</span><span class="n">tree_pen</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">sway_x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">current_breeze</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">all_fallen</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flower_id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">velocities</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">flower_id</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                <span class="n">x</span> <span class="o">+=</span> <span class="n">vx</span> <span class="o">+</span> <span class="n">current_breeze</span> <span class="o">*</span> <span class="mf">0.05</span>
                <span class="n">y</span> <span class="o">+=</span> <span class="n">vy</span>
                <span class="n">vy</span> <span class="o">-=</span> <span class="n">GRAVITY</span> <span class="o">*</span> <span class="mf">0.08</span>
                <span class="n">vx</span> <span class="o">+=</span> <span class="n">current_breeze</span> <span class="o">*</span> <span class="mf">0.015</span> <span class="o">+</span> <span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">)</span>
                <span class="n">vx</span> <span class="o">*=</span> <span class="mf">0.998</span>
                <span class="n">vy</span> <span class="o">*=</span> <span class="mf">0.998</span>
                <span class="k">if</span> <span class="n">flower_id</span> <span class="ow">in</span> <span class="n">rotations</span><span class="p">:</span>
                    <span class="n">rotations</span><span class="p">[</span><span class="n">flower_id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">vx</span> <span class="o">*</span> <span class="mi">3</span>
                <span class="n">ground_level</span> <span class="o">=</span> <span class="o">-</span><span class="n">H</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="n">size</span> <span class="o">*</span> <span class="mf">1.5</span>
                <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">ground_level</span><span class="p">:</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">ground_level</span>
                    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">vy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.3</span><span class="p">:</span>
                        <span class="n">vy</span> <span class="o">=</span> <span class="o">-</span><span class="n">vy</span> <span class="o">*</span> <span class="mf">0.2</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">vy</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="n">vx</span> <span class="o">*=</span> <span class="mf">0.8</span>
                <span class="n">velocities</span><span class="p">[</span><span class="n">flower_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">]</span>
                <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
                <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotations</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">flower_id</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">draw_flower</span><span class="p">(</span><span class="n">fall_pen</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">rotation</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">vy</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">vx</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">all_fallen</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="n">screen</span><span class="p">.</span><span class="n">update</span><span class="p">()</span>
        <span class="c1">## time.sleep(FPS)
</span>        <span class="k">if</span> <span class="n">all_fallen</span> <span class="ow">and</span> <span class="n">frame_count</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"All </span><span class="si">{</span><span class="n">fallen_count</span><span class="si">}</span><span class="s"> flowers have fallen!"</span><span class="p">)</span>
    <span class="n">turtle</span><span class="p">.</span><span class="n">done</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">turtle_tree</span><span class="p">()</span>

</code></pre></div></div>

<hr />

<h2 id="how-it-works">How It Works</h2>
<ul>
  <li><strong>Tree Drawing:</strong> Recursive function generates symmetrical branches.</li>
  <li><strong>Blossom Attachment:</strong> Each flower starts attached to a branch.</li>
  <li><strong>Falling Motion:</strong> Randomly detaches and moves downward using basic gravity physics.</li>
  <li><strong>Wind:</strong> Adds horizontal sway using a sine wave pattern.</li>
  <li><strong>Collision Detection:</strong> Flowers stop gently upon reaching the ground.</li>
</ul>

<hr />

<h2 id="run-the-script">Run the Script</h2>

<p>Save as <code class="language-plaintext highlighter-rouge">falling_cherry_tree.py</code> and run:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 falling_cherry_tree.py
</code></pre></div></div>

<p>You’ll see a black background with blossoms drifting gracefully from the branches and settling at the base.</p>

<hr />

<h2 id="conclusion">Conclusion</h2>
<p>This project brings life to your fractal tree by adding <strong>motion and realism</strong>.<br />
Experiment with <code class="language-plaintext highlighter-rouge">WIND</code>, <code class="language-plaintext highlighter-rouge">GRAVITY</code>, and <code class="language-plaintext highlighter-rouge">FPS</code> to create slow drifting or stormy blossom effects 🌸💨<br />
Next, try combining this animation with <strong>sound or seasonal background music</strong> for a serene interactive art piece!</p>]]></content><author><name>PyShine Team</name></author><category term="python" /><category term="turtle" /><category term="animation" /><category term="graphics" /><category term="nature" /><summary type="html"><![CDATA[Python Turtle Graphics Tutorial to animate falling cherry blossoms]]></summary></entry><entry><title type="html">Make a Tree with Blossoms in Python</title><link href="https://www.pyshine.com/Make-a-tree-with-Flowers/" rel="alternate" type="text/html" title="Make a Tree with Blossoms in Python" /><published>2025-11-04T00:00:00+00:00</published><updated>2025-11-04T00:00:00+00:00</updated><id>https://www.pyshine.com/Make-a-tree-with-Flowers</id><content type="html" xml:base="https://www.pyshine.com/Make-a-tree-with-Flowers/"><![CDATA[<hr />

<h1 id="table-of-contents">Table of Contents</h1>
<ol>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#setup-and-imports">Setup and Imports</a></li>
  <li><a href="#generating-random-branch-parameters">Generating Random Branch Parameters</a></li>
  <li><a href="#drawing-functions">Drawing Functions</a></li>
  <li><a href="#main-tree-function">Main Tree Function</a></li>
  <li><a href="#complete-code">Complete Code</a></li>
  <li><a href="#how-it-works">How It Works</a></li>
  <li><a href="#run-the-script">Run the Script</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
</ol>

<hr />

<h2 id="overview">Overview</h2>
<p>This tutorial demonstrates how to create a <strong>beautiful cherry blossom tree</strong> using Python’s <code class="language-plaintext highlighter-rouge">turtle</code> graphics module.<br />
The program uses recursion to generate realistic branches, randomization for natural variation, and color blending to simulate blooming flowers.</p>

<hr />

<h2 id="setup-and-imports">Setup and Imports</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">turtle</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">seed</span>

<span class="c1">## Settings
</span><span class="n">W</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="mi">420</span><span class="p">,</span> <span class="mi">420</span>
<span class="n">DEPTH</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">LENGTH</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">BA</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">192</span><span class="p">)</span>
</code></pre></div></div>

<p>We set up the screen dimensions, recursion depth, branch length, and base branch angle.</p>

<hr />

<h2 id="generating-random-branch-parameters">Generating Random Branch Parameters</h2>

<p>Before drawing, we pre-generate random angles and lengths for each branch.<br />
This ensures consistent structure each time the script runs (because we fixed the random seed).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">branch_params</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">record_my_params</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">BA</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">BA</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">BA</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">BA</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">l1</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">l2</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">branch_params</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">level</span><span class="p">))</span>
    <span class="n">record_my_params</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">record_my_params</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">record_my_params</span><span class="p">(</span><span class="n">LENGTH</span><span class="p">,</span> <span class="n">DEPTH</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">param_gen</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">branch_params</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">p</span>
</code></pre></div></div>

<hr />

<h2 id="drawing-functions">Drawing Functions</h2>

<p>Two helper functions are used:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">blend()</code> for color blending</li>
  <li><code class="language-plaintext highlighter-rouge">draw_flower()</code> for drawing small cherry blossoms</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">blend</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
        <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
        <span class="n">c1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">draw_flower</span><span class="p">():</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">))</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">fillcolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">pencolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">begin_fill</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">circle</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">72</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="mi">144</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">end_fill</span><span class="p">()</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">))</span>
</code></pre></div></div>

<hr />

<h2 id="main-tree-function">Main Tree Function</h2>

<p>The recursive function <code class="language-plaintext highlighter-rouge">draw_branch()</code> handles branching, coloring, and flower placement.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">draw_branch</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">depth</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">draw_flower</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">DEPTH</span> <span class="o">-</span> <span class="n">depth</span><span class="p">)</span> <span class="o">/</span> <span class="n">DEPTH</span>
    <span class="n">brown</span> <span class="o">=</span> <span class="p">(</span><span class="mi">139</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">69</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">19</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">green</span> <span class="o">=</span> <span class="p">(</span><span class="mi">34</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">139</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">34</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">blend</span><span class="p">(</span><span class="n">brown</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">pencolor</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">pensize</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">forward</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.12</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">&lt;</span> <span class="n">DEPTH</span> <span class="o">-</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">draw_flower</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">StopIteration</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
    <span class="n">draw_branch</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">right</span><span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span>
    <span class="n">draw_branch</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">backward</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Level: </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s"> Depth: </span><span class="si">{</span><span class="n">depth</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h2 id="complete-code">Complete Code</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">turtle</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span><span class="p">,</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">seed</span>

<span class="n">W</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="mi">420</span><span class="p">,</span> <span class="mi">420</span>
<span class="n">DEPTH</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">LENGTH</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">BA</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">192</span><span class="p">)</span>

<span class="n">branch_params</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">record_my_params</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">BA</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">BA</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">BA</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">BA</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">l1</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">l2</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">branch_params</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">level</span><span class="p">))</span>
    <span class="n">record_my_params</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">record_my_params</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">record_my_params</span><span class="p">(</span><span class="n">LENGTH</span><span class="p">,</span> <span class="n">DEPTH</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">param_gen</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">branch_params</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">p</span>

<span class="k">def</span> <span class="nf">turtle_tree</span><span class="p">():</span>
    <span class="n">screen</span> <span class="o">=</span> <span class="n">turtle</span><span class="p">.</span><span class="n">Screen</span><span class="p">()</span>
    <span class="n">screen</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
    <span class="n">screen</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Turtle Tree with Flowers"</span><span class="p">)</span>
    <span class="n">screen</span><span class="p">.</span><span class="n">bgcolor</span><span class="p">(</span><span class="s">"black"</span><span class="p">)</span>
    <span class="n">pen</span> <span class="o">=</span> <span class="n">turtle</span><span class="p">.</span><span class="n">Turtle</span><span class="p">()</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">hideturtle</span><span class="p">()</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">speed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">penup</span><span class="p">()</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">goto</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">H</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">pen</span><span class="p">.</span><span class="n">pendown</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">blend</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
            <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
            <span class="n">c1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">draw_flower</span><span class="p">():</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">))</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">fillcolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">pencolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">begin_fill</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">pen</span><span class="p">.</span><span class="n">circle</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">72</span><span class="p">)</span>
            <span class="n">pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="mi">144</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">end_fill</span><span class="p">()</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">draw_branch</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">depth</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">draw_flower</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">DEPTH</span> <span class="o">-</span> <span class="n">depth</span><span class="p">)</span> <span class="o">/</span> <span class="n">DEPTH</span>
        <span class="n">brown</span> <span class="o">=</span> <span class="p">(</span><span class="mi">139</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">69</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">19</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>
        <span class="n">green</span> <span class="o">=</span> <span class="p">(</span><span class="mi">34</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">139</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">34</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">blend</span><span class="p">(</span><span class="n">brown</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">pencolor</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">pensize</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">forward</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.12</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">&lt;</span> <span class="n">DEPTH</span> <span class="o">-</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">draw_flower</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">StopIteration</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
        <span class="n">draw_branch</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">right</span><span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span>
        <span class="n">draw_branch</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
        <span class="n">pen</span><span class="p">.</span><span class="n">backward</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Level: </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s"> Depth: </span><span class="si">{</span><span class="n">depth</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">param_gen</span><span class="p">()</span>
    <span class="n">draw_branch</span><span class="p">(</span><span class="n">LENGTH</span><span class="p">,</span> <span class="n">DEPTH</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Tree complete."</span><span class="p">)</span>
    <span class="n">turtle</span><span class="p">.</span><span class="n">done</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">turtle_tree</span><span class="p">()</span>
</code></pre></div></div>

<hr />

<h2 id="how-it-works">How It Works</h2>
<ul>
  <li><strong>Recursion:</strong> Each branch splits into two sub-branches with random angles and lengths.</li>
  <li><strong>Color blending:</strong> Gradually transitions from brown to green as branches move outward.</li>
  <li><strong>Flowers:</strong> Small pink blossoms are drawn at branch tips and occasionally mid-branch.</li>
  <li><strong>Param reuse:</strong> Pre-generated parameters keep the tree consistent on reruns.</li>
</ul>

<hr />

<h2 id="run-the-script">Run the Script</h2>

<p>Save as <code class="language-plaintext highlighter-rouge">turtle_tree.py</code> and run:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 turtle_tree.py
</code></pre></div></div>

<p>A black screen with a growing cherry blossom tree should appear.</p>

<hr />

<h2 id="conclusion">Conclusion</h2>
<p>This project combines <strong>recursion</strong>, <strong>randomness</strong>, and <strong>color blending</strong> to simulate organic growth.<br />
You can modify parameters like <code class="language-plaintext highlighter-rouge">DEPTH</code>, <code class="language-plaintext highlighter-rouge">LENGTH</code>, and flower colors to create your own natural variations!</p>]]></content><author><name>PyShine Team</name></author><category term="python" /><category term="turtle" /><category term="recursion" /><category term="graphics" /><category term="fractal" /><summary type="html"><![CDATA[Python Turtle Graphics Tutorial to quickly draw a Tree]]></summary></entry><entry><title type="html">Run C++ Code from Python – Step-by-Step Guide</title><link href="https://www.pyshine.com/Run-C++-in-Python/" rel="alternate" type="text/html" title="Run C++ Code from Python – Step-by-Step Guide" /><published>2025-11-03T00:00:00+00:00</published><updated>2025-11-03T00:00:00+00:00</updated><id>https://www.pyshine.com/Run-C++-in-Python</id><content type="html" xml:base="https://www.pyshine.com/Run-C++-in-Python/"><![CDATA[<h1 id="run-c-code-from-python--step-by-step-guide">Run C++ Code from Python – Step-by-Step Guide</h1>

<h2 id="-beginner-friendly-tutorial--learn-how-python-can-compile-and-execute-c-code"># Beginner-Friendly Tutorial – Learn How Python Can Compile and Execute C++ Code</h2>

<p>Python is an incredibly versatile language, but sometimes you might need the speed and performance of C++. This tutorial explains how to <strong>run C++ code directly from Python</strong>, making it easy to integrate both languages. You’ll learn how to write, compile, and execute a temporary C++ program from a Python script using the <strong><code class="language-plaintext highlighter-rouge">subprocess</code></strong> and <strong><code class="language-plaintext highlighter-rouge">tempfile</code></strong> modules. This is a great way to understand cross-language execution and automation using Python!</p>

<h2 id="-table-of-contents"># Table of Contents</h2>
<ul>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#why-run-c-from-python">Why Run C++ from Python?</a></li>
  <li><a href="#step-1-writing-c-code-in-python">Step 1: Writing C++ Code in Python</a></li>
  <li><a href="#step-2-compiling-c-code">Step 2: Compiling C++ Code</a></li>
  <li><a href="#step-3-executing-the-compiled-program">Step 3: Executing the Compiled Program</a></li>
  <li><a href="#step-4-cleaning-up-temporary-files">Step 4: Cleaning Up Temporary Files</a></li>
  <li><a href="#complete-code">Complete Code</a></li>
  <li><a href="#how-it-works">How It Works</a></li>
  <li><a href="#key-learnings">Key Learnings</a></li>
  <li><a href="#further-experiments">Further Experiments</a></li>
</ul>

<h2 id="-overview"># Overview</h2>

<p>This project shows how Python can act as a <strong>controller for compiling and executing C++ code</strong>. The program:</p>

<ol>
  <li>Writes a simple <strong>C++ Hello World</strong> program to a temporary file.</li>
  <li>Uses <strong><code class="language-plaintext highlighter-rouge">subprocess.run()</code></strong> to compile it using the <strong>g++ compiler</strong>.</li>
  <li>Executes the compiled program and displays the C++ output inside Python.</li>
  <li>Cleans up all temporary files automatically.</li>
</ol>

<h2 id="-why-run-c-from-python"># Why Run C++ from Python?</h2>

<ul>
  <li>Combine <strong>Python’s flexibility</strong> with <strong>C++’s performance</strong>.</li>
  <li>Automate <strong>testing of C++ code</strong> or <strong>generate code dynamically</strong>.</li>
  <li>Build hybrid systems where Python handles logic and C++ handles computation-heavy tasks.</li>
</ul>

<h2 id="-step-1-writing-c-code-in-python"># Step 1: Writing C++ Code in Python</h2>

<p>The script starts with a simple Python print, followed by defining C++ code as a multi-line string.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">subprocess</span>  <span class="c1"># To run external programs
</span><span class="kn">import</span> <span class="nn">tempfile</span>    <span class="c1"># To create temporary files for C++ code
</span><span class="kn">import</span> <span class="nn">os</span>          <span class="c1"># To handle file operations
</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Hello World from Python!"</span><span class="p">)</span>  <span class="c1"># Simple Python print
</span>
<span class="n">cpp_code</span> <span class="o">=</span> <span class="s">"""
## # include &lt;iostream&gt;
using namespace std;

int main() {
    cout &lt;&lt; "Hello World from C++!" &lt;&lt; endl;
    return 0;
}
"""</span>
</code></pre></div></div>

<p>Here, the <strong>C++ code is stored as a string</strong> that will later be written to a temporary file.</p>

<hr />

<h2 id="-setting-up-g-on-your-system"># Setting Up <code class="language-plaintext highlighter-rouge">g++</code> on Your System</h2>

<p>You need a working C++ compiler (<code class="language-plaintext highlighter-rouge">g++</code>) to run this tutorial. Follow the steps below depending on your OS.</p>

<h2 id="-windows"># Windows</h2>
<ol>
  <li>Install <strong>MinGW-w64</strong> (Minimalist GNU for Windows):
    <ul>
      <li>Visit: <a href="https://winlibs.com/">https://winlibs.com/</a> or <a href="https://sourceforge.net/projects/mingw-w64/">https://sourceforge.net/projects/mingw-w64/</a></li>
      <li>Download and install it.</li>
    </ul>
  </li>
  <li>Add the <strong><code class="language-plaintext highlighter-rouge">bin</code> directory</strong> (e.g., <code class="language-plaintext highlighter-rouge">C:\mingw64\bin</code>) to your <strong>PATH environment variable</strong>.</li>
  <li>Open Command Prompt and type:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>g++ <span class="nt">--version</span>
</code></pre></div>    </div>
    <p>If it prints version info, you’re ready to go!</p>
  </li>
</ol>

<h2 id="-macos"># macOS</h2>
<ol>
  <li>Install <strong>Xcode Command Line Tools</strong> by running:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>xcode-select <span class="nt">--install</span>
</code></pre></div>    </div>
  </li>
  <li>Verify installation with:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>g++ <span class="nt">--version</span>
</code></pre></div>    </div>
    <p>You should see Apple’s <code class="language-plaintext highlighter-rouge">clang</code> compiler, which works for this tutorial.</p>
  </li>
</ol>

<h2 id="-linux-ubuntudebian"># Linux (Ubuntu/Debian)</h2>
<ol>
  <li>Open Terminal and install <code class="language-plaintext highlighter-rouge">g++</code>:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt update
<span class="nb">sudo </span>apt <span class="nb">install </span>g++
</code></pre></div>    </div>
  </li>
  <li>Verify installation:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>g++ <span class="nt">--version</span>
</code></pre></div>    </div>
    <hr />
  </li>
</ol>

<h2 id="-step-2-compiling-c-code"># Step 2: Compiling C++ Code</h2>

<p>We create a temporary <code class="language-plaintext highlighter-rouge">.cpp</code> file and compile it using the <strong>g++ compiler</strong>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="n">tempfile</span><span class="p">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s">".cpp"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">cpp_file</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">name</span>
    <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">cpp_code</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>

<span class="n">exe_file</span> <span class="o">=</span> <span class="n">cpp_file</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">".cpp"</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>

<span class="n">compile_proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span>
    <span class="p">[</span><span class="s">"g++"</span><span class="p">,</span> <span class="n">cpp_file</span><span class="p">,</span> <span class="s">"-o"</span><span class="p">,</span> <span class="n">exe_file</span><span class="p">],</span>
    <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">text</span><span class="o">=</span><span class="bp">True</span>
<span class="p">)</span>
</code></pre></div></div>

<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">tempfile.NamedTemporaryFile()</code></strong> creates a unique <code class="language-plaintext highlighter-rouge">.cpp</code> file in the system’s temporary directory.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">subprocess.run()</code></strong> executes the g++ compiler to compile the file into an executable.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">capture_output=True</code></strong> captures any compilation messages.</li>
</ul>

<h2 id="-step-3-executing-the-compiled-program"># Step 3: Executing the Compiled Program</h2>

<p>After successful compilation, Python runs the compiled C++ binary.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">compile_proc</span><span class="p">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"C++ compilation failed!"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">compile_proc</span><span class="p">.</span><span class="n">stderr</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">([</span><span class="n">exe_file</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Output from C++:"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">strip</span><span class="p">())</span>
</code></pre></div></div>

<p>If compilation fails, Python displays the compiler error messages. If it succeeds, it prints the <strong>C++ program output</strong>.</p>

<h2 id="-example-output"># Example Output:</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hello World from Python!
Output from C++:
Hello World from C++!
</code></pre></div></div>

<h2 id="-step-4-cleaning-up-temporary-files"># Step 4: Cleaning Up Temporary Files</h2>

<p>Finally, we remove temporary files created during compilation.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">cpp_file</span><span class="p">)</span>
<span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">exe_file</span><span class="p">):</span>
    <span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">exe_file</span><span class="p">)</span>
</code></pre></div></div>

<p>This ensures no leftover files clutter your system.</p>

<h2 id="-complete-code"># Complete Code</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Hello World from Python!"</span><span class="p">)</span>

<span class="n">cpp_code</span> <span class="o">=</span> <span class="s">"""
## # include &lt;iostream&gt;
using namespace std;

int main() {
    cout &lt;&lt; "Hello World from C++!" &lt;&lt; endl;
    return 0;
}
"""</span>

<span class="k">with</span> <span class="n">tempfile</span><span class="p">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s">".cpp"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">cpp_file</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">name</span>
    <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">cpp_code</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>

<span class="n">exe_file</span> <span class="o">=</span> <span class="n">cpp_file</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">".cpp"</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>

<span class="n">compile_proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">([</span><span class="s">"g++"</span><span class="p">,</span> <span class="n">cpp_file</span><span class="p">,</span> <span class="s">"-o"</span><span class="p">,</span> <span class="n">exe_file</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">if</span> <span class="n">compile_proc</span><span class="p">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"C++ compilation failed!"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">compile_proc</span><span class="p">.</span><span class="n">stderr</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">([</span><span class="n">exe_file</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Output from C++:"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">strip</span><span class="p">())</span>

<span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">cpp_file</span><span class="p">)</span>
<span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">exe_file</span><span class="p">):</span>
    <span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">exe_file</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="-how-it-works"># How It Works</h2>

<ol>
  <li><strong>Python writes C++ code</strong> to a temporary file.</li>
  <li><strong>g++ compiles</strong> the code into an executable.</li>
  <li><strong>Python runs the executable</strong> and prints its output.</li>
  <li><strong>Cleanup</strong> removes temporary files for a tidy finish.</li>
</ol>

<h2 id="-key-learnings"># Key Learnings</h2>

<ul>
  <li>Use <strong><code class="language-plaintext highlighter-rouge">subprocess.run()</code></strong> to execute system commands from Python.</li>
  <li>Create <strong>temporary files</strong> using <code class="language-plaintext highlighter-rouge">tempfile</code> safely.</li>
  <li>Capture <strong>compiler output and program results</strong>.</li>
  <li>Integrate Python and C++ seamlessly for automation or hybrid projects.</li>
</ul>

<h2 id="-further-experiments"># Further Experiments</h2>

<ul>
  <li>Modify the C++ code dynamically (e.g., generate code from user input).</li>
  <li>Run multiple C++ snippets from one Python script.</li>
  <li>Measure <strong>execution time differences</strong> between Python and C++.</li>
  <li>Use <strong>Python to benchmark or visualize C++ results</strong>.</li>
</ul>

<hr />

<p>With this simple integration, you’ve built a <strong>bridge between Python and C++</strong>, unlocking a world of hybrid programming possibilities. You can extend this example to dynamically generate more complex C++ programs, compile them on the fly, and benchmark their performance using Python scripts.</p>]]></content><author><name>PyShine Team</name></author><category term="python" /><category term="cpp" /><category term="automation" /><category term="interoperability" /><category term="tutorial" /><summary type="html"><![CDATA[Learn how to compile and execute C++ code directly from Python using subprocess and tempfile modules.]]></summary></entry></feed>