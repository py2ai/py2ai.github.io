<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Fingerprint Helper</title><meta name="viewport" content="width=device-width,initial-scale=1.0"><style>body{margin:0;background:#0e0e0e;font-family:system-ui;color:#eaeaea}header{padding:14px 16px;border-bottom:1px solid #333;background:#121212}header h1{font-size:16px;margin:0 0 6px}header p{font-size:12px;color:#bbb;margin:0}.container{display:flex;flex-direction:column;height:calc(100vh - 96px);padding:10px;gap:10px}.box{flex:1;position:relative;border:2px solid #2a2a2a;border-radius:10px;background:#000;overflow:hidden}.box-title{position:absolute;top:6px;left:8px;font-size:11px;background:rgba(0,0,0,.6);padding:3px 6px;border-radius:6px;z-index:5}video,canvas{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}.controls{position:fixed;bottom:14px;left:50%;transform:translateX(-50%)}button{background:#1f1f1f;color:#fff;border:1px solid #333;border-radius:8px;padding:10px 16px}</style></head><body><header><h1>Fingerprint Light & Camera Position Helper</h1><p>Adjust lighting and camera until fingerprints appear clearly.</p></header><div class="container"><div class="box"><div class="box-title">Live Camera</div><video id="v" autoplay playsinline></video><canvas id="m"></canvas></div><div class="box"><div class="box-title">Detected Fingerprints</div><canvas id="b"></canvas></div></div><div class="controls"><button id="t">Turn Torch OFF</button></div><script>(function(){try{if(location.protocol!=="https:"||location.hostname!=="www.pyshine.com"||!location.pathname.startsWith("/finger")){document.body.innerHTML="";document.body.style.background="#000";throw 0}}catch(e){return}})();(()=>{const _=i=>document.getElementById(i),V=_("v"),M=_("m"),B=_("b"),T=_("t"),CM=M.getContext("2d"),CB=B.getContext("2d");let TR=null,ON=true;navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}}}).then(s=>{V.srcObject=s;TR=s.getVideoTracks()[0];try{TR.applyConstraints({advanced:[{torch:true}]})}catch(e){}});T.onclick=()=>{ON=!ON;try{TR.applyConstraints({advanced:[{torch:ON}]});T.textContent=ON?"Turn Torch OFF":"Turn Torch ON"}catch(e){}};V.onloadedmetadata=()=>{M.width=B.width=V.videoWidth;M.height=B.height=V.videoHeight};function R(){const w=M.width,h=M.height,rw=w*.75,rh=h*.5,x=(w-rw)/2,y=h*.22;CM.clearRect(0,0,w,h);CM.fillStyle="rgba(0,0,0,.78)";CM.fillRect(0,0,w,h);CM.globalCompositeOperation="destination-out";CM.fillRect(x,y,rw,rh);CM.globalCompositeOperation="source-over";CM.strokeStyle="rgba(255,255,255,.35)";CM.lineWidth=2;CM.strokeRect(x,y,rw,rh);return{x,y,w:rw,h:rh}}function CLAHE(g,w,h){const ts=32,cl=40,out=new Uint8Array(g.length);for(let ty=0;ty<h;ty+=ts)for(let tx=0;tx<w;tx+=ts){let hist=new Uint16Array(256),px=[];for(let y=ty;y<Math.min(ty+ts,h);y++)for(let x=tx;x<Math.min(tx+ts,w);x++){const i=y*w+x;hist[g[i]]++;px.push(i)}let excess=0;for(let i=0;i<256;i++)if(hist[i]>cl){excess+=hist[i]-cl;hist[i]=cl}const red=excess/256;for(let i=0;i<256;i++)hist[i]+=red;let cdf=new Uint16Array(256);cdf[0]=hist[0];for(let i=1;i<256;i++)cdf[i]=cdf[i-1]+hist[i];const scale=255/cdf[255];for(const i of px)out[i]=cdf[g[i]]*scale}return out}(function L(){if(!B.width)return requestAnimationFrame(L);const r=R();CB.drawImage(V,r.x,r.y,r.w,r.h,r.x,r.y,r.w,r.h);const I=CB.getImageData(r.x,r.y,r.w,r.h),D=I.data,G=new Uint8Array(r.w*r.h);let S=0;for(let i=0,j=0;i<D.length;i+=4,j++){let g=.299*D[i]+.587*D[i+1]+.114*D[i+2];g=Math.min(255,Math.max(0,g));G[j]=g;S+=g}const H=CLAHE(G,r.w,r.h);const A=S/G.length;for(let i=0,j=0;i<D.length;i+=4,j++){const f=H[j]>A*.6&&H[j]<A*1.2,v=f?(H[j]<A?0:255):0;D[i]=D[i+1]=D[i+2]=v}CB.putImageData(I,r.x,r.y);requestAnimationFrame(L)})()})();</script></body></html>
