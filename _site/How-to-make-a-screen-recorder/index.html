

  <!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/Article">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Pinterest & Google verification -->
  <meta name="p:domain_verify" content="fb68a8459fe32b8b072bcd5cc620d125"/>
  <meta name="google-site-verification" content="WAkFPi5cvufClnQetgIl0STmvvwHhVf8jfyENFWhsxU" />
  <meta name="google-site-verification" content="g2pFZlv-92XQD67BPgiVHsvZ4TZH13Ucvmmvvv36kU4" />

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>How to make screen recorder in PyQt5 | PyShine</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="How to make screen recorder in PyQt5" />
<meta name="author" content="PyShine Team" />
<meta property="og:locale" content="en" />
<meta name="description" content="Making of an audio and video screen recorder in Python" />
<meta property="og:description" content="Making of an audio and video screen recorder in Python" />
<link rel="canonical" href="http://localhost:4000/How-to-make-a-screen-recorder/" />
<meta property="og:url" content="http://localhost:4000/How-to-make-a-screen-recorder/" />
<meta property="og:site_name" content="PyShine" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-01T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="How to make screen recorder in PyQt5" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"PyShine Team"},"dateModified":"2020-04-01T00:00:00+08:00","datePublished":"2020-04-01T00:00:00+08:00","description":"Making of an audio and video screen recorder in Python","headline":"How to make screen recorder in PyQt5","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/How-to-make-a-screen-recorder/"},"name":"{{ page.title escape }}","url":"http://localhost:4000/How-to-make-a-screen-recorder/"}</script>
<!-- End Jekyll SEO tag -->
  <!-- This will generate the canonical link automatically -->

  <script src="https://analytics.ahrefs.com/analytics.js" data-key="Im0K82YsmEDy08+6wyUIZA" async></script>

  <!-- Favicon & App Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png?v=qA3OXqyw77">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png?v=qA3OXqyw77">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png?v=qA3OXqyw77">
  <link rel="manifest" href="/assets/img/icons/manifest.json?v=qA3OXqyw77">
  <link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg?v=qA3OXqyw77" color="#5bbad5">
  <link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77">
  <!--[if IE]><link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77"><![endif]-->

  <!-- App & Theme Info -->
  <meta name="apple-mobile-web-app-title" content="Sleek">
  <meta name="application-name" content="Sleek">
  <meta name="msapplication-config" content="/assets/img/icons/browserconfig.xml?v=qA3OXqyw77">
  <meta name="theme-color" content="#ffffff">

  
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-TCVFBKF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'GTM-TCVFBKF');
</script>

  

  <!-- Critical CSS Inline -->
  <style class="inlineCSS">
    h1{color:#313237;margin-top:0;margin-bottom:.5rem}.dark-bg{background-color:#19d319}@media (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:last-of-type,.post-card:nth-child(2n+2){margin-right:0}}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figure,main{display:block}figure{margin:1em 40px}a{background-color:transparent;-webkit-text-decoration-skip:objects}img{border-style:none}svg:not(:root){overflow:hidden}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}body{-webkit-overflow-scrolling:touch}*,::after,::before{-webkit-box-sizing:inherit;box-sizing:inherit}.site{display:-webkit-box;display:-ms-flexbox;display:flex;min-height:100vh;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.site__content{-webkit-box-flex:1;-ms-flex:1;flex:1}img{max-width:100%;height:auto;width:auto;vertical-align:middle}figure{margin:0}body{background-color:#fff;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Hiragino Sans GB","Microsoft YaHei","WenQuanYi Micro Hei",sans-serif;font-size:1rem;line-height:1.5;color:#343851;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%}p{margin-top:0;margin-bottom:1.25rem}h1,h2{color:#313237;margin-top:0;margin-bottom:.5rem}a{color:#277cea;text-decoration:none;border-bottom:1px dashed #277cea}.blur{background:#fff;filter:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg"><filter id="filter"><feGaussianBlur stdDeviation="16" /></filter></svg>#filter');-webkit-filter:blur(1rem);filter:blur(1rem)}.container{padding:0 20px}@media (min-width:0){.container{max-width:auto;margin:0 auto}}@media (min-width:36em){.container{max-width:540px;margin:0 auto}}@media (min-width:48em){.container{max-width:720px;margin:0 auto}}@media (min-width:62em){.container{max-width:960px;margin:0 auto}}@media (min-width:75em){.container{max-width:1170px;margin:0 auto}}.header{background-color:#fff;color:#343851;position:absolute;z-index:4;width:100%;top:0;left:0;will-change:transform;-webkit-transform:translateY(0);transform:translateY(0)}.header a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:0}.header__logo{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;overflow:hidden;padding:19px 0;margin-right:1.25rem;outline:0;border-bottom:0;color:#313237}.header__logo .header__logo--container{width:58px}.header__logo .header__logo--container .logo{fill:currentColor}.header__inner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:3.75em;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.header__links{padding-bottom:.5rem;display:none;position:absolute;top:3.75em;left:0;width:100%;height:auto;background:#fff}.header__link{color:#343851;padding:.938rem 0;border-top:1px solid #ededed}.header__toggle{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px;height:100%;background-color:transparent;padding-left:1.25rem}.header__toggle span{display:block;position:relative;margin-top:4px;background-color:#343851;width:100%;height:2px;border-radius:1px}.header__toggle span:first-child{margin-top:0}@media (min-width:62em){.header__toggle{display:none;visibility:hidden}.header__links{position:static;padding:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;visibility:visible;width:auto;height:100%}.header__links-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;padding:0}.header__link{position:relative;padding:.938rem 1rem;border:0;height:100%}.header__link::after{content:"";display:block;position:absolute;left:0;bottom:0;height:3px;width:100%;-webkit-transform:scaleX(0);transform:scaleX(0);background:#277cea}}.post-card{display:block;position:relative;width:100%;min-height:250px;border-radius:4px;overflow:hidden;background-color:#fff;-webkit-box-shadow:0 1px 3px rgba(0,0,0,.08);box-shadow:0 1px 3px rgba(0,0,0,.08);margin-bottom:2.25rem;border-bottom:0}@media (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:0}}@media (min-width:75em){.post-card{width:31.25%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:3.125%}}.post-card__label{position:absolute;top:1.5rem;left:1.5rem;z-index:2}.post-card__thumb{margin:0;background:#fff;position:relative;overflow:hidden}.post-card__thumb::after{content:"";display:block;height:0;width:100%;padding-bottom:56.25%}.post-card__thumb>*{position:absolute;top:0;left:0;width:100%;height:100%;display:block}.post-card__inner{padding:1.875rem 1.25rem .625rem;color:#838c8d}.post-card__header{margin-bottom:.75rem}.post-card__header .post-card__meta{font-size:.875rem}.label{padding:0 10px;margin-bottom:1rem;display:inline-block;line-height:20px;font-size:.75rem;text-transform:uppercase;letter-spacing:1px;color:rgba(255,255,255,.8);border:2px solid rgba(255,255,255,.5);border-radius:100px}.hero{margin:3.75rem auto 0;min-height:16.25rem;width:100%;position:relative;background-color:#dde5ea;background-repeat:no-repeat;background-position:50%;background-size:cover}@media (min-width:62em){.hero{margin:0 auto;height:36em}}.hero::before{position:absolute;display:block;content:"";top:0;left:0;width:100%;height:100%;background:rgba(52,56,81,.8)}.hero__wrap{position:absolute;margin:auto;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);text-align:center;color:rgba(255,255,255,.8);width:100%;max-width:90%;z-index:1}.hero__wrap .hero__title{font-size:1.8em;color:#fff}.blog{background-color:#f9f9f9}.post-list{padding-top:2.5em;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}@media (min-width:48em){.hero__wrap{max-width:40em}.hero__wrap .hero__title{padding:1rem 0;font-size:2.625em;line-height:3.125rem}.post-list{padding-top:5em}}
  </style>

  <!-- Main CSS -->
  <link rel="preload" href="/assets/css/main.css" as="style" onload="this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/assets/css/main.css"></noscript>

  <script type="text/javascript">
    /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
(function(w){"use strict";if(!w.loadCSS){w.loadCSS=function(){}}
var rp=loadCSS.relpreload={};rp.support=(function(){var ret;try{ret=w.document.createElement("link").relList.supports("preload")}catch(e){ret=!1}
return function(){return ret}})();rp.bindMediaToggle=function(link){var finalMedia=link.media||"all";function enableStylesheet(){link.media=finalMedia}
if(link.addEventListener){link.addEventListener("load",enableStylesheet)}else if(link.attachEvent){link.attachEvent("onload",enableStylesheet)}
setTimeout(function(){link.rel="stylesheet";link.media="only x"});setTimeout(enableStylesheet,3000)};rp.poly=function(){if(rp.support()){return}
var links=w.document.getElementsByTagName("link");for(var i=0;i<links.length;i++){var link=links[i];if(link.rel==="preload"&&link.getAttribute("as")==="style"&&!link.getAttribute("data-loadcss")){link.setAttribute("data-loadcss",!0);rp.bindMediaToggle(link)}}};if(!rp.support()){rp.poly();var run=w.setInterval(rp.poly,500);if(w.addEventListener){w.addEventListener("load",function(){rp.poly();w.clearInterval(run)})}else if(w.attachEvent){w.attachEvent("onload",function(){rp.poly();w.clearInterval(run)})}}
if(typeof exports!=="undefined"){exports.loadCSS=loadCSS}
else{w.loadCSS=loadCSS}}(typeof global!=="undefined"?global:this))

  </script>

  <!-- MathJax -->
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>


  <body class="site" itemscope itemtype="https://schema.org/WebPage">

    
      <!-- Google Tag Manager (noscript) -->
      <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TCVFBKF"
                height="0" width="0" style="display:none;visibility:hidden"></iframe>
      </noscript>
      <!-- End Google Tag Manager -->
    

    <header class="header" itemscope itemtype="http://schema.org/SiteNavigationElement" aria-label="Main navigation">
  <div class="container">
    <div class="header__inner">

      <!-- Logo -->
      <a class="header__logo" href="/">
        <div class="header__logo--container">
          <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
<g>
	<path d="M18.121,9.88l-7.832-7.836c-0.155-0.158-0.428-0.155-0.584,0L1.842,9.913c-0.262,0.263-0.073,0.705,0.292,0.705h2.069v7.042c0,0.227,0.187,0.414,0.414,0.414h3.725c0.228,0,0.414-0.188,0.414-0.414v-3.313h2.483v3.313c0,0.227,0.187,0.414,0.413,0.414h3.726c0.229,0,0.414-0.188,0.414-0.414v-7.042h2.068h0.004C18.331,10.617,18.389,10.146,18.121,9.88 M14.963,17.245h-2.896v-3.313c0-0.229-0.186-0.415-0.414-0.415H8.342c-0.228,0-0.414,0.187-0.414,0.415v3.313H5.032v-6.628h9.931V17.245z M3.133,9.79l6.864-6.868l6.867,6.868H3.133z"></path>

	
	
</g>
</svg>

        </div>
      </a>

      <!-- Navigation -->
      <nav class="header__links">
        <div class="container header__links-wrapper">

          
            
              <a class="header__link" href="/">
                Home
              </a>
            
          
            
              <a class="header__link" href="/categories">
                Posts
              </a>
            
          
            

            <!-- Applications Dropdown -->
            <div class="header__dropdown">
              <span class="header__link header__dropdown-toggle">
                Applications
                <span class="dropdown-arrow">‚ñæ</span>
              </span>

              <div class="header__dropdown-menu">
                
                  <a class="header__dropdown-item"
                     href="/photo">
                    Online Passport Photo 20KB
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/finger.html">
                    Online Fingers Scanner
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/avatars">
                    Online Make Avatars
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/kanban/debounce.html">
                    Online Reminder App
                  </a>
                
                  <a class="header__dropdown-item"
                     href="/converter.html">
                    Online PNG Converter
                  </a>
                
              </div>
            </div>

            
          
            
              <a class="header__link" href="/about">
                About
              </a>
            
          
            
              <a class="header__link" href="/contact">
                Contact
              </a>
            
          
            
              <a class="header__link" href="/privacy">
                Privacy Policy
              </a>
            
          
            
              <a class="header__link" href="/disclaimer">
                Disclaimer
              </a>
            
          

        </div>
      </nav>

      <!-- Language Switcher -->
      

      <!-- Mobile Toggle -->
      <div class="header__toggle">
        <span></span><span></span><span></span>
      </div>

    </div>
  </div>

<style>
/* ===============================
   DESKTOP BASE
=============================== */
.header__links-wrapper{
  display:flex;
  align-items:center;
  gap:1.5rem;
}

.header__dropdown{
  position:relative;
}

.header__dropdown-toggle{
  display:inline-flex;
  align-items:center;
  gap:6px;
  cursor:pointer;
}

.dropdown-arrow{
  font-size:1em;
  transition:transform .2s ease;
}

.header__dropdown:hover .dropdown-arrow{
  transform:rotate(180deg);
}

/* ===============================
   DESKTOP DROPDOWN
=============================== */
.header__dropdown-menu{
  position:absolute;
  top:100%;
  left:0;
  min-width:220px;
  background:#121212;
  border:1px solid #333;
  border-radius:10px;
  padding:6px 0;
  display:none;
  z-index:9999;
}

.header__dropdown:hover .header__dropdown-menu{
  display:block;
}

.header__dropdown-item{
  display:block;
  padding:10px 16px;
  color:#eaeaea;
  text-decoration:none;
}

.header__dropdown-item:hover{
  background:#1f1f1f;
}

/* ===============================
   üî• MOBILE FIX (IMPORTANT)
=============================== */
@media (max-width:768px){

  .header__links-wrapper{
    flex-direction:column;
    align-items:stretch;
    gap:0;
  }

  .header__dropdown{
    width:100%;
  }

  .header__dropdown-toggle{
    width:100%;
    justify-content:space-between;
    padding:14px 16px;
  }

  /* submenu now STACKS downward */
  .header__dropdown-menu{
    position:static;
    display:none;
    background:#0f0f0f;
    border:none;
    border-radius:0;
    padding:0;
    margin:0;
  }

  /* show submenu when tapping Applications */
  .header__dropdown:hover .header__dropdown-menu{
    display:block;
  }

  .header__dropdown-item{
    padding:14px 20px;
    background:#1a1a1a;
    border-top:1px solid #2a2a2a;
    font-size:15px;
  }

  .header__dropdown-item:hover{
    background:#222;
  }

  .dropdown-arrow{
    font-size:1em;
  }
}

/* ===============================
   LANGUAGE SWITCHER
=============================== */
.header__lang-switcher{
  display:inline-flex;
  gap:.5rem;
  align-items:center;
  font-size:1.3rem;
  margin-left:1rem;
}
.lang-flag.active{ text-decoration:underline }
.lang-flag.disabled{ opacity:.5; filter:grayscale(100%) }
</style>

</header>


    
      <div class="hero lazyload"
           data-bg="http://localhost:4000/assets/img/posts/screen.jpg"
           role="img"
           aria-label="How to make screen recorder in PyQt5">
    
        <div class="hero__wrap">

          
            <div class="hero__categories">
              
                <a class="label"
                   href="/categories/#GUI tutorial series"
                   aria-label="Category: GUI tutorial series">
                   GUI tutorial series
                </a>
                
              
            </div>
          

          <h1 class="hero__title" itemprop="headline">How to make screen recorder in PyQt5</h1>

          <p class="hero__meta">
            <time datetime="2020-04-01T00:00:00+08:00" itemprop="datePublished">
              01 Apr 2020
            </time>
            &nbsp;¬∑&nbsp;
            
            <span itemprop="timeRequired">
              
                14 mins read
              
            </span>
          </p>
        </div>
      </div>

    <main class="site__content" role="main">
      <div class="container post-layout">

        <!-- SIDEBAR TOC -->
        <aside class="post-toc" id="post-toc">
          <h3 class="no-toc">Contents</h3>
          <nav id="toc-list"></nav>
        </aside>

        <!-- MAIN CONTENT -->
        <article class="post-content"
                 itemprop="articleBody"
                 itemscope itemtype="https://schema.org/Article">

          <!-- INLINE TOC -->
          <div id="inline-toc" class="inline-toc-box">
            <h3 class="no-toc">Contents</h3>
            <nav id="inline-toc-list"></nav>
          </div>

          <p>Alright friends welcome back, lets make a very flexible screen recorder today. The target platform for this GUI is Windows 10. For direct installation to windows 10, please download these three parts in a folder and then extract (using winRAR) the PyShine Recorder setup.zip file:</p>

<ol>
  <li>
    <p><a href="https://drive.google.com/file/d/1ZD4X0kB4qdx8q9jJ1Y_7ROwp83oBR6ko/view?usp=sharing">PyShine Recorder setup.zip</a></p>
  </li>
  <li>
    <p><a href="https://drive.google.com/file/d/1JoXwLJa6E8hWCWhBTZTL4mOTeeK22xju/view?usp=sharing">PyShine Recorder setup.z02</a></p>
  </li>
  <li>
    <p><a href="https://drive.google.com/file/d/1n9tbv8nymdBFc_qQtbcWkJRszsllwBCZ/view?usp=sharing">PyShine Recorder setup.z01</a></p>
  </li>
</ol>

<p><a href="https://youtu.be/jLzLNRK72KI" title="Everything Is AWESOME"><img src="https://github.com/py2ai/py2ai.github.io/blob/master/assets/img/posts/scren.png?raw=true" alt="Everything Is AWESOME" /></a></p>

<h1 id="important">IMPORTANT</h1>

<p>Please run the code below only from PowerShell and not use any IDE, such as PyCharm or others, because it will not work in them properly.
Copy the code below in a Python file as main.py and save it to a location. Then go to that location open up the Windows PowerShell as Shift+ Right click 
‚Äúopen PowerShell window here‚Äù then run it as:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 main.py
</code></pre></div></div>

<h2 id="mainpy">main.py</h2>
<style>
  .copy-code-button {
	box-shadow:inset 0px 1px 0px 0px #bbdaf7;
	background:linear-gradient(to bottom, #79bbff 5%, #378de5 100%);
	background-color:#79bbff;
	border-radius:6px;
	border:1px solid #84bbf3;
	display:inline-block;
	cursor:pointer;
	color:#ffffff;
	font-family:Arial;
	font-size:15px;
	font-weight:bold;
	padding:6px 24px;
	text-decoration:none;
	text-shadow:0px 1px 0px #528ecc;
}
.copy-code-button:hover {
	background:linear-gradient(to bottom, #378de5 5%, #79bbff 100%);
	background-color:#378de5;
}
.copy-code-button:active {
	position:relative;
	top:1px;
}
</style>

<div class="code-header">
  <button class="copy-code-button">
    Copy code to clipboard
  </button>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="s">"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
## Subscribe to pyshine youtube channel for more learning videos.
## Its an Audio Video Screen Recoder in Python 3.
## -*- coding: utf-8 -*-
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""</span> 

<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span> <span class="c1"># pip install pyqt5
</span><span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QFileDialog</span>
<span class="kn">import</span> <span class="nn">os</span> 
<span class="kn">import</span> <span class="nn">pyautogui</span> <span class="c1"># pip install pyautogui
</span><span class="kn">import</span> <span class="nn">cv2</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span> 
<span class="kn">import</span> <span class="nn">pygetwindow</span> <span class="k">as</span> <span class="n">gw</span>
<span class="kn">import</span> <span class="nn">_thread</span>
<span class="kn">import</span> <span class="nn">imutils</span>			
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">signal</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span> 
<span class="kn">import</span> <span class="nn">shlex</span>
<span class="kn">import</span> <span class="nn">psutil</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">Popen</span>
<span class="kn">from</span> <span class="nn">dateutil.relativedelta</span> <span class="kn">import</span> <span class="n">relativedelta</span>  <span class="c1"># Install it via: pip install python-dateutil
</span><span class="k">try</span><span class="p">:</span> 
	<span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="s">"output_video.mp4"</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
	<span class="k">pass</span>

<span class="n">drawing</span> <span class="o">=</span> <span class="bp">False</span>
<span class="k">global</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">num</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">windowRegion</span>
<span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
<span class="n">windowRegion</span><span class="o">=</span><span class="mi">0</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>




<span class="k">class</span> <span class="nc">Ui_MainWindow</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MainWindow</span><span class="p">):</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">threadpool</span> <span class="o">=</span> <span class="n">QtCore</span><span class="p">.</span><span class="n">QThreadPool</span><span class="p">()</span>
		<span class="n">MainWindow</span><span class="p">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s">"MainWindow"</span><span class="p">)</span>
		
		
		
		<span class="n">sizeObject</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="p">.</span><span class="n">QDesktopWidget</span><span class="p">().</span><span class="n">screenGeometry</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
		

		<span class="n">H</span> <span class="o">=</span> <span class="p">(</span><span class="n">sizeObject</span><span class="p">.</span><span class="n">height</span><span class="p">())</span>
		<span class="n">W</span> <span class="o">=</span> <span class="p">(</span><span class="n">sizeObject</span><span class="p">.</span><span class="n">width</span><span class="p">())</span>
		
		<span class="bp">self</span><span class="p">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">W</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">H</span>
		<span class="n">MainWindow</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">W</span><span class="o">//</span><span class="mi">8</span><span class="p">,</span> <span class="n">H</span><span class="o">//</span><span class="mi">10</span><span class="p">)</span>
		<span class="n">MainWindow</span><span class="p">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="p">.</span><span class="n">QSize</span><span class="p">(</span><span class="n">W</span><span class="o">//</span><span class="mi">5</span><span class="p">,</span> <span class="n">H</span><span class="o">//</span><span class="mi">7</span><span class="p">))</span>
		<span class="n">MainWindow</span><span class="p">.</span><span class="n">setAcceptDrops</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">centralwidget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="p">.</span><span class="n">QWidget</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">centralwidget</span><span class="p">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s">"centralwidget"</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">gridLayout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="p">.</span><span class="n">QGridLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">centralwidget</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">gridLayout</span><span class="p">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s">"gridLayout"</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">comboBox</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="p">.</span><span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">centralwidget</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">comboBox</span><span class="p">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s">"comboBox"</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">comboBox</span><span class="p">.</span><span class="n">addItem</span><span class="p">(</span><span class="s">''</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">cmd</span> <span class="o">=</span> <span class="s">""</span>
		<span class="s">""" AUDIO and VIDIO DEVICES """</span>
		<span class="kn">from</span> <span class="nn">PyQt5.QtMultimedia</span> <span class="kn">import</span> <span class="n">QAudioDeviceInfo</span><span class="p">,</span><span class="n">QAudio</span><span class="p">,</span><span class="n">QCameraInfo</span>
<span class="c1">##	# List of Audio Input Devices
</span>		<span class="n">input_audio_deviceInfos</span> <span class="o">=</span> <span class="n">QAudioDeviceInfo</span><span class="p">.</span><span class="n">availableDevices</span><span class="p">(</span><span class="n">QAudio</span><span class="p">.</span><span class="n">AudioInput</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">input_audio_deviceInfos</span><span class="p">:</span>
			<span class="bp">self</span><span class="p">.</span><span class="n">comboBox</span><span class="p">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">device</span><span class="p">.</span><span class="n">deviceName</span><span class="p">())</span>
		<span class="s">""" ----------------------  """</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">comboBox</span><span class="p">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">Mic</span> <span class="o">=</span> <span class="n">input_audio_deviceInfos</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">deviceName</span><span class="p">()</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">gridLayout</span><span class="p">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">comboBox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">radioButton</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="p">.</span><span class="n">QRadioButton</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">centralwidget</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">radioButton</span><span class="p">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s">"radioButton"</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">gridLayout</span><span class="p">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">radioButton</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">pushButton</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="p">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">centralwidget</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">pushButton</span><span class="p">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">QtCore</span><span class="p">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">23</span><span class="p">))</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">pushButton</span><span class="p">.</span><span class="n">setIconSize</span><span class="p">(</span><span class="n">QtCore</span><span class="p">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">pushButton</span><span class="p">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s">"pushButton"</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">gridLayout</span><span class="p">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">pushButton</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">MainWindow</span><span class="p">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">centralwidget</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">statusbar</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="p">.</span><span class="n">QStatusBar</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">statusbar</span><span class="p">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s">"statusbar"</span><span class="p">)</span>
		<span class="n">MainWindow</span><span class="p">.</span><span class="n">setStatusBar</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">statusbar</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">actionNew</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="p">.</span><span class="n">QAction</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">actionNew</span><span class="p">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s">"actionNew"</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">retranslateUi</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">)</span>
		<span class="n">QtCore</span><span class="p">.</span><span class="n">QMetaObject</span><span class="p">.</span><span class="n">connectSlotsByName</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">clicked</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">pushButton</span><span class="p">.</span><span class="n">clicked</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">takeSnapNow</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">radioButton</span><span class="p">.</span><span class="n">toggled</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">setStatus</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">comboBox</span><span class="p">.</span><span class="n">currentIndexChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">].</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">setAudioDevice</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">th</span><span class="o">=</span><span class="p">{}</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">cap</span> <span class="o">=</span> <span class="s">""</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">useCam</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">st</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">arguments</span> <span class="o">=</span> <span class="s">''</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">process</span> <span class="o">=</span> <span class="bp">None</span>
		
	
	<span class="k">def</span> <span class="nf">setAudioDevice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">audioD</span><span class="p">):</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">Mic</span> <span class="o">=</span> <span class="n">audioD</span>
		
	<span class="k">def</span> <span class="nf">setStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">useCam</span> <span class="o">==</span><span class="bp">False</span><span class="p">:</span>
			<span class="bp">self</span><span class="p">.</span><span class="n">useCam</span> <span class="o">=</span> <span class="bp">True</span>	
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="p">.</span><span class="n">useCam</span> <span class="o">=</span> <span class="bp">False</span>
		
	<span class="k">def</span> <span class="nf">draw_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
		<span class="k">global</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">drawing</span><span class="p">,</span>  <span class="n">num</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span>
		<span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="n">cv2</span><span class="p">.</span><span class="n">EVENT_LBUTTONDOWN</span><span class="p">:</span>
			<span class="n">drawing</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
		<span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="n">cv2</span><span class="p">.</span><span class="n">EVENT_MOUSEMOVE</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
				<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
				<span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="n">b</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
					<span class="n">img</span> <span class="o">=</span> <span class="n">img2</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
				   
					<span class="n">cv2</span><span class="p">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">),(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="n">cv2</span><span class="p">.</span><span class="n">EVENT_LBUTTONUP</span><span class="p">:</span>
			<span class="n">drawing</span> <span class="o">=</span> <span class="bp">False</span>
			<span class="n">num</span> <span class="o">+=</span> <span class="mi">1</span>
			<span class="n">font</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span>
			<span class="n">x2</span> <span class="o">=</span> <span class="n">x</span>
			<span class="n">y2</span><span class="o">=</span> <span class="n">y</span>

	<span class="k">def</span> <span class="nf">takeSnap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">global</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">drawing</span><span class="p">,</span>  <span class="n">num</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">w</span>
		<span class="k">global</span> <span class="n">windowRegion</span>
		<span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">useCam</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
			<span class="n">key</span><span class="o">=</span><span class="nb">ord</span><span class="p">(</span><span class="s">'a'</span><span class="p">)</span>

			<span class="n">im1</span> <span class="o">=</span> <span class="n">pyautogui</span><span class="p">.</span><span class="n">screenshot</span><span class="p">()</span>
			<span class="n">im1</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="sa">r</span><span class="s">"monitor-1.png"</span><span class="p">)</span>
			
			<span class="n">img</span><span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">imread</span><span class="p">(</span><span class="s">'monitor-1.png'</span><span class="p">)</span> <span class="c1"># reading image
</span>			<span class="k">try</span><span class="p">:</span>
				<span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="s">'monitor-1.png'</span><span class="p">)</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="k">pass</span>
			<span class="n">cv2</span><span class="p">.</span><span class="n">putText</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="s">"Click and select the Region, Press w to confirm selection "</span><span class="p">,(</span><span class="bp">self</span><span class="p">.</span><span class="n">W</span><span class="o">//</span><span class="mi">8</span><span class="p">,</span><span class="bp">self</span><span class="p">.</span><span class="n">H</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span><span class="n">cv2</span><span class="p">.</span><span class="n">FONT_HERSHEY_TRIPLEX</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">LINE_AA</span><span class="p">)</span> 
			
			<span class="n">img2</span><span class="o">=</span><span class="n">img</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
			<span class="n">cv2</span><span class="p">.</span><span class="n">namedWindow</span><span class="p">(</span><span class="s">"main"</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">WINDOW_NORMAL</span><span class="p">)</span>	
			<span class="n">cv2</span><span class="p">.</span><span class="n">setMouseCallback</span><span class="p">(</span><span class="s">"main"</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">draw_rect</span><span class="p">)</span>
			<span class="n">cv2</span><span class="p">.</span><span class="n">setWindowProperty</span><span class="p">(</span><span class="s">"main"</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">WND_PROP_FULLSCREEN</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">WINDOW_FULLSCREEN</span><span class="p">);</span>

			<span class="k">while</span> <span class="n">key</span><span class="o">!=</span><span class="nb">ord</span><span class="p">(</span><span class="s">'w'</span><span class="p">):</span>
				<span class="n">cv2</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">"main"</span><span class="p">,</span><span class="n">img</span><span class="p">)</span>
				<span class="n">key</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFF</span> 
			<span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="o">=</span> <span class="p">((</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">),(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">))</span>
			<span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="nb">ord</span><span class="p">(</span><span class="s">'w'</span><span class="p">):</span>
				<span class="n">cv2</span><span class="p">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
				
		<span class="k">else</span><span class="p">:</span>
			<span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">W</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">H</span> <span class="p">)</span>
		<span class="k">if</span> <span class="n">w</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span>
			<span class="k">pass</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">+</span><span class="mi">1</span>
		<span class="k">if</span> <span class="n">h</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span>
			<span class="k">pass</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="o">+</span><span class="mi">1</span>
		<span class="n">windowRegion</span> <span class="o">=</span> <span class="p">(</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="p">)</span>
		<span class="k">return</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span>
	

	<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">inp</span><span class="p">,</span><span class="n">out</span><span class="p">):</span>
		<span class="k">global</span> <span class="n">windowRegion</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">st</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
		<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">while</span> <span class="p">(</span><span class="bp">True</span><span class="p">):</span>
			<span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">useCam</span> <span class="o">==</span><span class="bp">True</span><span class="p">:</span>
				
				<span class="n">windowRegion</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">W</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">H</span> <span class="p">)</span>
			<span class="n">frame</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">pyautogui</span><span class="p">.</span><span class="n">screenshot</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">windowRegion</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="s">"uint8"</span><span class="p">)</span>
			<span class="n">frame</span> <span class="o">=</span> <span class="n">imutils</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">480</span><span class="p">)</span>
			<span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
			<span class="n">cv2</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">"Preview"</span><span class="p">,</span><span class="n">frame</span><span class="p">)</span>
			<span class="n">rt</span> <span class="o">=</span> <span class="n">relativedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="bp">self</span><span class="p">.</span><span class="n">st</span><span class="p">)</span>
			<span class="n">st</span> <span class="o">=</span> <span class="p">(</span><span class="s">'{:02d}:{:02d}:{:02d}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rt</span><span class="p">.</span><span class="n">hours</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">rt</span><span class="p">.</span><span class="n">minutes</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">rt</span><span class="p">.</span><span class="n">seconds</span><span class="p">)))</span>
			<span class="bp">self</span><span class="p">.</span><span class="n">pushButton</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">'Stop Recording: '</span><span class="o">+</span><span class="n">st</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">cv2</span><span class="p">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">27</span><span class="p">:</span>
				<span class="n">w</span> <span class="o">=</span> <span class="n">gw</span><span class="p">.</span><span class="n">getWindowsWithTitle</span><span class="p">(</span><span class="s">'Windows PowerShell'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
				<span class="n">w</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
				<span class="n">cv2</span><span class="p">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
				<span class="k">break</span>
		
		
	
	<span class="k">def</span> <span class="nf">takeSnapNow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		
		<span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">clicked</span> <span class="o">==</span><span class="bp">False</span><span class="p">:</span>
			
			<span class="n">filename</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="p">.</span><span class="n">QFileDialog</span><span class="p">.</span><span class="n">getSaveFileName</span><span class="p">(</span> <span class="bp">self</span><span class="p">.</span><span class="n">centralwidget</span><span class="p">,</span><span class="s">"Save video to file"</span><span class="p">,</span> <span class="n">os</span><span class="p">.</span><span class="n">sep</span><span class="p">.</span><span class="n">join</span><span class="p">((</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s">'~'</span><span class="p">),</span> <span class="s">'Desktop'</span><span class="p">)),</span> <span class="s">"MP4(*.mp4);;AVI(*.avi);;MKV(*.mkv);;MOV(*.mov)"</span><span class="p">)</span> 
			
			<span class="k">while</span> <span class="n">filename</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">''</span><span class="p">:</span> 
				<span class="n">pyautogui</span><span class="p">.</span><span class="n">alert</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">'Please write a video name'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">'File name required'</span><span class="p">,</span> <span class="n">button</span><span class="o">=</span><span class="s">'OK'</span><span class="p">)</span>	
				<span class="n">filename</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="p">.</span><span class="n">QFileDialog</span><span class="p">.</span><span class="n">getSaveFileName</span><span class="p">(</span> <span class="bp">self</span><span class="p">.</span><span class="n">centralwidget</span><span class="p">,</span><span class="s">"Save video to file"</span><span class="p">,</span> <span class="n">os</span><span class="p">.</span><span class="n">sep</span><span class="p">.</span><span class="n">join</span><span class="p">((</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s">'~'</span><span class="p">),</span> <span class="s">'Desktop'</span><span class="p">)),</span> <span class="s">"MP4(*.mp4);;AVI(*.avi);;MKV(*.mkv);;MOV(*.mov)"</span><span class="p">)</span> 
			
			<span class="k">try</span><span class="p">:</span> 
				<span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="k">pass</span>
			
			<span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">takeSnap</span><span class="p">()</span>
			
<span class="c1">##		# self.cmd = r'"ffmpeg -rtbufsize 100M -f dshow -i audio="{}" -f -y -rtbufsize 100M -f gdigrab -framerate 30 -offset_x {} -offset_y {} -video_size {}x{} -draw_mouse 1 -i desktop -c:v libx264 -r 30 -preset ultrafast -tune zerolatency -crf 25 -pix_fmt yuv420p "{}"'.format(self.Mic,x1,y1,w,h,filename[0])
</span>			
			<span class="bp">self</span><span class="p">.</span><span class="n">cmd</span> <span class="o">=</span> <span class="s">"""ffmpeg -rtbufsize 1500M -f dshow -i audio="{}" -f -y -rtbufsize 1500M -f gdigrab -framerate ntsc -offset_x {} -offset_y {} -video_size {}x{} -draw_mouse 1 -i desktop -c:v libx264 -r 30 -preset ultrafast -tune zerolatency -crf 1 -pix_fmt yuv420p "{}" """</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">Mic</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">filename</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			
			
			
			<span class="bp">self</span><span class="p">.</span><span class="n">arguments</span> <span class="o">=</span> <span class="n">shlex</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">cmd</span><span class="p">)</span>
			
				
			<span class="bp">self</span><span class="p">.</span><span class="n">th</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">run</span><span class="p">,</span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
			<span class="bp">self</span><span class="p">.</span><span class="n">th</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">makeVideo</span><span class="p">,</span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
			<span class="bp">self</span><span class="p">.</span><span class="n">th</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">start</span><span class="p">()</span>
			<span class="bp">self</span><span class="p">.</span><span class="n">th</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">start</span><span class="p">()</span>
			<span class="bp">self</span><span class="p">.</span><span class="n">clicked</span> <span class="o">=</span><span class="bp">True</span>
			
			
			<span class="bp">self</span><span class="p">.</span><span class="n">pushButton</span><span class="p">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s">"Ctrl+r"</span><span class="p">)</span>
			<span class="bp">self</span><span class="p">.</span><span class="n">radioButton</span><span class="p">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="p">.</span><span class="n">pushButton</span><span class="p">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
			
			
			<span class="bp">self</span><span class="p">.</span><span class="n">pushButton</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">'Finalizing...'</span><span class="p">)</span>

			<span class="n">w</span> <span class="o">=</span> <span class="n">gw</span><span class="p">.</span><span class="n">getWindowsWithTitle</span><span class="p">(</span><span class="s">'Windows PowerShell'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">w</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

			<span class="bp">self</span><span class="p">.</span><span class="n">clicked</span> <span class="o">=</span><span class="bp">False</span>
			
	
		
		
	<span class="k">def</span> <span class="nf">makeVideo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">inp</span><span class="p">):</span>
		
		<span class="c1">#self.process = subprocess.Popen(self.arguments, shell=True) 
</span>		<span class="n">FNULL</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">devnull</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
		<span class="n">retcode</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">arguments</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">FNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">STDOUT</span><span class="p">)</span>
		
		
		
			
		
		
	<span class="k">def</span> <span class="nf">retranslateUi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MainWindow</span><span class="p">):</span>
		<span class="n">_translate</span> <span class="o">=</span> <span class="n">QtCore</span><span class="p">.</span><span class="n">QCoreApplication</span><span class="p">.</span><span class="n">translate</span>
		<span class="n">MainWindow</span><span class="p">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s">"MainWindow"</span><span class="p">,</span> <span class="s">"PyShine Video Recorder"</span><span class="p">))</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">comboBox</span><span class="p">.</span><span class="n">setItemText</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">_translate</span><span class="p">(</span><span class="s">"MainWindow"</span><span class="p">,</span> <span class="s">"Select Audio Device"</span><span class="p">))</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">radioButton</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s">"MainWindow"</span><span class="p">,</span> <span class="s">"Full Screen"</span><span class="p">))</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">pushButton</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s">"MainWindow"</span><span class="p">,</span> <span class="s">"Start Recording"</span><span class="p">))</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">pushButton</span><span class="p">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s">"MainWindow"</span><span class="p">,</span> <span class="s">"Ctrl+r"</span><span class="p">))</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">actionNew</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s">"MainWindow"</span><span class="p">,</span> <span class="s">"New"</span><span class="p">))</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="p">.</span><span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">MainWindow</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="p">.</span><span class="n">QMainWindow</span><span class="p">()</span>
    <span class="n">ui</span> <span class="o">=</span> <span class="n">Ui_MainWindow</span><span class="p">()</span>
    <span class="n">ui</span><span class="p">.</span><span class="n">setupUi</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">)</span>
    <span class="n">MainWindow</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">exec_</span><span class="p">())</span>


<span class="s">"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
## Subscribe to pyshine youtube channel for more learning videos.
## Its an Audio Video Screen Recoder in Python 3.
## -*- coding: utf-8 -*-
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""</span> 


</code></pre></div></div>



          <!-- Syntax Highlighting -->
          <link href="/assets/css/syntax.css" rel="stylesheet">
          <script src="/assets/scripts/copyCode.js" async></script>

          <!-- Ads -->
          <section aria-label="Advertisements" class="ads mt-4">
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-2976211678184829"
                 data-ad-slot="7658460605"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
              (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
          </section>

        </article>

      </div>

      <!-- Post Navigation -->
      <nav class="post-navigation controls__inner mt-5" aria-label="Post navigation">
        <div class="controls__item prev">
          
            <span>Previous</span>
            <a href="/How-to-make-a-real-time-voice-plot/" rel="prev">
              How to make a real time voice plot
            </a>
          
        </div>

        <div class="controls__item next">
          
            <span>Next</span>
            <a href="/How-to-plot-real-time-frame-rate-in-opencv-and-matplotlib/" rel="next">
              How to plot realtime frame rate of a ...
            </a>
          
        </div>
      </nav>

      <!-- Disqus -->
      
        <section class="comments mt-5" aria-label="Comments Section">
          
<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
this.page.url = 'http://localhost:4000/How-to-make-a-screen-recorder/';
this.page.identifier = 'http://localhost:4000/How-to-make-a-screen-recorder/';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://https-py2ai-github-io.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the comments.</noscript>


        </section>
      

    </main>

    <footer class="footer">
  <div class="container">
    <nav class="social">
      
      
      
    </nav>
    <span>&copy; 2026 PyShine. All rights reserved.</span>
  </div>
</footer>
<script async src="/assets/js/bundle.js"></script>

<script async>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js').then(function( registration ) {
      console.log('ServiceWorker registration successful with scope: ', registration.scope);
    })
    .catch(function(error) {
      console.log('ServiceWorker registration failed: ', error);
    });
  }
</script>



    <!-- MathJax -->
    
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script
  type="text/javascript"
  charset="utf-8"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
>
</script>
<script
  type="text/javascript"
  charset="utf-8"
  src="https://vincenttam.github.io/javascripts/MathJaxLocal.js"
>
</script>



    <!-- Ads -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

    <!-- SIDEBAR TOC SCRIPT -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
      const toc = document.getElementById("toc-list");
      const headings = document.querySelectorAll(
        ".post-content h2:not(.no-toc), .post-content h3:not(.no-toc)"
      );
      if (!toc || headings.length === 0) return;

      const ul = document.createElement("ul");
      headings.forEach(h => {
        const id = h.id || h.textContent.trim().toLowerCase().replace(/\s+/g, "-");
        h.id = id;

        const li = document.createElement("li");
        if (h.tagName === "H3") li.style.marginLeft = "1rem";

        li.innerHTML = `<a href="#${id}">${h.textContent}</a>`;
        ul.appendChild(li);
      });
      toc.appendChild(ul);
    });
    </script>

    <!-- INLINE TOC SCRIPT -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
      const tocTarget = document.getElementById("inline-toc-list");
      const headings = document.querySelectorAll(
        ".post-content h2:not(.no-toc), .post-content h3:not(.no-toc)"
      );
      if (!tocTarget || headings.length === 0) return;

      const ul = document.createElement("ul");
      headings.forEach(h => {
        const id = h.id || h.textContent.trim().toLowerCase().replace(/\s+/g, "-");
        h.id = id;

        const li = document.createElement("li");
        if (h.tagName === "H3") li.style.marginLeft = "1rem";

        li.innerHTML = `<a href="#${id}">${h.textContent}</a>`;
        ul.appendChild(li);
      });
      tocTarget.appendChild(ul);
    });
    </script>

    <!-- INLINE TOC STYLES -->
    <style>
      .inline-toc-box {
        background: #D4EDFD;
        padding: 15px 20px;
        border-radius: 10px;
        margin-bottom: 25px;
        border: 1px solid #e0e0e0;
      }
      .inline-toc-box ul {
        margin: 0;
        padding-left: 18px;
      }
      .inline-toc-box li {
        margin-bottom: 6px;
      }
    </style>

  </body>
</html>


