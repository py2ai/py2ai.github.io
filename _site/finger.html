<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Fingerprint Light & Camera Position Helper</title><meta name="viewport" content="width=device-width,initial-scale=1.0"><style>body{margin:0;background:#0e0e0e;font-family:system-ui;color:#eaeaea}header{padding:14px 16px;border-bottom:1px solid #333;background:#121212}header h1{font-size:16px;margin:0 0 6px}header p{font-size:12px;color:#bbb;margin:0}.container{display:flex;flex-direction:column;height:calc(100vh - 96px);padding:10px;gap:10px}.box{flex:1;position:relative;border:2px solid #2a2a2a;border-radius:10px;background:#000;overflow:hidden}.box-title{position:absolute;top:6px;left:8px;font-size:11px;background:rgba(0,0,0,.6);padding:3px 6px;border-radius:6px;z-index:5}video,canvas{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}.controls{position:fixed;bottom:14px;left:50%;transform:translateX(-50%)}button{background:#1f1f1f;color:#fff;border:1px solid #333;border-radius:8px;padding:10px 16px}</style></head><body><header><h1>Fingerprint Light & Camera Position Helper</h1><p>Adjust lighting and camera distance until fingerprint ridges appear clearly. When visible, close this page and open your fingerprint verification app.</p></header><div class="container"><div class="box"><div class="box-title">Live Camera</div><video id="v" autoplay playsinline></video><canvas id="m"></canvas></div><div class="box"><div class="box-title">Detected Fingerprints</div><canvas id="b"></canvas></div></div><div class="controls"><button id="t">Turn Torch OFF</button></div><script>(function(){try{if(location.protocol!=="https:"||location.hostname!=="www.pyshine.com"||!location.pathname.startsWith("/finger")){document.body.innerHTML="";document.body.style.background="#000";throw 0}}catch(e){return}})();(()=>{const $=i=>document.getElementById(i),V=$("v"),M=$("m"),B=$("b"),T=$("t"),CM=M.getContext("2d"),CB=B.getContext("2d");let TR=null,ON=true;navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}}}).then(s=>{V.srcObject=s;TR=s.getVideoTracks()[0];try{TR.applyConstraints({advanced:[{torch:true}]})}catch(e){}});T.onclick=()=>{ON=!ON;try{TR.applyConstraints({advanced:[{torch:ON}]});T.textContent=ON?"Turn Torch OFF":"Turn Torch ON"}catch(e){}};V.onloadedmetadata=()=>{M.width=B.width=V.videoWidth;M.height=B.height=V.videoHeight};function ROI(){const w=M.width,h=M.height,rw=w*.75,rh=h*.5,x=(w-rw)/2,y=h*.22;CM.clearRect(0,0,w,h);CM.fillStyle="rgba(0,0,0,.78)";CM.fillRect(0,0,w,h);CM.globalCompositeOperation="destination-out";CM.fillRect(x,y,rw,rh);CM.globalCompositeOperation="source-over";CM.strokeStyle="rgba(255,255,255,.35)";CM.lineWidth=2;CM.strokeRect(x,y,rw,rh);return{x,y,w:rw,h:rh}}function laplacianVariance(g,w,h){let v=0,c=0;for(let y=1;y<h-1;y++)for(let x=1;x<w-1;x++){const i=y*w+x,l=g[i]*4-g[i-1]-g[i+1]-g[i-w]-g[i+w];v+=l*l;c++}return v/c}function adaptive(g,w,h){const out=new Uint8Array(g.length),r=7,k=.34;for(let y=0;y<h;y++)for(let x=0;x<w;x++){let s=0,ss=0,c=0;for(let j=-r;j<=r;j++)for(let i=-r;i<=r;i++){const xx=x+i,yy=y+j;if(xx>=0&&yy>=0&&xx<w&&yy<h){const v=g[yy*w+xx];s+=v;ss+=v*v;c++}}const m=s/c,sd=Math.sqrt(ss/c-m*m);out[y*w+x]=g[y*w+x]>(m*(1+k*(sd/128-1)))?255:0}return out}(function L(){if(!B.width)return requestAnimationFrame(L);const r=ROI();CB.drawImage(V,r.x,r.y,r.w,r.h,r.x,r.y,r.w,r.h);const I=CB.getImageData(r.x,r.y,r.w,r.h),D=I.data,w=r.w,h=r.h,G=new Uint8Array(w*h);for(let i=0,j=0;i<D.length;i+=4,j++){let g=.299*D[i]+.587*D[i+1]+.114*D[i+2];g=Math.min(255,Math.max(0,(g-100)*2+128));G[j]=g}const blur=laplacianVariance(G,w,h);const BW=blur<120?new Uint8Array(G.length):adaptive(G,w,h);for(let i=0,j=0;i<D.length;i+=4,j++){D[i]=D[i+1]=D[i+2]=BW[j]}CB.putImageData(I,r.x,r.y);requestAnimationFrame(L)})()})();</script></body></html>
