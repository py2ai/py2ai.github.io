

  <!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/Article">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Pinterest & Google verification -->
  <meta name="p:domain_verify" content="fb68a8459fe32b8b072bcd5cc620d125"/>
  <meta name="google-site-verification" content="WAkFPi5cvufClnQetgIl0STmvvwHhVf8jfyENFWhsxU" />
  <meta name="google-site-verification" content="g2pFZlv-92XQD67BPgiVHsvZ4TZH13Ucvmmvvv36kU4" />

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>How to send video over UDP socket and save it as MP4 at client side | PyShine</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="How to send video over UDP socket and save it as MP4 at client side" />
<meta name="author" content="PyShine Team" />
<meta property="og:locale" content="en" />
<meta name="description" content="This tutorial is about using OpenCv and UDP sockets for server-client video transfer and saving MP4 at client" />
<meta property="og:description" content="This tutorial is about using OpenCv and UDP sockets for server-client video transfer and saving MP4 at client" />
<link rel="canonical" href="http://localhost:4000/Server-sends-UDP-video-and-client-saves/" />
<meta property="og:url" content="http://localhost:4000/Server-sends-UDP-video-and-client-saves/" />
<meta property="og:site_name" content="PyShine" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-03T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="How to send video over UDP socket and save it as MP4 at client side" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"PyShine Team"},"dateModified":"2022-05-03T00:00:00+08:00","datePublished":"2022-05-03T00:00:00+08:00","description":"This tutorial is about using OpenCv and UDP sockets for server-client video transfer and saving MP4 at client","headline":"How to send video over UDP socket and save it as MP4 at client side","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/Server-sends-UDP-video-and-client-saves/"},"name":"{{ page.title escape }}","url":"http://localhost:4000/Server-sends-UDP-video-and-client-saves/"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Favicon & App Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png?v=qA3OXqyw77">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png?v=qA3OXqyw77">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png?v=qA3OXqyw77">
  <link rel="manifest" href="/assets/img/icons/manifest.json?v=qA3OXqyw77">
  <link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg?v=qA3OXqyw77" color="#5bbad5">
  <link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77">
  <!--[if IE]><link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77"><![endif]-->

  <!-- App & Theme Info -->
  <meta name="apple-mobile-web-app-title" content="Sleek">
  <meta name="application-name" content="Sleek">
  <meta name="msapplication-config" content="/assets/img/icons/browserconfig.xml?v=qA3OXqyw77">
  <meta name="theme-color" content="#ffffff">

  
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-TCVFBKF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'GTM-TCVFBKF');
</script>

  

  <!-- Critical CSS Inline -->
  <style class="inlineCSS">
    h1{color:#313237;margin-top:0;margin-bottom:.5rem}.dark-bg{background-color:#19d319}@media (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:last-of-type,.post-card:nth-child(2n+2){margin-right:0}}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figure,main{display:block}figure{margin:1em 40px}a{background-color:transparent;-webkit-text-decoration-skip:objects}img{border-style:none}svg:not(:root){overflow:hidden}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}body{-webkit-overflow-scrolling:touch}*,::after,::before{-webkit-box-sizing:inherit;box-sizing:inherit}.site{display:-webkit-box;display:-ms-flexbox;display:flex;min-height:100vh;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.site__content{-webkit-box-flex:1;-ms-flex:1;flex:1}img{max-width:100%;height:auto;width:auto;vertical-align:middle}figure{margin:0}body{background-color:#fff;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Hiragino Sans GB","Microsoft YaHei","WenQuanYi Micro Hei",sans-serif;font-size:1rem;line-height:1.5;color:#343851;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%}p{margin-top:0;margin-bottom:1.25rem}h1,h2{color:#313237;margin-top:0;margin-bottom:.5rem}a{color:#277cea;text-decoration:none;border-bottom:1px dashed #277cea}.blur{background:#fff;filter:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg"><filter id="filter"><feGaussianBlur stdDeviation="16" /></filter></svg>#filter');-webkit-filter:blur(1rem);filter:blur(1rem)}.container{padding:0 20px}@media (min-width:0){.container{max-width:auto;margin:0 auto}}@media (min-width:36em){.container{max-width:540px;margin:0 auto}}@media (min-width:48em){.container{max-width:720px;margin:0 auto}}@media (min-width:62em){.container{max-width:960px;margin:0 auto}}@media (min-width:75em){.container{max-width:1170px;margin:0 auto}}.header{background-color:#fff;color:#343851;position:absolute;z-index:4;width:100%;top:0;left:0;will-change:transform;-webkit-transform:translateY(0);transform:translateY(0)}.header a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:0}.header__logo{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;overflow:hidden;padding:19px 0;margin-right:1.25rem;outline:0;border-bottom:0;color:#313237}.header__logo .header__logo--container{width:58px}.header__logo .header__logo--container .logo{fill:currentColor}.header__inner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:3.75em;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.header__links{padding-bottom:.5rem;display:none;position:absolute;top:3.75em;left:0;width:100%;height:auto;background:#fff}.header__link{color:#343851;padding:.938rem 0;border-top:1px solid #ededed}.header__toggle{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px;height:100%;background-color:transparent;padding-left:1.25rem}.header__toggle span{display:block;position:relative;margin-top:4px;background-color:#343851;width:100%;height:2px;border-radius:1px}.header__toggle span:first-child{margin-top:0}@media (min-width:62em){.header__toggle{display:none;visibility:hidden}.header__links{position:static;padding:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;visibility:visible;width:auto;height:100%}.header__links-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;padding:0}.header__link{position:relative;padding:.938rem 1rem;border:0;height:100%}.header__link::after{content:"";display:block;position:absolute;left:0;bottom:0;height:3px;width:100%;-webkit-transform:scaleX(0);transform:scaleX(0);background:#277cea}}.post-card{display:block;position:relative;width:100%;min-height:250px;border-radius:4px;overflow:hidden;background-color:#fff;-webkit-box-shadow:0 1px 3px rgba(0,0,0,.08);box-shadow:0 1px 3px rgba(0,0,0,.08);margin-bottom:2.25rem;border-bottom:0}@media (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:0}}@media (min-width:75em){.post-card{width:31.25%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:3.125%}}.post-card__label{position:absolute;top:1.5rem;left:1.5rem;z-index:2}.post-card__thumb{margin:0;background:#fff;position:relative;overflow:hidden}.post-card__thumb::after{content:"";display:block;height:0;width:100%;padding-bottom:56.25%}.post-card__thumb>*{position:absolute;top:0;left:0;width:100%;height:100%;display:block}.post-card__inner{padding:1.875rem 1.25rem .625rem;color:#838c8d}.post-card__header{margin-bottom:.75rem}.post-card__header .post-card__meta{font-size:.875rem}.label{padding:0 10px;margin-bottom:1rem;display:inline-block;line-height:20px;font-size:.75rem;text-transform:uppercase;letter-spacing:1px;color:rgba(255,255,255,.8);border:2px solid rgba(255,255,255,.5);border-radius:100px}.hero{margin:3.75rem auto 0;min-height:16.25rem;width:100%;position:relative;background-color:#dde5ea;background-repeat:no-repeat;background-position:50%;background-size:cover}@media (min-width:62em){.hero{margin:0 auto;height:36em}}.hero::before{position:absolute;display:block;content:"";top:0;left:0;width:100%;height:100%;background:rgba(52,56,81,.8)}.hero__wrap{position:absolute;margin:auto;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);text-align:center;color:rgba(255,255,255,.8);width:100%;max-width:90%;z-index:1}.hero__wrap .hero__title{font-size:1.8em;color:#fff}.blog{background-color:#f9f9f9}.post-list{padding-top:2.5em;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}@media (min-width:48em){.hero__wrap{max-width:40em}.hero__wrap .hero__title{padding:1rem 0;font-size:2.625em;line-height:3.125rem}.post-list{padding-top:5em}}
  </style>

  <!-- Main CSS -->
  <link rel="preload" href="/assets/css/main.css" as="style" onload="this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/assets/css/main.css"></noscript>

  <script type="text/javascript">
    /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
(function(w){"use strict";if(!w.loadCSS){w.loadCSS=function(){}}
var rp=loadCSS.relpreload={};rp.support=(function(){var ret;try{ret=w.document.createElement("link").relList.supports("preload")}catch(e){ret=!1}
return function(){return ret}})();rp.bindMediaToggle=function(link){var finalMedia=link.media||"all";function enableStylesheet(){link.media=finalMedia}
if(link.addEventListener){link.addEventListener("load",enableStylesheet)}else if(link.attachEvent){link.attachEvent("onload",enableStylesheet)}
setTimeout(function(){link.rel="stylesheet";link.media="only x"});setTimeout(enableStylesheet,3000)};rp.poly=function(){if(rp.support()){return}
var links=w.document.getElementsByTagName("link");for(var i=0;i<links.length;i++){var link=links[i];if(link.rel==="preload"&&link.getAttribute("as")==="style"&&!link.getAttribute("data-loadcss")){link.setAttribute("data-loadcss",!0);rp.bindMediaToggle(link)}}};if(!rp.support()){rp.poly();var run=w.setInterval(rp.poly,500);if(w.addEventListener){w.addEventListener("load",function(){rp.poly();w.clearInterval(run)})}else if(w.attachEvent){w.attachEvent("onload",function(){rp.poly();w.clearInterval(run)})}}
if(typeof exports!=="undefined"){exports.loadCSS=loadCSS}
else{w.loadCSS=loadCSS}}(typeof global!=="undefined"?global:this))

  </script>

  <!-- MathJax -->
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>


  <body class="site" itemscope itemtype="https://schema.org/WebPage">

    
      <!-- Google Tag Manager (noscript) -->
      <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TCVFBKF"
                height="0" width="0" style="display:none;visibility:hidden"></iframe>
      </noscript>
      <!-- End Google Tag Manager -->
    

    <header class="header" itemscope itemtype="http://schema.org/SiteNavigationElement" aria-label="Main navigation">
  <div class="container">
    <div class="header__inner">
      <!-- Logo -->
      <a class="header__logo" href="/">
        <div class="header__logo--container">
          <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
<g>
	<path d="M18.121,9.88l-7.832-7.836c-0.155-0.158-0.428-0.155-0.584,0L1.842,9.913c-0.262,0.263-0.073,0.705,0.292,0.705h2.069v7.042c0,0.227,0.187,0.414,0.414,0.414h3.725c0.228,0,0.414-0.188,0.414-0.414v-3.313h2.483v3.313c0,0.227,0.187,0.414,0.413,0.414h3.726c0.229,0,0.414-0.188,0.414-0.414v-7.042h2.068h0.004C18.331,10.617,18.389,10.146,18.121,9.88 M14.963,17.245h-2.896v-3.313c0-0.229-0.186-0.415-0.414-0.415H8.342c-0.228,0-0.414,0.187-0.414,0.415v3.313H5.032v-6.628h9.931V17.245z M3.133,9.79l6.864-6.868l6.867,6.868H3.133z"></path>

	
	
</g>
</svg>

        </div>
      </a>

      <!-- Navigation Links -->
      <nav class="header__links">
        <div class="container header__links-wrapper">
          
            <a class="header__link" href="/" itemprop="url">
              <span itemprop="name">Home</span>
            </a>
          
            <a class="header__link" href="/converter.html" itemprop="url">
              <span itemprop="name">Free PNG Converter</span>
            </a>
          
            <a class="header__link" href="/categories" itemprop="url">
              <span itemprop="name">Categories</span>
            </a>
          
            <a class="header__link" href="/about" itemprop="url">
              <span itemprop="name">About</span>
            </a>
          
            <a class="header__link" href="/contact" itemprop="url">
              <span itemprop="name">Contact</span>
            </a>
          
            <a class="header__link" href="/privacy" itemprop="url">
              <span itemprop="name">Privacy Policy</span>
            </a>
          
            <a class="header__link" href="/disclaimer" itemprop="url">
              <span itemprop="name">Disclaimer</span>
            </a>
          
        </div>
      </nav>

      <!-- Mobile Menu Toggle -->
      <div class="header__toggle" aria-label="Toggle navigation">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </div>

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>How to send video over UDP socket and save it as MP4 at client side | PyShine</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="How to send video over UDP socket and save it as MP4 at client side" />
<meta name="author" content="PyShine Team" />
<meta property="og:locale" content="en" />
<meta name="description" content="This tutorial is about using OpenCv and UDP sockets for server-client video transfer and saving MP4 at client" />
<meta property="og:description" content="This tutorial is about using OpenCv and UDP sockets for server-client video transfer and saving MP4 at client" />
<link rel="canonical" href="http://localhost:4000/Server-sends-UDP-video-and-client-saves/" />
<meta property="og:url" content="http://localhost:4000/Server-sends-UDP-video-and-client-saves/" />
<meta property="og:site_name" content="PyShine" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-03T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="How to send video over UDP socket and save it as MP4 at client side" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"PyShine Team"},"dateModified":"2022-05-03T00:00:00+08:00","datePublished":"2022-05-03T00:00:00+08:00","description":"This tutorial is about using OpenCv and UDP sockets for server-client video transfer and saving MP4 at client","headline":"How to send video over UDP socket and save it as MP4 at client side","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/Server-sends-UDP-video-and-client-saves/"},"name":"{{ page.title escape }}","url":"http://localhost:4000/Server-sends-UDP-video-and-client-saves/"}</script>
<!-- End Jekyll SEO tag -->

</header>


    
      <div class="hero dark-bg" role="img" aria-label="How to send video over UDP socket and save it as MP4 at client side">
    
        <div class="hero__wrap">
          
            <div class="hero__categories">
              
                <a class="label"
                   href="/categories/#Socket Programming Series"
                   aria-label="Category: Socket Programming Series">
                   Socket Programming Series
                </a>
                
              
            </div>
          

          <h1 class="hero__title" itemprop="headline">How to send video over UDP socket and save it as MP4 at client side</h1>

          <p class="hero__meta">
            <time datetime="2022-05-03T00:00:00+08:00" itemprop="datePublished">
              03 May 2022
            </time>
            &nbsp;·&nbsp;
            
            <span itemprop="timeRequired">
              
                6 mins read
              
            </span>
          </p>
        </div>
      </div>

    <main class="site__content" role="main">
      <div class="container">

        <article class="post-content"
                 itemprop="articleBody"
                 itemscope itemtype="https://schema.org/Article">
          
          <p>Hello friends! Previously, we have seen how TCP and UDP sockets work. This tutorial is about sending the video frames over UDP from server and then saving them 
at the client side as .MP4 file.</p>

<h3 id="serverpy">server.py</h3>
<style>
  .copy-code-button {
	box-shadow:inset 0px 1px 0px 0px #bbdaf7;
	background:linear-gradient(to bottom, #79bbff 5%, #378de5 100%);
	background-color:#79bbff;
	border-radius:6px;
	border:1px solid #84bbf3;
	display:inline-block;
	cursor:pointer;
	color:#ffffff;
	font-family:Arial;
	font-size:15px;
	font-weight:bold;
	padding:6px 24px;
	text-decoration:none;
	text-shadow:0px 1px 0px #528ecc;
}
.copy-code-button:hover {
	background:linear-gradient(to bottom, #378de5 5%, #79bbff 100%);
	background-color:#378de5;
}
.copy-code-button:active {
	position:relative;
	top:1px;
}
</style>

<div class="code-header">
  <button class="copy-code-button">
    Copy code to clipboard
  </button>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># This is server code to send video frames over UDP so that client can save it
</span><span class="kn">import</span> <span class="nn">cv2</span><span class="p">,</span> <span class="n">imutils</span><span class="p">,</span> <span class="n">socket</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">base64</span>

<span class="n">BUFF_SIZE</span> <span class="o">=</span> <span class="mi">65536</span>
<span class="n">server_socket</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">socket</span><span class="p">.</span><span class="n">SOCK_DGRAM</span><span class="p">)</span>
<span class="n">server_socket</span><span class="p">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span><span class="n">socket</span><span class="p">.</span><span class="n">SO_RCVBUF</span><span class="p">,</span><span class="n">BUFF_SIZE</span><span class="p">)</span>
<span class="n">host_name</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="n">gethostname</span><span class="p">()</span>
<span class="n">host_ip</span> <span class="o">=</span> <span class="s">'192.168.10.113'</span><span class="c1">#  socket.gethostbyname(host_name)
</span><span class="k">print</span><span class="p">(</span><span class="n">host_ip</span><span class="p">)</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">9999</span>
<span class="n">socket_address</span> <span class="o">=</span> <span class="p">(</span><span class="n">host_ip</span><span class="p">,</span><span class="n">port</span><span class="p">)</span>
<span class="n">server_socket</span><span class="p">.</span><span class="n">bind</span><span class="p">(</span><span class="n">socket_address</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Listening at:'</span><span class="p">,</span><span class="n">socket_address</span><span class="p">)</span>

<span class="n">vid</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#  replace 'rocket.mp4' with 0 for webcam
</span><span class="n">fps</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">frames_to_count</span><span class="p">,</span><span class="n">cnt</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
	<span class="n">msg</span><span class="p">,</span><span class="n">client_addr</span> <span class="o">=</span> <span class="n">server_socket</span><span class="p">.</span><span class="n">recvfrom</span><span class="p">(</span><span class="n">BUFF_SIZE</span><span class="p">)</span>
	<span class="k">print</span><span class="p">(</span><span class="s">'GOT connection from '</span><span class="p">,</span><span class="n">client_addr</span><span class="p">)</span>
	<span class="n">WIDTH</span><span class="o">=</span><span class="mi">400</span>
	<span class="k">while</span><span class="p">(</span><span class="n">vid</span><span class="p">.</span><span class="n">isOpened</span><span class="p">()):</span>
		<span class="n">_</span><span class="p">,</span><span class="n">frame</span> <span class="o">=</span> <span class="n">vid</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
		<span class="n">frame</span> <span class="o">=</span> <span class="n">imutils</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">WIDTH</span><span class="p">)</span>
		<span class="n">encoded</span><span class="p">,</span><span class="nb">buffer</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">imencode</span><span class="p">(</span><span class="s">'.jpg'</span><span class="p">,</span><span class="n">frame</span><span class="p">,[</span><span class="n">cv2</span><span class="p">.</span><span class="n">IMWRITE_JPEG_QUALITY</span><span class="p">,</span><span class="mi">80</span><span class="p">])</span>
		<span class="n">message</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64encode</span><span class="p">(</span><span class="nb">buffer</span><span class="p">)</span>
		<span class="n">server_socket</span><span class="p">.</span><span class="n">sendto</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="n">client_addr</span><span class="p">)</span>
		<span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span><span class="s">'FPS: '</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fps</span><span class="p">),(</span><span class="mi">10</span><span class="p">,</span><span class="mi">40</span><span class="p">),</span><span class="n">cv2</span><span class="p">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">cv2</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">'TRANSMITTING VIDEO'</span><span class="p">,</span><span class="n">frame</span><span class="p">)</span>
		<span class="n">key</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
		<span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s">'q'</span><span class="p">):</span>
			<span class="n">server_socket</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
			<span class="k">break</span>
		<span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="n">frames_to_count</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">fps</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">frames_to_count</span><span class="o">/</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">st</span><span class="p">))</span>
				<span class="n">st</span><span class="o">=</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
				<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="k">pass</span>
		<span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
</code></pre></div></div>

<h3 id="clientpy">client.py</h3>
<style>
  .copy-code-button {
	box-shadow:inset 0px 1px 0px 0px #bbdaf7;
	background:linear-gradient(to bottom, #79bbff 5%, #378de5 100%);
	background-color:#79bbff;
	border-radius:6px;
	border:1px solid #84bbf3;
	display:inline-block;
	cursor:pointer;
	color:#ffffff;
	font-family:Arial;
	font-size:15px;
	font-weight:bold;
	padding:6px 24px;
	text-decoration:none;
	text-shadow:0px 1px 0px #528ecc;
}
.copy-code-button:hover {
	background:linear-gradient(to bottom, #378de5 5%, #79bbff 100%);
	background-color:#378de5;
}
.copy-code-button:active {
	position:relative;
	top:1px;
}
</style>

<div class="code-header">
  <button class="copy-code-button">
    Copy code to clipboard
  </button>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># This is client code to receive video frames over UDP and save as .MP4 file
</span><span class="kn">import</span> <span class="nn">cv2</span><span class="p">,</span> <span class="n">imutils</span><span class="p">,</span> <span class="n">socket</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">base64</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">fourcc</span> <span class="o">=</span><span class="mh">0x7634706d</span> 
<span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">time_str</span> <span class="o">=</span> <span class="n">now</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">"%d%m%Y%H%M%S"</span><span class="p">)</span>
<span class="n">time_name</span> <span class="o">=</span> <span class="s">'_Rec_'</span><span class="o">+</span><span class="n">time_str</span><span class="o">+</span><span class="s">'.mp4'</span>
<span class="n">FPS</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">frame_shape</span> <span class="o">=</span> <span class="bp">False</span>


<span class="n">BUFF_SIZE</span> <span class="o">=</span> <span class="mi">65536</span>
<span class="n">client_socket</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">socket</span><span class="p">.</span><span class="n">SOCK_DGRAM</span><span class="p">)</span>
<span class="n">client_socket</span><span class="p">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span><span class="n">socket</span><span class="p">.</span><span class="n">SO_RCVBUF</span><span class="p">,</span><span class="n">BUFF_SIZE</span><span class="p">)</span>
<span class="n">host_name</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="n">gethostname</span><span class="p">()</span>
<span class="n">host_ip</span> <span class="o">=</span> <span class="s">'192.168.10.113'</span><span class="c1">#  socket.gethostbyname(host_name)
</span><span class="k">print</span><span class="p">(</span><span class="n">host_ip</span><span class="p">)</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">9999</span>
<span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'Hello'</span>

<span class="n">client_socket</span><span class="p">.</span><span class="n">sendto</span><span class="p">(</span><span class="n">message</span><span class="p">,(</span><span class="n">host_ip</span><span class="p">,</span><span class="n">port</span><span class="p">))</span>
<span class="n">fps</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">frames_to_count</span><span class="p">,</span><span class="n">cnt</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">packet</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">client_socket</span><span class="p">.</span><span class="n">recvfrom</span><span class="p">(</span><span class="n">BUFF_SIZE</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span><span class="s">' /'</span><span class="p">)</span>
    <span class="n">npdata</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">)</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">npdata</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span><span class="s">'FPS: '</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fps</span><span class="p">),(</span><span class="mi">10</span><span class="p">,</span><span class="mi">40</span><span class="p">),</span><span class="n">cv2</span><span class="p">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="n">frames_to_count</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fps</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">frames_to_count</span><span class="o">/</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">st</span><span class="p">))</span>
            <span class="n">st</span><span class="o">=</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">frame_shape</span><span class="p">:</span>
        <span class="n">video_file_name</span>  <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">host_ip</span><span class="p">)</span> <span class="o">+</span> <span class="n">time_name</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">VideoWriter</span><span class="p">(</span><span class="n">video_file_name</span><span class="p">,</span> <span class="n">fourcc</span><span class="p">,</span> <span class="n">FPS</span><span class="p">,</span> <span class="p">(</span><span class="n">frame</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">frame</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">frame_shape</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">out</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
    <span class="n">cv2</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="s">"RECEIVING VIDEO"</span><span class="p">,</span><span class="n">frame</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s">'q'</span><span class="p">):</span>
        
        <span class="k">break</span>
<span class="n">client_socket</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">out</span><span class="p">.</span><span class="n">release</span><span class="p">()</span>
</code></pre></div></div>
<p>Please note that for MacOS we require:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo sysctl -w net.inet.udp.maxdgram=65535
</code></pre></div></div>
<p>If restart computer the above UDP max buffer size will shrink to 9216. So please run the above command again if required.</p>


          <!-- Inline code styling -->
          <link href="/assets/css/syntax.css" rel="stylesheet">
          <script src="/assets/scripts/copyCode.js" async></script>

          <!-- Google Ad (responsive rectangle after content) -->
          <section aria-label="Advertisements" class="ads mt-4">
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-2976211678184829"
                 data-ad-slot="7658460605"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
              (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
          </section>

        </article>

        <!-- Post Navigation -->
        <nav class="post-navigation controls__inner mt-5" aria-label="Post navigation">
          <div class="controls__item prev">
            
              <span>Previous</span>
              <a href="/PyQt5-related-Questions-and-Answers/" rel="prev">
                FAQs about PyQt5
              </a>
            
          </div>

          <div class="controls__item next">
            
              <span>Next</span>
              <a href="/Video-streaming-and-car-control-with-Python/" rel="next">
                Video streaming and Car Control in Py...
              </a>
            
          </div>
        </nav>

        <!-- Comments Section -->
        
          <section class="comments mt-5" aria-label="Comments Section">
            
<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
this.page.url = 'http://localhost:4000/Server-sends-UDP-video-and-client-saves/';
this.page.identifier = 'http://localhost:4000/Server-sends-UDP-video-and-client-saves/';
};

(function() {
var d = document, s = d.createElement('script');
s.src = 'https://https-py2ai-github-io.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the comments.</noscript>


          </section>
        

      </div>
    </main>

    <footer class="footer">
  <div class="container">
    <nav class="social">
      
      
      
    </nav>
    <span>&copy; 2025 PyShine. All rights reserved.</span>
  </div>
</footer>
<script async src="/assets/js/bundle.js"></script>

<script async>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js').then(function( registration ) {
      console.log('ServiceWorker registration successful with scope: ', registration.scope);
    })
    .catch(function(error) {
      console.log('ServiceWorker registration failed: ', error);
    });
  }
</script>



    <!-- Scripts at bottom for performance -->
    
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script
  type="text/javascript"
  charset="utf-8"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
>
</script>
<script
  type="text/javascript"
  charset="utf-8"
  src="https://vincenttam.github.io/javascripts/MathJaxLocal.js"
>
</script>



    <!-- Async Ads script globally -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  </body>
</html>


